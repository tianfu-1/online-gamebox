(m=u||(u={}))[m.Dev=1]="Dev",m[m.Prod=2]="Prod";const e={BuildLevel:2,AnalyticsEnabled:!1},t={ENDSCREEN:"./assets/endTexts/",AUDIO:"./assets/audio/",BUTTONS:"./assets/buttons/",FONTS:"./assets/fonts/",ANIMATIONS:"./assets/animations/",PHYSICS:"./assets/physics/",MENU:"./assets/0menu/",FLY:"./assets/1fly/",PROTECT:"./assets/2protect/",ALAN:"./assets/3alan/",JUMPSCARE:"./assets/4jumpscare/",COMEDIAN:"./assets/5comedian/",PARTY:"./assets/6party/",DRESSUP:"./assets/8dressup/",COLLECT:"./assets/9candycollect/",SORT:"./assets/10sortcandy/",GHOSTBUSTERS:"./assets/11ghostbusters/",HEAVENHELL:"./assets/12heavenorhell/"},i={REGISTRY:{ADBLOCKENABLED:"adblockEnabled",SKIPUSED:"skipUsed",JUMPSCARE_ATTEMPTS:"jumpscareAttempts",GHOSTBUSTERS_ATTEMPTED:"ghostbustersAttempted",HELL_COMPLETED:"hellCompleted",GAME_COMPLETED:"gameCompleted"},GAMESTATE:{START:"START",PLAYING:"PLAYING",WIN:"WIN",LOSE:"LOSE",LOADNEXTLEVEL:"LOAD"},SCENES:{LOAD:"LOAD",PROGRESSIVE_LOAD:"PROGRESSIVE_LOAD",SOUNDTRACK:"SOUNDTRACK",MENU:"MENU",FLY:"FLY",ALAN:"ALAN",PROTECT:"PROTECT",JUMPSCARE:"JUMPSCARE",COMEDIAN:"COMEDIAN",PARTY:"PARTY",DRESSUP:"DRESSUP",COLLECT:"COLLECT",SORT:"SORT",GHOSTBUSTERS:"GHOSTBUSTERS",HEAVENHELL:"HEAVENHELL",CREDITS:"CREDITS"},STORAGE_KEYS:{PROGRESS:"game_progress",DRESSUP_COSTUME:"dressup_costume"},AUDIO:{SOUNDTRACK:t.AUDIO+"soundtrack.mp3",SOUNDTRACK_SHORT:t.AUDIO+"soundtrackShort.mp3",EERIE:t.AUDIO+"eerie.mp3",GRAB:t.AUDIO+"paperGrab.mp3",BOUNCE:t.AUDIO+"bounce.mp3",SCARE1:t.AUDIO+"scare1.mp3",SCARE2:t.AUDIO+"scare2.mp3",PARTY_MUSIC:t.AUDIO+"partyMusic.mp3",WINK:t.AUDIO+"wink.mp3",CLICK:t.AUDIO+"btnClick.mp3",WIN:t.AUDIO+"win.mp3",LOSE:t.AUDIO+"lose.mp3"},BUTTONS:{TRYAGAIN:t.BUTTONS+"button.png",SKIP:t.BUTTONS+"ad-button.png",SPINNER:t.BUTTONS+"spinner.png",PURPLE:t.BUTTONS+"purple.png",RED:t.BUTTONS+"red.png",SOUND_ON:t.BUTTONS+"sound-on.png",SOUND_OFF:t.BUTTONS+"sound-off.png"},FONT:{ATLAS:t.FONTS+"LTGFont.png",XML:t.FONTS+"LTGFont.xml"},ANIMATIONS:{CANDY_IDLE:t.ANIMATIONS+"CandyAnim.json",CANDY_DIE:t.ANIMATIONS+"CandyDie.json",SCARYARM_BACK:t.ANIMATIONS+"scaryArmBack.json",SCARYARM_FRONT:t.ANIMATIONS+"scaryArmFront.json",GHOST_IDLE:t.ANIMATIONS+"ghostIdle.json",GHOST_DIE:t.ANIMATIONS+"ghostDie.json",GRANNY_HAND1:t.ANIMATIONS+"granny_hand1.json",GRANNY_HAND2:t.ANIMATIONS+"granny_hand2.json",GRANNYDIE_HAND1:t.ANIMATIONS+"grannyDie_hand1.json",GRANNYDIE_HAND2:t.ANIMATIONS+"grannyDie_hand2.json",GRANNYDIE_BODY:t.ANIMATIONS+"grannyDie_body.json",WIN_IMAGE_POPUP:t.ANIMATIONS+"winImagePopup.json",NOTE_DEATH:t.ANIMATIONS+"noteDeath.json",BLUE_LIGHT:t.ANIMATIONS+"bluelight.json",GREEN_LIGHT:t.ANIMATIONS+"greenlight.json",PINK_LIGHT:t.ANIMATIONS+"pinklight.json",COMEDIAN_HAND_1:t.ANIMATIONS+"comedianHand.json",COMEDIAN_HAND_2:t.ANIMATIONS+"comedianHand2.json",FLY_WIN:t.ANIMATIONS+"flyWin.json"},PHYSICS:{FLY_SHAPES:t.PHYSICS+"ghost_shape.json",HEAVENHELL_SHAPES:t.PHYSICS+"heavenhell_shapes.json"},MENU:{BACKGROUND:t.MENU+"background.png",OVERLAY:t.MENU+"overlay.png",PLAY_BUTTON:t.MENU+"playButton.png",STAR_PARTICLE:t.MENU+"particle.png"},FLY:{BACKGROUND:t.FLY+"ozadje-modr.png",HOLD_TEXT:t.FLY+"hold.png",GRADIENT:t.FLY+"gradient.png",WHITE_SQUARE:t.FLY+"white_square.jpg",START_GRASS:t.FLY+"grass_start.png",GRASS_1:t.FLY+"grass1.png",GRASS_2:t.FLY+"grass2.png",FOUNTAIN:t.FLY+"fountain.png",LIGHT:t.FLY+"light-2.png",MOON:t.FLY+"moon.png",SPIDER_1:t.FLY+"spider-1.png",SPIDER_2:t.FLY+"spider-2.png",SPIDER_3:t.FLY+"spider-3.png",SPIDER_LINE:t.FLY+"crta.png",TWIG:t.FLY+"twig.png",GHOST:t.FLY+"duhc.png",WIN_IMAGE:t.FLY+"win.png",WIN_GHOST:t.FLY+"win_ghost.png",END:t.ENDSCREEN+"fly.png"},ALAN:{BACKGROUND:t.ALAN+"background.png",CLOUDS:t.ALAN+"clouds.png",PLANT:t.ALAN+"plant.png",TABLE:t.ALAN+"table.png",WINDOWS:t.ALAN+"windows.png",ALAN:t.ALAN+"alan.png",ALAN_SADMOUTH:t.ALAN+"sad-mouth.png",ALAN_SADDERMOUTH:t.ALAN+"sadder-mouth.png",PAPER_1:t.ALAN+"paper1.png",PAPER_2:t.ALAN+"paper2.png",PAPER_3:t.ALAN+"paper3.png",PAPER_4:t.ALAN+"paper4.png",PAPER_5:t.ALAN+"paper5.png",PAPER_6:t.ALAN+"paper6.png",PAPER_7:t.ALAN+"paper7.png",LEAF:t.ALAN+"leaf.png",MUG:t.ALAN+"mug.png",NAPIS:t.ALAN+"napis.png",PEN:t.ALAN+"pen.png",PENCIL:t.ALAN+"pencil.png",RUBBER:t.ALAN+"rubber.png",END:t.ENDSCREEN+"alan.png"},PROTECT:{BACKGROUND:t.PROTECT+"bg.png",DRAG_TEXT:t.PROTECT+"drag.png",WIN_SCREEN:t.PROTECT+"protect.png",LADY:t.PROTECT+"lady.png",HAND_1:t.PROTECT+"h1.png",HAND_2:t.PROTECT+"h2.png",AXE:t.PROTECT+"axe.png",KNIFE:t.PROTECT+"hey-orange.png",NINJA:t.PROTECT+"nunja.png",POOP:t.PROTECT+"poop.png",PORCUPINE:t.PROTECT+"porcupine.png",YARN:t.PROTECT+"yarn.png",END:t.ENDSCREEN+"protect.png"},JUMPSCARE:{BACKGROUND:t.JUMPSCARE+"background.png",WALLPAPER:t.JUMPSCARE+"epic-poster.png",CHAIR:t.JUMPSCARE+"chair.png",TABLE:t.JUMPSCARE+"table.png",TV_PLAY:t.JUMPSCARE+"tvPlay.png",TV_SCARE:t.JUMPSCARE+"tvScare.png",CLICK_TEXT:t.JUMPSCARE+"click.png",FAST_TEXT:t.JUMPSCARE+"fast.png",JACK:t.JUMPSCARE+"jackaboy.png",NORMAL_EYES:t.JUMPSCARE+"jack-normal-eyes.png",SCARED_EYES:t.JUMPSCARE+"jack-shit-pantso.png",ARM_1:t.JUMPSCARE+"arm.png",ARM_2:t.JUMPSCARE+"arm-2.png",BAR:t.JUMPSCARE+"bar-brez-crtice.png",BAR_LINE:t.JUMPSCARE+"crtica-za-bar.png",BUTTON:t.JUMPSCARE+"button.png",BUTTON_PRESSED:t.JUMPSCARE+"button-presed.png",SCARE_SCREEN:t.JUMPSCARE+"jumpscare.png"},COMEDIAN:{BACKGROUND:t.COMEDIAN+"background.png",MIC:t.COMEDIAN+"mic.png",JOKE_1_QUESTION:t.COMEDIAN+"5-2.png",JOKE_1_ANSWER_1:t.COMEDIAN+"5-1.png",JOKE_1_ANSWER_2:t.COMEDIAN+"5-3.png",JOKE_1_ANSWER_3:t.COMEDIAN+"5-4.png",JOKE_2_QUESTION:t.COMEDIAN+"1-2.png",JOKE_2_ANSWER_1:t.COMEDIAN+"1-1.png",JOKE_2_ANSWER_2:t.COMEDIAN+"1-3.png",JOKE_2_ANSWER_3:t.COMEDIAN+"1-4.png",JOKE_3_QUESTION:t.COMEDIAN+"2-3.png",JOKE_3_ANSWER_1:t.COMEDIAN+"2-4.png",JOKE_3_ANSWER_2:t.COMEDIAN+"2-1.png",JOKE_3_ANSWER_3:t.COMEDIAN+"2-2.png",JOKE_4_QUESTION:t.COMEDIAN+"3-2.png",JOKE_4_ANSWER_1:t.COMEDIAN+"3-4.png",JOKE_4_ANSWER_2:t.COMEDIAN+"3-3.png",JOKE_4_ANSWER_3:t.COMEDIAN+"3-1.png",JOKE_5_QUESTION:t.COMEDIAN+"4-3.png",JOKE_5_ANSWER_1:t.COMEDIAN+"4-4.png",JOKE_5_ANSWER_2:t.COMEDIAN+"4-2.png",JOKE_5_ANSWER_3:t.COMEDIAN+"4-1.png",WIN_BACKGROUND:t.COMEDIAN+"win-anim/background.png",GHOST_1:t.COMEDIAN+"win-anim/duhc-1.png",GHOST_2:t.COMEDIAN+"win-anim/duhc-2.png",GHOST_3:t.COMEDIAN+"win-anim/duhc-3.png",GHOST_4:t.COMEDIAN+"win-anim/duhc-4.png",GHOST_5:t.COMEDIAN+"win-anim/duhc-5.png",GHOST_6:t.COMEDIAN+"win-anim/duhc-6.png",GHOST_7:t.COMEDIAN+"win-anim/duhc-7.png",GHOST_8:t.COMEDIAN+"win-anim/duhc-8.png",HANDS_1:t.COMEDIAN+"win-anim/hands.png",HANDS_2:t.COMEDIAN+"win-anim/hands2.png",LOSEIMAGE:t.ENDSCREEN+"comedian-1.png",END:t.ENDSCREEN+"comedian-2.png"},PARTY:{BACKGROUND_BACK:t.PARTY+"ozadje-zadi.png",BACKGROUND_FRONT:t.PARTY+"ozadje-spredi.png",GRAVE:t.PARTY+"grave.png",MARTINI:t.PARTY+"martini.png",BATS:t.PARTY+"netopirji.png",LUNA:t.PARTY+"ozdaje-moon.png",GHOST_1_BODY:t.PARTY+"ghost-1-body.png",GHOST_2_BODY:t.PARTY+"ghost-2-body.png",GHOST_3_BODY:t.PARTY+"ghost-3-body.png",GHOST_4_BODY:t.PARTY+"ghost-4-body.png",DOT_BLUE:t.PARTY+"blue-dot.png",DOT_GREEN:t.PARTY+"green-dot.png",DOT_PINK:t.PARTY+"pink-dot.png",END_BLUE:t.PARTY+"blue-something.png",END_GREEN:t.PARTY+"green-something.png",END_PINK:t.PARTY+"pink-something.png",LIGHT_BLUE:t.PARTY+"blue-light.png",LIGHT_GREEN:t.PARTY+"green-light.png",LIGHT_PINK:t.PARTY+"pink-light.png",LINE_BLUE:t.PARTY+"blue-line.png",LINE_GREEN:t.PARTY+"green-line.png",LINE_PINK:t.PARTY+"pink-line.png",WIN_SCREEN:t.PARTY+"party.png",END:t.ENDSCREEN+"party.png"},JSONPARTY:{MUSIC:t.PARTY+"music.json",FFT:t.PARTY+"fft.json"},DRESSUP:{BACKGROUND:t.DRESSUP+"ozadje.png",GHOST:t.DRESSUP+"ghost.png",FABULOUS_BUTTON:t.DRESSUP+"fabulousButton.png",BOY_1:t.DRESSUP+"boy-1.png",BOY_2:t.DRESSUP+"boy-2.png",BOY_3:t.DRESSUP+"boy-3.png",DPOOL_1:t.DRESSUP+"deadpool-1.png",DPOOL_2:t.DRESSUP+"deadpool-2.png",DPOOL_3:t.DRESSUP+"deadpool-3.png",DINO_1:t.DRESSUP+"dinosaur-1.png",DINO_2:t.DRESSUP+"dinosaur-2.png",DINO_3:t.DRESSUP+"dinosaur-3.png",WITCH_1:t.DRESSUP+"whitch-1.png",WITCH_2:t.DRESSUP+"witch-2.png",WITCH_3:t.DRESSUP+"witch-3.png",END:t.ENDSCREEN+"halloween-dress-up.png"},COLLECT:{BACKGROUND:t.COLLECT+"bg.png",CANDY_1:t.COLLECT+"candy1.png",CANDY_2:t.COLLECT+"candy2.png",CANDY_3:t.COLLECT+"candy3.png",CANDY_4:t.COLLECT+"candy4.png",CANDY_5:t.COLLECT+"candy5.png",PLAYER_0:t.COLLECT+"homan.png",PLAYER_1:t.COLLECT+"raaaaaawr.png",PLAYER_2:t.COLLECT+"dead-pooly.png",PLAYER_3:t.COLLECT+"its-a-witch.png",END:t.ENDSCREEN+"haloween-collect.png"},SORT:{BACKGROUND:t.SORT+"ozadje.png",SORT_TEXT:t.SORT+"sort.png",PUMPKIN_BACK:t.SORT+"pumpkin_1.png",PUMPKIN_FRONT:t.SORT+"pumpkin-ozadje.png",TRASH_BACK:t.SORT+"trash.png",TRASH_FRONT:t.SORT+"trash-front.png",GHOST:t.SORT+"ghost.png",CANDY_1:t.SORT+"bombombom-3.png",CANDY_2:t.SORT+"bonbon.png",CANDY_3:t.SORT+"chocoloto.png",CANDY_4:t.SORT+"loleh.png",CANDY_5:t.SORT+"nom.png",BROCCOLI:t.SORT+"brocololo.png",MEAT:t.SORT+"meat.png",RAZOR:t.SORT+"razor.png",TOOTHBRUSH:t.SORT+"tootho.png",WIN_BACKGROUND:t.SORT+"endbg.png",WIN_GHOST:t.SORT+"sort-ghost.png",END:t.ENDSCREEN+"sortCandy.png"},GHOSTBUSTERS:{BACKGROUND:t.GHOSTBUSTERS+"ozadje.png",START_GRADIENT:t.GHOSTBUSTERS+"gradient.png",LEVEL:t.GHOSTBUSTERS+"polje.png",CANNON:t.GHOSTBUSTERS+"shooter.png",BALL:t.GHOSTBUSTERS+"krogla.png",LASER:t.GHOSTBUSTERS+"laser.png",SPINNER:t.GHOSTBUSTERS+"swirly.png",END:t.ENDSCREEN+"ghostbusters.png"},HEAVENHELL:{HEAVEN_BACKGROUND:t.HEAVENHELL+"heaven-ozadje.png",HELL_BACKGROUND:t.HEAVENHELL+"hell-ozadje.png",START_CLOUD:t.HEAVENHELL+"startCloud.png",START_GHOST:t.HEAVENHELL+"ghostie.png",GHOST_SIDE:t.HEAVENHELL+"ghost-side.png",SIGN_HEAVEN:t.HEAVENHELL+"heaven_sign.png",SIGN_HELL:t.HEAVENHELL+"hell-sign.png",EVIL_DUCK:t.HEAVENHELL+"duck-devil.png",NORMAL_DUCK:t.HEAVENHELL+"suck-a-duck.png",SWING:t.HEAVENHELL+"bar.png",CLICKER:t.HEAVENHELL+"clicker.png",ROAD:t.HEAVENHELL+"road.png",ROAD_FIRE:t.HEAVENHELL+"road-of-fire.png",STAIRS_START:t.HEAVENHELL+"staircaseStart.png",STAIRS_MID:t.HEAVENHELL+"stairs.png",STAIRS_END:t.HEAVENHELL+"stairsEnd.png",CLOUD_1:t.HEAVENHELL+"oblak1.png",CLOUD_2:t.HEAVENHELL+"oblak2.png",CLOUD_3:t.HEAVENHELL+"oblak3.png",CLOUD_4:t.HEAVENHELL+"oblak4.png",CLOUD_5:t.HEAVENHELL+"oblak5.png",CLOUD_7:t.HEAVENHELL+"oblak7.png",END:t.ENDSCREEN+"hell.png"},CREDITS:{HELL:t.ENDSCREEN+"credits-hell.png",HEAVEN:t.ENDSCREEN+"credits-heaven.png"}};(S=N||(N={}))[S.Dev=1]="Dev",S[S.Prod=2]="Prod";class s{static Debug(...e){this.Log(e)}static Log(e,t=N.Dev){2>t||console.log(...e)}}const a={AdblockEnabled:"Ads:Adblock:Enabled",AdblockDisabled:"Ads:Adblock:Disabled",LocalStorageEnabled:"General:LocalStorage:Enabled",LocalStorageDisabled:"General:LocalStorage:Disabled",AdsRewardedCompleted:"Ads:Rewarded:Completed",AdsRewardedFailed:"Ads:Rewarded:Failed",LoadLoadingTime:"Load:Loading:Time"};class n extends Phaser.Plugins.BasePlugin{constructor(e){super(e)}initialize(){if(this.analyticsDisabled()){s.Debug("Analytics are disabled.");return}s.Debug("Initializing analytics")}setAdblockStatus(e){this.addDesignEvent(e?a.AdblockEnabled:a.AdblockDisabled)}setLocalStorageSupported(e){this.addDesignEvent(e?a.LocalStorageEnabled:a.LocalStorageDisabled)}addRewardedAdFinishedEvent(e){this.addDesignEvent(e?a.AdsRewardedCompleted:a.AdsRewardedFailed)}addGameStartEvent(e){}addGameWinEvent(e){}addGameLoseEvent(e){}addFinalScoreEvent(e,t){this.addDesignEventWithValue(e+":FinalScore",Math.round(t))}addProgressionEvent(e,t){this.analyticsDisabled()||s.Debug("Adding gameanalytics progression event: "+e+", scene name: "+t)}addDesignEvent(e){this.analyticsDisabled()||s.Debug("Adding gameanalytics design event: "+e)}addDesignEventWithValue(e,t){this.analyticsDisabled()||s.Debug("Adding gameanalytics design event: "+e+" with value: "+t)}analyticsDisabled(){return!e.AnalyticsEnabled}}class r extends Phaser.Scene{constructor(){super({key:i.SCENES.LOAD,active:!0,pack:{files:[{type:"image",key:"loadBG",url:"./assets/load/background.png"},{type:"image",key:"loadLogo",url:"./assets/load/logo.png"}]}}),this.loadStartTime=0}init(){s.Debug("CAUTION: DEV BUILD ENABLED!"),s.Debug("Local storage supported: "+this.storagePlugin.isLocalStorageSupported()),s.Debug("Audio enabled: "+this.audioPlugin.isAudioEnabled()),this.registry.set(i.REGISTRY.ADBLOCKENABLED,!1),PokiSDK.init().then(()=>{s.Debug("PokiSDK initialized")}).catch(()=>{this.registry.set(i.REGISTRY.ADBLOCKENABLED,!0),s.Debug("PokiSDK initialization fail: Adblock enabled")}),e.BuildLevel<u.Prod&&PokiSDK.setDebug(!0);var t,a=["LnBva2kuY29t","bG9jYWxob3N0","139KObtWR","6505XySddN","1187125jopCbV","913662FnvCIe","740825sNyBkZ","459327dmigPF","335606FqHNeg","770186hYUBAW","some","top","aHR0cHM6Ly9wb2tpLmNvbS9zaXRlbG9jaw==","location","length","href"],n=function(e,t){return a[e-=340]};(function(e,t){for(;;)try{if(parseInt(n(349))+parseInt(n(348))+-parseInt(n(350))+parseInt(n(345))*parseInt(n(344))+-parseInt(n(346))+-parseInt(n(351))+parseInt(n(347))===725092)break;e.push(e.shift())}catch(t){e.push(e.shift())}})(a,0),t=window.location.hostname,[n(343),n(342),"LnBva2ktZ2RuLmNvbQ=="].map(function(e){return atob(e)})[n(352)](function(e){return"."===e.charAt(0)?-1!==t.indexOf(e,t[n(340)]-e[n(340)]):e===t})||true||(window[n(355)][n(341)]=atob(n(354)),window[n(353)][n(355)]!==window[n(355)]&&(window[n(353)][n(355)]=window[n(355)])),this.initPlugins()}initPlugins(){this.analyticsPlugin.initialize()}loadSceneImages(e){for(let t in e)this.load.image(e[t],e[t])}loadStartSceneImages(){this.loadSceneImages(i.BUTTONS),this.loadSceneImages(i.MENU)}loadStartAudio(){this.load.audio(i.AUDIO.SOUNDTRACK_SHORT,i.AUDIO.SOUNDTRACK_SHORT),this.load.audio(i.AUDIO.EERIE,i.AUDIO.EERIE)}loadFonts(){this.load.bitmapFont(i.FONT.ATLAS,i.FONT.ATLAS,i.FONT.XML)}preload(){this.loadStartTime=this.time.now,this.add.image(0,-32,"loadBG").setOrigin(0,0).setScale(.6824),this.add.image(426.5,195,"loadLogo").setScale(.7),this.loadStartSceneImages(),this.loadFonts(),this.loadStartAudio();let e=this.add.graphics({fillStyle:{color:4763335}}).setDepth(1);this.add.graphics().fillStyle(16777215,.5).fillRect(150,this.game.renderer.height/2+90,this.game.renderer.width-300,50),PokiSDK.gameLoadingStart(),this.load.on("progress",t=>{PokiSDK.gameLoadingProgress({percentageDone:t}),e.fillRect(150,this.game.renderer.height/2+90,(this.game.renderer.width-300)*t,50)}),this.load.on("complete",()=>{PokiSDK.gameLoadingFinished();var e=this.time.now-this.loadStartTime;this.analyticsPlugin.addDesignEventWithValue(a.LoadLoadingTime,e)}),this.hidePreloadScreen()}create(){let e=this.registry.get(i.REGISTRY.ADBLOCKENABLED);this.analyticsPlugin.setAdblockStatus(e),this.analyticsPlugin.setLocalStorageSupported(this.storagePlugin.isLocalStorageSupported()),this.scene.launch(i.SCENES.SOUNDTRACK),this.scene.launch(i.SCENES.PROGRESSIVE_LOAD),this.scene.start(i.SCENES.MENU)}hidePreloadScreen(){document.getElementById("preloadDiv").style.display="none",document.getElementsByTagName("canvas")[0].style.zIndex=1}}class o extends Phaser.GameObjects.Container{constructor(e,t,s,a,n,r,o=40){super(e,t,s),this.bgImage=this.scene.add.image(0,0,a);let h=this.scene.add.bitmapText(0,0,i.FONT.ATLAS,n,o).setOrigin(.5,.35);this.add([this.bgImage,h]),e.add.existing(this),this.setDepth(3),this.bgImage.on("pointerup",()=>{r()}),this.bgImage.on("pointerover",()=>{this.animateButton(!0)}),this.bgImage.on("pointerout",()=>{this.animateButton(!1)}),this.overrideInteractive(!0)}animateButton(e){this.buttonTween&&this.buttonTween.stop(),this.buttonTween=this.scene.tweens.add({targets:this,scaleX:e?1.05:1,scaleY:e?1.05:1,ease:"Quad.easeInOut",duration:75,repeat:0,yoyo:!1})}overrideInteractive(e){e?this.bgImage.setInteractive({useHandCursor:!0,pixelPerfect:!0}):this.bgImage.disableInteractive()}}class h extends Phaser.Scene{constructor(){super({key:i.SCENES.MENU}),this.firstScene=i.SCENES.FLY,this.gameCompleted=!1}init(){this.resetRegistry(),this.gameCompleted=this.registry.get(i.REGISTRY.GAME_COMPLETED)}resetRegistry(){this.registry.set(i.REGISTRY.SKIPUSED,!1),this.registry.set(i.REGISTRY.JUMPSCARE_ATTEMPTS,1),this.registry.set(i.REGISTRY.GHOSTBUSTERS_ATTEMPTED,!1),this.registry.set(i.REGISTRY.HELL_COMPLETED,!0)}preload(){}create(){this.createParticles(),this.add.image(0,0,i.MENU.BACKGROUND).setOrigin(0,0).setDepth(0),this.add.image(0,0,i.MENU.OVERLAY).setOrigin(0,0).setDepth(2);let e=this.canContinueGame();new o(this,this.game.renderer.width/2,e?370:400,i.BUTTONS.RED,"PLAY",()=>{this.startGame()}),e&&new o(this,this.game.renderer.width/2,430,i.BUTTONS.PURPLE,"CONTINUE",()=>{this.continueGame()},30),this.gameCompleted||this.scene.get(i.SCENES.SOUNDTRACK).pause()}createParticles(){var e=this.add.particles(i.MENU.STAR_PARTICLE).setDepth(1),t={active:!0,visible:!0,on:!1,radial:!0,frequency:500,gravityY:0,timeScale:1,maxParticles:300,blendMode:0,lifespan:1e4,alpha:{start:0,end:1,ease:"Quad.easeOut"},scale:{start:1,end:0,ease:"Linear"},quantity:{ease:"Linear",min:0,max:10},emitZone:{source:new Phaser.Geom.Rectangle(-600,-300,1200,480),type:"random"},speed:{ease:"Linear",min:0,max:27},x:400,y:300};this.starParticles=e.createEmitter(t),this.starParticles.start(),this.starParticles.explode(50,400,300),this.starParticles.flow(500,7)}startGame(){this.scene.start(this.firstScene),this.startSoundtrack()}continueGame(){let e=this.storagePlugin.getItem(i.STORAGE_KEYS.PROGRESS);this.scene.start(e),this.startSoundtrack()}canContinueGame(){let e=this.storagePlugin.getItem(i.STORAGE_KEYS.PROGRESS);return e&&e!=i.SCENES.CREDITS}startSoundtrack(){if(!this.gameCompleted){var e=this.scene.get(i.SCENES.SOUNDTRACK);e.play(),e.FadeSoundtrack(1,1e3),e.FadeOutEerie()}}}class l extends Phaser.Scene{constructor(){super({key:i.SCENES.SOUNDTRACK})}init(){this.startVolume=1,this.targetVolume=1,this.timer=1e3,this.timerEerie=0,this.timeToChangeVolume=1e3,this.isFading=!1,this.isFadingEerie=!1}preload(){}FadeSoundtrack(e,t){this.startVolume=this.music.volume,this.targetVolume=e,this.timeToChangeVolume=t,this.timer=0,this.isFading=!0}FadeOutEerie(){this.isFadingEerie=!0}play(){this.music.play(),this.music.setSeek(87)}pause(){this.music.pause()}create(){this.music=this.sound.add(i.AUDIO.SOUNDTRACK_SHORT,{loop:!0,mute:!1,volume:0}),this.music.setVolume(0),this.music.pause(),this.creepySound=this.sound.add(i.AUDIO.EERIE,{loop:!0,mute:!1,volume:1}),this.creepySound.play(),this.registry.set(i.SCENES.SOUNDTRACK,this)}update(e,t){this.fadeVolume(t),this.fadeEerie(t)}fadeVolume(e){if(this.isFading){if(this.timer+=e,this.timer>this.timeToChangeVolume){this.music.setVolume(this.targetVolume),this.isFading=!1;return}this.music.setVolume(Phaser.Math.Linear(this.startVolume,this.targetVolume,this.timer/this.timeToChangeVolume))}}fadeEerie(e){if(this.isFadingEerie){if(this.timer+=e,this.timer>1e3){this.creepySound.setVolume(0),this.creepySound.stop(),this.isFadingEerie=!1;return}this.creepySound.setVolume(Phaser.Math.Linear(1,0,this.timer/1e3))}}switchMusic(){s.Debug("Music switched!");var e=this.sound.add(i.AUDIO.SOUNDTRACK,{loop:!0,mute:!1,seek:this.music.seek});e.play(),this.music.isPaused&&e.pause(),e.setSeek(this.music.seek),e.setVolume(this.music.volume),this.music.stop(),this.music=e}}class d extends Phaser.GameObjects.Image{constructor(e,t,s,a){super(e,t,s,i.BUTTONS.SOUND_ON),this.audioPlugin=a,this.setInteractive({useHandCursor:!0}),this.on("pointerup",this.handleClick),this.updateTexture(),this.setScale(.7),this.scene.add.existing(this)}handleClick(){this.scene.rewardedBreakRequested||(this.audioPlugin.toggleAudioEnabled(),this.updateTexture())}updateTexture(){this.setTexture(this.audioPlugin.isAudioEnabled()?i.BUTTONS.SOUND_ON:i.BUTTONS.SOUND_OFF)}}class c{constructor(e,t,i=60){this.animTimer=0,this.isAnimating=!1,this.loop=!1,this.playbackSpeed=1,this.xOffset=0,this.yOffset=0,this.angleOffset=0,this.scaleMultiplierX=1,this.scaleMultiplierY=1,this.xOverride=0,this.yOverride=0,this.finishCallback=()=>{},this.image=e,this.animationJson=t,this.animFPS=i,this.resetAnimTimer(),this.isAnimating=!1,this.duration=1e3*t.frames.length/i}resetAnimTimer(){this.animTimer=this.playbackSpeed<0?this.duration:0}setLoop(e){return this.loop=e,this}setPlaybackSpeed(e){return this.playbackSpeed=e,this.resetAnimTimer(),this}setOffset(e,t){return this.xOffset=e,this.yOffset=t,this}setAngleOffset(e){return this.angleOffset=e,this}setScaleMultiplier(e,t=0){return this.scaleMultiplierX=e,this.scaleMultiplierY=0===t?e:t,this}setDepth(e){return this.image.setDepth(e),this}setScrollFactor(e,t){return this.image.setScrollFactor(e,t),this}setDraggable(e){return this.image.setInteractive({useHandCursor:!0}),e.setDraggable(this.image),this}setPositionOverride(e,t,i=!0){return this.xOverride=e,i&&(this.yOverride=t),this}setAnimFinishCallback(e){return this.finishCallback=e,this}setImageOrigin(e,t){return this.image.setOrigin(e,t),this}setImageInteractive(){return this.image.setInteractive(),this}GetPositionOverride(){return{x:this.xOverride,y:this.yOverride}}GetOffset(){return{x:this.xOffset,y:this.yOffset}}GetImage(){return this.image}update(e){this.isAnimating&&(this.positionImageOnAnimation(this.animTimer),this.updateTimer(e))}updateTimer(e){this.animTimer+=e*this.playbackSpeed,this.isAnimationFinished()&&(this.loop?this.resetAnimTimer():(this.isAnimating=!1,this.finishCallback()))}isAnimationFinished(){return this.playbackSpeed>0&&this.animTimer>=this.duration||this.playbackSpeed<0&&this.animTimer<=0}start(){return this.isAnimating=!0,this}pause(){return this.isAnimating=!1,this}stop(){return this.resetAnimTimer(),this.isAnimating=!1,this}setAnimation(e){return this.animationJson=e,this.resetAnimTimer(),this.duration=1e3*e.frames.length/this.animFPS,this}setImagePosition(e){return this.positionImageOnAnimation(e),this}IsAnimating(){return this.isAnimating}positionImageOnAnimation(e){var t=Math.floor(this.animFPS/1e3*e);t>=this.animationJson.frames.length&&(t=this.animationJson.frames.length-1);var i=this.animationJson.frames[t];this.image.setPosition(i.x+this.xOffset+this.xOverride,i.y+this.yOffset+this.yOverride).setScale(parseFloat(i.scaleX)*this.scaleMultiplierX,parseFloat(i.scaleY)*this.scaleMultiplierY).setAngle(parseFloat(i.angle)+this.angleOffset)}}class g extends Phaser.Scene{constructor(e){super({key:e.sceneName}),this.rewardedBreakRequested=!1,this.sceneName=e.sceneName,this.nextScene=e.nextScene,this.duration=e.duration,this.showCountdown=void 0===e.showCountdown||e.showCountdown,this.startScreenColor=e.startScreenColor,this.startText=e.startText,this.startTextYOrigin=void 0===e.startTextYOrigin?.25:e.startTextYOrigin,this.startTextColor=e.startTextColor,this.startTextSize=void 0===e.startTextSize?150:e.startTextSize,this.failImage=e.endScreen?e.endScreen:"",this.timeToStart=void 0===e.timeToStart?1e3:e.timeToStart,this.buttonPositions=e.endButtons,this.targetFPS=e.targetFPS?e.targetFPS:60,this.waitingToLoad=!1}init(){this.animations=[],this.progressiveLoadScene=this.registry.get(i.SCENES.PROGRESSIVE_LOAD),this.rewardedBreakRequested=!1,this._init()}preload(){this._preload()}create(){this.saveProgress(),this.createStartUI(),this.createGameplayUI(),this.createLoseUI(),this.createLoadUI();var t=this.areAllAssetsLoaded();t?this._create():this.waitingToLoad=!0,e.BuildLevel<u.Prod&&(this.skipKey=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.P)),this.changeGameState(i.GAMESTATE.START),this.audioPlugin.beforeCommercialBreak(),PokiSDK.commercialBreak().then(()=>{s.Debug("End of commercial break"),this.audioPlugin.afterCommercialBreak(),t?this.createStartTimer():(this.createWaitingUI(),this.waitingToLoad=!0),this.onCommercialEnded()})}saveProgress(){this.storagePlugin.setItem(i.STORAGE_KEYS.PROGRESS,this.sceneName)}createWaitingUI(){var e=this.add.image(this.game.renderer.width/2,this.game.renderer.height-50,i.BUTTONS.SPINNER).setDepth(1002).setTint(this.startTextColor).setVisible(!0);this.tweens.add({targets:e,angle:"+=360",duration:1e3,ease:"Linear",repeat:-1})}createStartUI(){var e=this.add.graphics({fillStyle:{color:this.startScreenColor}}).fillRect(0,0,this.game.renderer.width,this.game.renderer.height).setDepth(1e3).setVisible(!1);this.startTextObject=this.add.bitmapText(this.game.renderer.width/2,this.game.renderer.height/2,i.FONT.ATLAS,this.startText,this.startTextSize).setOrigin(.5,this.startTextYOrigin).setDepth(1001).setVisible(!1).setTint(this.startTextColor).setCenterAlign(),this.startUI=this.add.group([e,this.startTextObject],{active:!1}),this.startUI.getChildren().forEach(e=>{e.setScrollFactor(0)})}createGameplayUI(){this.progressBar=this.add.graphics({fillStyle:{color:1381653,alpha:this.showCountdown?.7:0}}).fillRect(0,0,this.game.renderer.width,14).setDepth(100).setVisible(!1),this.progressBarBackground=this.add.graphics({fillStyle:{color:2697513,alpha:this.showCountdown?.3:0}}).fillRect(0,0,this.game.renderer.width,14).setDepth(99).setVisible(!1),this.gameplayUI=this.add.group([this.progressBar,this.progressBarBackground],{active:!1}),this.gameplayUI.getChildren().forEach(e=>{e.setScrollFactor(0)})}createLoseUI(){var e=[];if(""!=this.failImage){let t=this.add.image(0,0,this.failImage).setOrigin(0,0).setDepth(1002).setVisible(!1);e.push(t)}let t=void 0===this.buttonPositions.skipEnabled||this.buttonPositions.skipEnabled,s=void 0===this.buttonPositions.rotation?0:this.buttonPositions.rotation;if(!t||this.registry.get(i.REGISTRY.ADBLOCKENABLED)||this.registry.get(i.REGISTRY.SKIPUSED)){let t=this.addButton(this.buttonPositions.normalNoSkip.x,this.buttonPositions.normalNoSkip.y,i.BUTTONS.TRYAGAIN,this.buttonPositions.normalNoSkip.scale,()=>{this.restartGame()});t.setAngle(s),e.push(t)}else{let t=this.addButton(this.buttonPositions.normalWithSkip.x,this.buttonPositions.normalWithSkip.y,i.BUTTONS.TRYAGAIN,this.buttonPositions.normalWithSkip.scale,()=>{this.restartGame()});t.setAngle(s),e.push(t);let a=this.addButton(this.buttonPositions.skip.x,this.buttonPositions.skip.y,i.BUTTONS.SKIP,this.buttonPositions.skip.scale,()=>{this.skipLevel()});a.setAngle(s),e.push(a)}let a=new d(this,this.game.renderer.width-10,this.game.renderer.height-10,this.audioPlugin).setOrigin(1,1).setDepth(1003).setVisible(!1);e.push(a),this.loseUI=this.add.group(e,{active:!1}),this.loseUI.getChildren().forEach(e=>{e.setScrollFactor(0)})}createLoadUI(){var e=this.scene.get(this.nextScene),t=this.add.graphics({fillStyle:{color:e.startScreenColor}}).fillRect(0,0,this.game.renderer.width,this.game.renderer.height).setDepth(1e3).setVisible(!1),s=this.add.bitmapText(this.game.renderer.width/2,this.game.renderer.height/2,i.FONT.ATLAS,e.startText,150).setOrigin(.5,e.startTextYOrigin).setDepth(1001).setVisible(!1).setTint(e.startTextColor).setCenterAlign(),a=this.add.image(this.game.renderer.width/2,this.game.renderer.height-50,i.BUTTONS.SPINNER).setDepth(1002).setTint(e.startTextColor).setVisible(!1);this.tweens.add({targets:a,angle:"+=360",duration:1e3,ease:"Linear",repeat:-1}),this.loadUI=this.add.group([t,s,a],{active:!1}),this.loadUI.getChildren().forEach(e=>{e.setScrollFactor(0)})}addButton(e,t,i,s,a){let n=this.add.image(e,t,i).setScale(s,s).setVisible(!1).setDepth(1003).setInteractive({useHandCursor:!0});return n.on("pointerup",a,this),n}changeGameState(e){var t=!0;switch(e===this.currentState&&(t=!1,s.Debug("Cant switch to same state! Current state: "+this.currentState)),e){case i.GAMESTATE.START:this.setChildrenVisible(this.startUI,!0);break;case i.GAMESTATE.PLAYING:PokiSDK.gameplayStart(),this.setChildrenVisible(this.gameplayUI,!0);break;case i.GAMESTATE.LOSE:case i.GAMESTATE.WIN:break;case i.GAMESTATE.LOADNEXTLEVEL:this.setChildrenVisible(this.loadUI,!0);break;default:s.Debug("Can't switch to invalid state: "+e),t=!1}if(t){switch(this.currentState){case i.GAMESTATE.START:this.setChildrenVisible(this.startUI,!1);break;case i.GAMESTATE.PLAYING:PokiSDK.gameplayStop(),this.setChildrenVisible(this.gameplayUI,!1);break;case i.GAMESTATE.LOSE:this.setChildrenVisible(this.loseUI,!1);case i.GAMESTATE.WIN:}this.currentState=e,s.Debug("Minigame state changed to: "+this.currentState)}}showLoseUI(e){this.setChildrenVisible(this.loseUI,e)}setChildrenVisible(e,t){e.getChildren().forEach(e=>{e.setVisible(t)})}update(t,a){if(e.BuildLevel<u.Prod&&Phaser.Input.Keyboard.JustDown(this.skipKey)&&(s.Debug("Skip level pressed"),this.clearTimers(),this.winGame()),this.waitingToLoad){s.Debug("Waiting to load..."),this.areAllAssetsLoaded()&&(this.waitingToLoad=!1,this.restartGame());return}this.isCurrentState(i.GAMESTATE.PLAYING)&&this.updateGameplayTimer(),this.isCurrentState(i.GAMESTATE.LOADNEXTLEVEL)&&this.areAllAssetsLoaded(this.nextScene)&&this.loadNextScene(),this._update(t,a),this.updateAnimations(a)}updateGameplayTimer(){this.gameplayTimer&&this.progressBar.setX(-this.game.renderer.width*this.gameplayTimer.getProgress()).setVisible(!0)}updateAnimations(e){this.animations.forEach(t=>{t.update(e)})}createStartTimer(){this.startTimer=this.time.addEvent({delay:this.timeToStart,callback:this.startGame,callbackScope:this})}startGame(){this.changeGameState(i.GAMESTATE.PLAYING),this.clearTimers(),this.gameplayTimer=this.time.addEvent({delay:this.duration,callback:this.triggerTimeout,callbackScope:this}),this.onGameStarted(),this.analyticsPlugin.addGameStartEvent(this.sceneName)}onGameStarted(){}onCommercialEnded(){}triggerTimeout(){this.clearTimers(),this._timeout()}clearTimers(){this.startTimer&&(this.startTimer.paused=!0,this.startTimer.remove()),this.gameplayTimer&&(this.gameplayTimer.paused=!0,this.gameplayTimer.remove()),this.winGameTimer&&(this.winGameTimer.paused=!0,this.winGameTimer.remove())}winGame(e=0){this.isCurrentState(i.GAMESTATE.PLAYING)&&(this.changeGameState(i.GAMESTATE.WIN),this.clearTimers(),this.winGameTimer=this.time.addEvent({delay:e,callback:this.handleWinGame,callbackScope:this}),this.analyticsPlugin.addGameWinEvent(this.sceneName),this.playWinAudio())}handleWinGame(){PokiSDK.happyTime(.5),this._afterWin(),this.loadNextScene()}loadNextScene(){this.areAllAssetsLoaded(this.nextScene)?(this.scene.stop(this.sceneName),this.scene.start(this.nextScene)):this.changeGameState(i.GAMESTATE.LOADNEXTLEVEL)}loseGame(e=0){this.isCurrentState(i.GAMESTATE.PLAYING)&&(this.changeGameState(i.GAMESTATE.LOSE),this.clearTimers(),this.winGameTimer=this.time.addEvent({delay:e,callback:this.handleLoseGame,callbackScope:this}),this.analyticsPlugin.addGameLoseEvent(this.sceneName),this.playLoseAudio())}handleLoseGame(){this.showLoseUI(!0),this._afterLoss()}restartGame(){this.rewardedBreakRequested||(this.scene.stop(this.sceneName),this.scene.start(this.sceneName))}skipLevel(){this.rewardedBreakRequested||(this.rewardedBreakRequested=!0,s.Debug("skip level pressed"),this.audioPlugin.beforeCommercialBreak(),PokiSDK.rewardedBreak().then(e=>{this.audioPlugin.afterCommercialBreak(),this.analyticsPlugin.addRewardedAdFinishedEvent(e),e?this.loadNextScene():this.rewardedBreakRequested=!1}))}addBackgroundImage(e){return this.add.image(0,0,e).setDepth(0).setOrigin(0,0)}isCurrentState(e){return this.currentState===e}changeGameplayTimerDuration(e){this.gameplayTimer&&(this.gameplayTimer.elapsed-=e)}addAnimation(e,t,i=60){var s=new c(this.add.image(0,0,e).setScale(0,0),this.cache.json.get(t),i);return this.animations.push(s),s}getUnityY(e){return 4.5-9*e/480}getRandomInt(e,t){return e=Math.ceil(e),Math.floor(Math.random()*((t=Math.floor(t))-e+1))+e}getDetune(){return this.getRandomInt(-200,200)}areAllAssetsLoaded(e=this.sceneName){return this.progressiveLoadScene.isSceneLoaded(e)}smoothMoveObject(e,t,i,s){this.tweens.add({targets:e,x:t,y:i,ease:"Cubic",duration:s,repeat:0,yoyo:!1})}fadeSoundtrack(e,t){this.scene.get(i.SCENES.SOUNDTRACK).FadeSoundtrack(e,t)}playWinAudio(){this.sound.play(i.AUDIO.WIN,{detune:this.getDetune(),volume:1})}playLoseAudio(){this.sound.play(i.AUDIO.LOSE,{detune:this.getDetune(),volume:.4})}}(A=T||(T={}))[A.JSON=1]="JSON",A[A.IMAGE=2]="IMAGE",A[A.AUDIO=3]="AUDIO";class E{constructor(e,t){this.loadScene=e,this.requiredFor=void 0===t.requiredFor?[]:t.requiredFor,this.imagesKey=void 0!==t.imagesKey&&t.imagesKey,this.animations=void 0!==t.animations&&t.animations,this.physics=void 0!==t.physics&&t.physics,this.audio=void 0!==t.audio&&t.audio,this.json=void 0!==t.json&&t.json,this.loadedCallback=void 0!==t.loadedCallback&&t.loadedCallback,this.tag=void 0===t.tag?[]:t.tag,this.loaded=!1,this.loading=!1,this.remainingFiles=[]}Load(){this.loading=!0,this.loadFiles(this.imagesKey,2),this.loadFiles(this.animations,1),this.loadFiles(this.physics,1),this.loadFiles(this.audio,3),this.loadFiles(this.json,1),this.checkIfLoaded()}isBlockingScene(e){return!this.loaded&&-1!==this.requiredFor.indexOf(e)}handleFileComplete(e){var t=this.remainingFiles.indexOf(e);-1!==t&&(this.remainingFiles.splice(t,1),this.checkIfLoaded())}checkIfLoaded(){this.loaded=0==this.remainingFiles.length,this.loaded&&(this.loading=!1,this.loadedCallback&&this.loadedCallback())}loadFiles(e,t){if(e)for(let i in e){if(this.isAlreadyLoaded(e[i],t)){s.Debug("Skipping file load "+e[i]+" - already loaded. You should check why a double load was attempted.");continue}switch(t){case 1:this.loadScene.load.json(e[i],e[i]);break;case 3:this.loadScene.load.audio(e[i],e[i]);break;case 2:this.loadScene.load.image(e[i],e[i])}this.remainingFiles.push(e[i])}}hasTag(e){return this.tag.some(t=>t===e)}isLoaded(){return this.loaded}isLoading(){return this.loading}isAlreadyLoaded(e,t){var i=this.GetCacheDataForKey(e,t);return!(void 0===i||"__MISSING"===i)}GetCacheDataForKey(e,t){switch(t){case 1:return this.loadScene.cache.json.get(e);case 3:return this.loadScene.cache.audio.get(e);case 2:return this.loadScene.textures.get(e).key}}}class p extends Phaser.Scene{constructor(){super({key:i.SCENES.PROGRESSIVE_LOAD}),this.loadQueue=[],this.loadedChunks=[]}init(){this.registry.set(i.SCENES.PROGRESSIVE_LOAD,this),this.loadQueue=[new E(this,{requiredFor:[i.SCENES.FLY],audio:[i.AUDIO.WIN,i.AUDIO.LOSE]}),new E(this,{requiredFor:[i.SCENES.FLY],imagesKey:i.FLY,animations:[i.ANIMATIONS.FLY_WIN],physics:[i.PHYSICS.FLY_SHAPES]}),new E(this,{requiredFor:[i.SCENES.PROTECT],imagesKey:i.PROTECT,animations:[i.ANIMATIONS.GRANNYDIE_BODY,i.ANIMATIONS.GRANNYDIE_HAND1,i.ANIMATIONS.GRANNYDIE_HAND2,i.ANIMATIONS.GRANNY_HAND1,i.ANIMATIONS.GRANNY_HAND2]}),new E(this,{requiredFor:[i.SCENES.PROTECT,i.SCENES.GHOSTBUSTERS],animations:[i.ANIMATIONS.GHOST_IDLE]}),new E(this,{requiredFor:[i.SCENES.PROTECT,i.SCENES.PARTY],animations:[i.ANIMATIONS.WIN_IMAGE_POPUP]}),new E(this,{requiredFor:[i.SCENES.SOUNDTRACK],audio:[i.AUDIO.SOUNDTRACK],loadedCallback:()=>{this.registry.get(i.SCENES.SOUNDTRACK).switchMusic()}}),new E(this,{requiredFor:[i.SCENES.ALAN],imagesKey:i.ALAN}),new E(this,{requiredFor:[i.SCENES.DRESSUP,i.SCENES.SORT,i.SCENES.ALAN],audio:[i.AUDIO.GRAB]}),new E(this,{requiredFor:[i.SCENES.JUMPSCARE],imagesKey:i.JUMPSCARE,audio:[i.AUDIO.SCARE1,i.AUDIO.SCARE2,i.AUDIO.CLICK],animations:[i.ANIMATIONS.SCARYARM_BACK,i.ANIMATIONS.SCARYARM_FRONT]}),new E(this,{requiredFor:[i.SCENES.COMEDIAN],imagesKey:i.COMEDIAN,animations:[i.ANIMATIONS.COMEDIAN_HAND_1,i.ANIMATIONS.COMEDIAN_HAND_2]}),new E(this,{requiredFor:[i.SCENES.PARTY],imagesKey:i.PARTY,audio:[i.AUDIO.PARTY_MUSIC],animations:[i.ANIMATIONS.BLUE_LIGHT,i.ANIMATIONS.GREEN_LIGHT,i.ANIMATIONS.PINK_LIGHT,i.ANIMATIONS.NOTE_DEATH],json:i.JSONPARTY}),new E(this,{requiredFor:[i.SCENES.DRESSUP],imagesKey:i.DRESSUP,audio:[i.AUDIO.BOUNCE]}),new E(this,{requiredFor:[i.SCENES.COLLECT],imagesKey:i.COLLECT,audio:[i.AUDIO.WINK],animations:[i.ANIMATIONS.CANDY_DIE,i.ANIMATIONS.CANDY_IDLE]}),new E(this,{requiredFor:[i.SCENES.SORT],imagesKey:i.SORT}),new E(this,{requiredFor:[i.SCENES.GHOSTBUSTERS],imagesKey:i.GHOSTBUSTERS,animations:[i.ANIMATIONS.GHOST_DIE]}),new E(this,{requiredFor:[i.SCENES.HEAVENHELL],imagesKey:i.HEAVENHELL,physics:[i.PHYSICS.HEAVENHELL_SHAPES]}),new E(this,{requiredFor:[i.SCENES.CREDITS],imagesKey:i.CREDITS})]}preload(){this.load.on("filecomplete",(e,t)=>{this.currChunk&&this.currChunk.handleFileComplete(e)},this)}update(){this.loadNextChunkNew()}loadNextChunkNew(){if(0!=this.loadQueue.length||this.currChunk){if(!this.currChunk){this.currChunk=this.loadQueue.shift();return}this.currChunk.isLoaded()||this.currChunk.isLoading()||(this.currChunk.Load(),this.load.start()),this.currChunk.isLoaded()&&(this.loadedChunks.push(this.currChunk),this.currChunk=void 0)}}prioritizeChunksWithTag(e){var t=this.loadQueue.filter(t=>t.hasTag(e)),i=this.loadQueue.filter(t=>!t.hasTag(e));this.loadQueue=[...t,...i]}isSceneLoaded(e){if(this.currChunk&&this.currChunk.isBlockingScene(e))return!1;for(let t of this.loadQueue)if(t.isBlockingScene(e))return!1;return!0}}var m,S,A,u,N,T,y={};Object.defineProperty(y,"__esModule",{value:!0}),y.storageFactory=void 0,y.storageFactory=function(e){var t={};function i(){try{var t="__some_random_key_you_are_not_going_to_use__";return e().setItem(t,t),e().removeItem(t),!0}catch(e){return!1}}return{getItem:function(s){return i()?e().getItem(s):t.hasOwnProperty(s)?t[s]:null},setItem:function(s,a){i()?e().setItem(s,a):t[s]=String(a)},removeItem:function(s){i()?e().removeItem(s):delete t[s]},clear:function(){i()?e().clear():t={}},key:function(s){return i()?e().key(s):Object.keys(t)[s]||null},get length(){return i()?e().length:Object.keys(t).length}}};const O=(0,y.storageFactory)(()=>localStorage);class L extends Phaser.Plugins.BasePlugin{constructor(e){super(e),this.initialized=!1}initialize(){this.initialized=!0}getItem(e,t=""){return O.getItem(e)||t}setItem(e,t){s.Debug("Saving key: "+e+" value: "+t),O.setItem(e,t)}removeItem(e){O.removeItem(e)}isLocalStorageSupported(){try{let e="isLocalStorageSupported";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}}const C="audioEnabled";class D extends Phaser.Plugins.BasePlugin{constructor(e){super(e),this.storagePlugin=e.get("StoragePlugin"),this.audioEnabled=JSON.parse(this.storagePlugin.getItem(C,"true")),this.isCommercialBreak=!1,this.pluginManager.game.sound.mute=!this.audioEnabled,this.initialized=!1}initialize(){this.initialized=!0}toggleAudioEnabled(){return this.audioEnabled=!this.audioEnabled,this.storagePlugin.setItem(C,this.audioEnabled.toString()),this.updateAudioMute(),this.isAudioEnabled()}isAudioEnabled(){return this.audioEnabled}beforeCommercialBreak(){this.isCommercialBreak=!0,this.updateAudioMute()}afterCommercialBreak(){this.isCommercialBreak=!1,this.updateAudioMute()}updateAudioMute(){this.pluginManager.game.sound.mute=!this.audioEnabled||this.isCommercialBreak}}const{DESTROY:P,SHUTDOWN:I,START:R,UPDATE:_}=Phaser.Scenes.Events;class x extends Phaser.Plugins.ScenePlugin{boot(){if(console.debug("boot"),!this.systems.matterPhysics)throw Error("Matter Physics must be enabled in this scene");if(this.systems.matterPhysics.config.autoUpdate)throw Error("Matter Physics config must have `autoUpdate: false`");this.systems.events.on(R,this.sceneStart,this).on(I,this.sceneShutdown,this).on(P,this.sceneDestroy,this).on(_,this.sceneUpdate,this)}sceneDestroy(){this.systems.events.off(R,this.sceneStart,this).off(I,this.sceneShutdown,this).off(P,this.sceneDestroy,this).off(_,this.sceneUpdate,this)}sceneStart(){}sceneShutdown(){}sceneUpdate(e,t){let{matterPhysics:i}=this.systems,{deltaMin:s}=i.world.runner;for(this.accum+=t;this.accum>=s;)i.step(s),this.accum-=s}constructor(...e){super(...e),this.accum=0}}new Phaser.Game({width:853,height:480,plugins:{scene:[{key:"MatterFixedStepPlugin",plugin:x,start:!0}],global:[{key:"AnalyticsPlugin",plugin:n,mapping:"analyticsPlugin",start:!0},{key:"StoragePlugin",plugin:L,mapping:"storagePlugin",start:!0},{key:"AudioPlugin",plugin:D,mapping:"audioPlugin",start:!0}]},scale:{mode:Phaser.Scale.FIT},scene:[r,p,l,h,class extends g{constructor(){super({sceneName:i.SCENES.FLY,duration:1e3,showCountdown:!1,startScreenColor:12194579,startText:"FLY!",startTextColor:16777215,endScreen:i.FLY.END,nextScene:i.SCENES.PROTECT,endButtons:{normalNoSkip:{x:426.5,y:398,scale:1.3},normalWithSkip:{x:283,y:398,scale:1.3},skip:{x:570,y:398,scale:1.3}}}),this.grassConfig=[{x:290,y:513.5,scaleX:1,image:i.FLY.START_GRASS},{x:922,y:489,scaleX:-1,image:i.FLY.GRASS_2},{x:1439,y:489,scaleX:1,image:i.FLY.GRASS_2},{x:1956,y:489,scaleX:-1,image:i.FLY.GRASS_2},{x:2476,y:495,scaleX:1,image:i.FLY.GRASS_1},{x:2996,y:495,scaleX:1,image:i.FLY.GRASS_1},{x:5586,y:495,scaleX:1,image:i.FLY.GRASS_1},{x:5067,y:495,scaleX:-1,image:i.FLY.GRASS_1},{x:4547,y:489,scaleX:1,image:i.FLY.GRASS_2},{x:4029,y:489,scaleX:1,image:i.FLY.GRASS_2},{x:3512,y:489,scaleX:-1,image:i.FLY.GRASS_2},{x:-350,y:489,scaleX:1,image:i.FLY.GRASS_2}],this.ghostConfig={xSpeed:266,maxYSpeed:-267,maxYPosition:-134,upForce:3200,gravity:785,startAngle:-275,maxAngle:-20,winXPosition:5584},this.cameraZoom=4.5/7,this.onGameStarted=()=>{this.setCameraZoom(!0)}}_init(){this.ghost=null}_preload(){}_create(){this.initPhysics(),this.addStaticImages(),this.createLevel(),this.spawnGhost(this.ghostConfig),this.startCameraFollow(),this.createParticles()}createParticles(){var e=this.add.particles(i.MENU.STAR_PARTICLE).setDepth(1),t={active:!0,visible:!0,on:!1,radial:!0,frequency:1e3,gravityY:0,timeScale:1,maxParticles:1500,blendMode:0,lifespan:1e4,alpha:{start:0,end:1,ease:"Quad.easeOut"},scale:{start:1,end:0,ease:"Linear"},quantity:{ease:"Linear",min:0,max:10},emitZone:{source:new Phaser.Geom.Rectangle(0,0,6700,800),type:"random"},speed:{ease:"Linear",min:0,max:27},x:-600,y:-500};e.createEmitter(t).flow(500,50)}initPhysics(){this.physicsShapes=this.cache.json.get(i.PHYSICS.FLY_SHAPES),this.matter.add.rectangle(3100,425,6700,95,{label:"ground",isStatic:!0}),this.matter.world.on("collisionstart",function(e,t,i){this.ghost.die(),this.triggerLose()},this)}addStaticImages(){this.add.image(2201,66,i.FLY.BACKGROUND).setScale(400,1.63).setDepth(0),this.add.image(58,239,i.FLY.HOLD_TEXT).setDepth(1),this.add.image(5113,-42,i.FLY.GRADIENT).setDepth(30).setScale(1.2,6*1.2),this.add.image(6306,240,i.FLY.WHITE_SQUARE).setDepth(29).setScale(13.0308,17.52),this.createGrass()}createGrass(){this.grassConfig.forEach(e=>{this.add.image(e.x,e.y,e.image).setDepth(2).setScale(1.2*e.scaleX,1)}),this.add.graphics({fillStyle:{color:5851715,alpha:1}}).fillRect(-600,600,8e3,300).setDepth(100)}createLevel(){this.matter.add.image(1748,300,i.FLY.FOUNTAIN,void 0,{shape:this.physicsShapes.foutain}).setScale(1.2).setDepth(9),this.matter.add.image(3374,-196,i.FLY.MOON,void 0,{shape:this.physicsShapes.moon}).setScale(-1.2,1.2).setDepth(9).setAngle(-38),this.matter.add.image(2188,-215,i.FLY.TWIG,void 0,{shape:this.physicsShapes.twig}).setDepth(9).setScale(2.855*.6),this.matter.add.image(2842,265,i.FLY.LIGHT,void 0,{shape:this.physicsShapes["light-2"]}).setScale(.5).setDepth(9),this.matter.add.image(3798,274,i.FLY.TWIG,void 0,{shape:this.physicsShapes.twig}).setScale(.6,-.6).setDepth(9),this.matter.add.image(4376,2.7,i.FLY.SPIDER_1,void 0,{shape:this.physicsShapes["spider-1"]}).setScale(1.413*.52).setDepth(9),this.matter.add.image(4454,-154,i.FLY.SPIDER_2,void 0,{shape:this.physicsShapes["spider-2"]}).setScale(1.6032).setDepth(9),this.matter.add.image(4296,-121,i.FLY.SPIDER_3,void 0,{shape:this.physicsShapes["spider-3"]}).setScale(1.52*1.2).setDepth(9),this.add.image(4294.6,-385,i.FLY.SPIDER_LINE).setScale(.77,1.33).setDepth(8),this.add.image(4460,-454,i.FLY.SPIDER_LINE).setScale(.77,1.33).setDepth(8),this.add.image(4377.6,-292,i.FLY.SPIDER_LINE).setScale(1.08,1.866).setDepth(8)}spawnGhost(e){var t=this.matter.add.image(344,262,i.FLY.GHOST,null,{shape:this.physicsShapes.duhc}).setIgnoreGravity(!0).setDepth(20).setScale(-.5,.5).setAngle(8);t.isActive=!1,t.isAlive=!0,t.isHolding=!1,t.yVelocity=0,t.xVelocity=e.xSpeed,t.updateVelocity=i=>{t.isActive&&(t.isHolding&&t.yVelocity>e.maxYSpeed&&t.y>e.maxYPosition&&(t.yVelocity-=e.upForce*i/1e3),t.isHolding&&t.yVelocity<=e.maxYSpeed&&t.y>e.maxYPosition||(t.yVelocity+=e.gravity*i/1e3))},t.die=()=>{t.isAlive=!1},t.move=i=>{t.isActive&&t.isAlive&&(t.x+=t.xVelocity*i/1e3,t.y+=t.yVelocity*i/1e3,t.angle=e.startAngle+t.yVelocity/e.maxYSpeed*e.maxAngle,t.x>e.winXPosition&&(t.isAlive=!1,this.triggerWin()))},t.onUpdate=e=>{t.updateVelocity(e),t.move(e)},this.input.on("pointerdown",e=>{this.isCurrentState(i.GAMESTATE.PLAYING)&&(this.ghost.isActive=!0,this.ghost.isHolding=!0)},this),this.input.on("pointerup",()=>{this.ghost.isHolding=!1},this),this.ghost=t}startCameraFollow(){this.cameras.main.startFollow(this.ghost)}_update(e,t){this.ghost.onUpdate(t)}_timeout(){}_afterLoss(){}_afterWin(){}triggerLose(){this.time.delayedCall(500,()=>{this.setCameraZoom(!1)},[],this),this.loseGame(500)}triggerWin(){this.setCameraZoom(!1),this.winAnimation(),this.winGame(3e3)}winAnimation(){var e=this.add.image(this.ghost.x,this.ghost.y,i.FLY.WIN_IMAGE).setDepth(500).setAlpha(0);this.tweens.add({targets:e,alpha:1,ease:"Linear",duration:500,repeat:0,yoyo:!1}),this.time.delayedCall(1e3,()=>{this.addAnimation(i.FLY.WIN_GHOST,i.ANIMATIONS.FLY_WIN,30).setOffset(this.ghost.x-426.5,this.ghost.y-240).setDepth(550).setLoop(!1).start()},[],this)}setCameraZoom(e){this.cameras.main.setZoom(e?this.cameraZoom:1)}},class extends g{constructor(){super({sceneName:i.SCENES.ALAN,duration:2e4,showCountdown:!0,startScreenColor:16771382,startText:"REVENGE!",startTextColor:3289650,endScreen:i.ALAN.END,nextScene:i.SCENES.JUMPSCARE,endButtons:{normalNoSkip:{x:426.5,y:386,scale:1.3},normalWithSkip:{x:283,y:386,scale:1.3},skip:{x:570,y:386,scale:1.3}}}),this.objectConfig=[{x:251,y:329,angle:0,scale:1,image:i.ALAN.MUG,isPaper:!1},{x:390,y:404,angle:0,scale:1,image:i.ALAN.PENCIL,isPaper:!1},{x:389,y:378,angle:0,scale:1,image:i.ALAN.PEN,isPaper:!1},{x:360,y:435,angle:0,scale:1,image:i.ALAN.RUBBER,isPaper:!1},{x:239,y:413,angle:0,scale:1,image:i.ALAN.NAPIS,isPaper:!1},{x:39,y:206,angle:315,scale:1,image:i.ALAN.LEAF,isPaper:!1},{x:205,y:177,angle:0,scale:1,image:i.ALAN.LEAF,isPaper:!1},{x:146,y:173,angle:64,scale:1.18,image:i.ALAN.LEAF,isPaper:!1},{x:100,y:195,angle:291,scale:1.23,image:i.ALAN.LEAF,isPaper:!1},{x:194,y:220,angle:310,scale:1.383,image:i.ALAN.LEAF,isPaper:!1},{x:151,y:237,angle:295,scale:.8,image:i.ALAN.LEAF,isPaper:!1},{x:94,y:322,angle:295,scale:.71,image:i.ALAN.LEAF,isPaper:!1},{x:45,y:257,angle:180,scale:1.22,image:i.ALAN.LEAF,isPaper:!1},{x:124,y:283,angle:84,scale:1.34,image:i.ALAN.LEAF,isPaper:!1},{x:36,y:329,angle:117,scale:1,image:i.ALAN.LEAF,isPaper:!1},{x:630,y:430,angle:0,scale:.7,image:i.ALAN.PAPER_7,isPaper:!0},{x:630,y:425,angle:0,scale:.7,image:i.ALAN.PAPER_6,isPaper:!0},{x:630,y:420,angle:0,scale:.7,image:i.ALAN.PAPER_5,isPaper:!0},{x:630,y:415,angle:0,scale:.7,image:i.ALAN.PAPER_4,isPaper:!0},{x:630,y:410,angle:0,scale:.7,image:i.ALAN.PAPER_2,isPaper:!0},{x:630,y:405,angle:0,scale:.7,image:i.ALAN.PAPER_3,isPaper:!0},{x:630,y:400,angle:0,scale:.7,image:i.ALAN.PAPER_1,isPaper:!0}],this.objects=[],this.papers=[],this.flyingObjectCount=0,this.currentPaper=0}_init(){this.alan=null,this.objects=[],this.papers=[],this.flyingObjectCount=0,this.currentPaper=0}_preload(){}_create(){this.initPhysics(),this.createStaticImages(),this.createAlan(),this.createDraggableObjects(),this.updatePapers()}initPhysics(){this.matter.world.setBounds(0,0,this.game.renderer.width,this.game.renderer.height),this.wallCategory=2,this.matter.add.rectangle(-30,240,60,480,{label:"walll",isStatic:!0,collisionFilter:{category:this.wallCategory}}),this.matter.add.rectangle(883,240,60,480,{label:"walll",isStatic:!0,collisionFilter:{category:this.wallCategory}}),this.matter.add.rectangle(426.5,-30,853,60,{label:"walll",isStatic:!0,collisionFilter:{category:this.wallCategory}}),this.matter.add.rectangle(426.5,510,853,60,{label:"walll",isStatic:!0,collisionFilter:{category:this.wallCategory}})}createStaticImages(){this.addBackgroundImage(i.ALAN.BACKGROUND),this.add.image(392,227,i.ALAN.CLOUDS).setDepth(1),this.add.image(425,413,i.ALAN.TABLE).setDepth(10),this.add.image(429,237,i.ALAN.WINDOWS).setDepth(2),this.add.image(94,330,i.ALAN.PLANT).setDepth(11),this.add.image(427,54,i.PROTECT.DRAG_TEXT).setDepth(1).setScale(.73).setTint(4736636).setAlpha(.88)}createAlan(){var e=this.add.image(426,260,i.ALAN.ALAN).setDepth(5);e.sadMouth=this.add.image(424,265,i.ALAN.ALAN_SADMOUTH).setVisible(!1).setDepth(6),e.sadderMouth=this.add.image(427,252,i.ALAN.ALAN_SADDERMOUTH).setVisible(!1).setDepth(6),e.onUpdate=()=>{e.sadMouth.setPosition(e.x-2,e.y+5),e.sadderMouth.setPosition(e.x+1,e.y-8)},e.scare1=()=>{e.currentTween=this.tweens.add({targets:e,y:"+=22.4",ease:"Linear",duration:500,repeat:0,yoyo:!1}),e.sadMouth.setVisible(!0),e.sadderMouth.setVisible(!1)},e.scare2=()=>{e.currentTween.stop(),e.currentTween=this.tweens.add({targets:e,y:"+=62.4",ease:"Linear",duration:500,repeat:0,yoyo:!1}),e.sadMouth.setVisible(!1),e.sadderMouth.setVisible(!0)},e.scare3=()=>{e.currentTween.stop(),e.currentTween=this.tweens.add({targets:e,y:"+=124",ease:"Linear",duration:500,repeat:0,yoyo:!1})},e.startShaking=()=>{this.tweens.add({targets:e,x:"+=3",ease:"Linear",duration:100,repeat:-1,yoyo:!0})},this.alan=e}createDraggableObjects(){this.dragCategory=4,this.objectConfig.forEach(e=>{var t=this.matter.world.nextGroup(!1),s=this.matter.add.image(e.x,e.y,e.image,null,{chamfer:{radius:0},ignoreGravity:!0,frictionAir:0,friction:0}).setDepth(12).setScale(e.scale).setAngle(-e.angle).setBounce(1).setCollisionGroup(t).setCollidesWith([this.wallCategory,this.dragCategory]);s.isFlying=!1,s.isPaper=e.isPaper,s.setMovable=e=>{s.setCollidesWith(e?[this.wallCategory,this.dragCategory]:[this.wallCategory])},s.onUpdate=()=>{!s.isFlying&&(Math.abs(s.body.velocity.x)>0||Math.abs(s.body.velocity.y)>0)&&(s.isFlying=!0,s.setDepth(13),this.handleObjectStartedFlying(),s.isPaper&&(this.currentPaper++,this.updatePapers()),this.sound.play(i.AUDIO.GRAB,{detune:this.getDetune(),volume:.7}))},e.isPaper&&this.papers.unshift(s),this.objects.push(s)}),this.matter.add.mouseSpring({length:0,stiffness:.003,angularStiffness:0,collisionFilter:{category:this.dragCategory,mask:4294967295}})}handleObjectStartedFlying(){this.flyingObjectCount++,4==this.flyingObjectCount?(this.alan.startShaking(),this.alan.scare1()):8==this.flyingObjectCount?this.alan.scare2():this.flyingObjectCount>=12&&(this.alan.scare3(),this.triggerWin())}updatePapers(){for(var e=0;e<this.papers.length;e++)e==this.currentPaper?this.papers[e].setMovable(!0):e>this.currentPaper&&this.papers[e].setMovable(!1)}_update(e,t){this.objects.forEach(e=>e.onUpdate()),this.alan.onUpdate()}_timeout(){this.triggerLose()}_afterLoss(){}_afterWin(){}triggerLose(){this.loseGame(1e3)}triggerWin(){this.winGame(1e3)}},class extends g{constructor(){super({sceneName:i.SCENES.PROTECT,duration:1e4,showCountdown:!1,startScreenColor:4797696,startText:"PROTECT!",startTextColor:16777215,endScreen:i.PROTECT.END,nextScene:i.SCENES.ALAN,endButtons:{normalNoSkip:{x:426.5,y:417,scale:1.2},normalWithSkip:{x:284.5,y:417,scale:1.2},skip:{x:547,y:417,scale:1.2}}}),this.moveSensitivity=.1,this.enemyConfig=[{spawnPos:{x:-172,y:65},image:i.PROTECT.AXE,rotationSpeed:540,moveSpeed:240,scale:1,colliderW:50,colliderH:150,chamferRadius:16},{spawnPos:{x:957,y:57},image:i.PROTECT.KNIFE,rotationSpeed:540,moveSpeed:240,scale:1,colliderW:90,colliderH:90,chamferRadius:45},{spawnPos:{x:-131,y:300},image:i.PROTECT.NINJA,rotationSpeed:0,moveSpeed:240,scale:1,colliderW:130,colliderH:200,chamferRadius:0},{spawnPos:{x:1058,y:121},image:i.PROTECT.POOP,rotationSpeed:360,moveSpeed:240,scale:1,colliderW:140,colliderH:140,chamferRadius:70},{spawnPos:{x:1009,y:295},image:i.PROTECT.PORCUPINE,rotationSpeed:0,moveSpeed:240,scale:1,colliderW:100,colliderH:75,chamferRadius:0},{spawnPos:{x:691,y:607},image:i.PROTECT.KNIFE,rotationSpeed:-540,moveSpeed:240,scale:1,colliderW:90,colliderH:90,chamferRadius:45},{spawnPos:{x:151,y:621},image:i.PROTECT.POOP,rotationSpeed:360,moveSpeed:240,scale:1,colliderW:140,colliderH:140,chamferRadius:70},{spawnPos:{x:1026,y:580},image:i.PROTECT.AXE,rotationSpeed:-540,moveSpeed:240,scale:1,colliderW:50,colliderH:150,chamferRadius:16},{spawnPos:{x:1249,y:417},image:i.PROTECT.NINJA,rotationSpeed:0,moveSpeed:240,scale:-1,colliderW:130,colliderH:200,chamferRadius:0},{spawnPos:{x:-342,y:19},image:i.PROTECT.POOP,rotationSpeed:360,moveSpeed:240,scale:1,colliderW:140,colliderH:140,chamferRadius:70},{spawnPos:{x:-168,y:469},image:i.PROTECT.PORCUPINE,rotationSpeed:0,moveSpeed:240,scale:-1,colliderW:100,colliderH:75,chamferRadius:0}],this.enemySpawning={startDelay:1e3,spawnInterval:{min:600,max:1200}},this.enemyTargetPos={x:422,y:146},this.enemyActivationTimer=0,this.nextEnemySpawnTime=0,this.activatedEnemiesCount=0,this.canActivateEnemies=!1,this.enemies=[],this.killedEnemiesCount=0,this.spawnedEnemiesCount=0}_init(){this.ghost=null,this.lady=null,this.enemies=[],this.killedEnemiesCount=0,this.spawnedEnemiesCount=0,this.enemyActivationTimer=0,this.nextEnemySpawnTime=this.enemySpawning.startDelay,this.activatedEnemiesCount=0,this.canActivateEnemies=!1}_preload(){}_create(){this.addBackgroundImage(i.PROTECT.BACKGROUND).setDepth(1),this.add.image(409,240,i.PROTECT.BACKGROUND).setDepth(0),this.add.image(700,55,i.PROTECT.DRAG_TEXT).setScale(.84).setDepth(1).setTint(603194),this.initPhysics(),this.spawnLady(),this.spawnGhost(),this.spawnEnemies()}initPhysics(){this.collisionPlayer=2,this.collisionKiller=4,this.collisionLady=8,this.matter.world.on("collisionstart",function(e,t,i){if(t.label.startsWith("killer")||i.label.startsWith("killer")){var s=t.label.startsWith("killer")?t:i;("player"===t.label||"player"===i.label)&&this.killEnemyWithLabel(s.label),("lady"===t.label||"lady"===i.label)&&(this.deactivateEnemyWithLabel(s.label),this.lady.kill())}},this)}killEnemyWithLabel(e){for(let t of this.enemies)if(t.isLabelEqual(e)){t.kill();return}}deactivateEnemyWithLabel(e){for(let t of this.enemies)if(t.isLabelEqual(e)){t.deactivate();return}}spawnLady(){this.add.image(300,204,i.PROTECT.YARN).setDepth(5);var e=this.matter.add.image(412,161,i.GHOSTBUSTERS.BALL,null,{label:"lady",isStatic:!0}).setScale(1.5,3).setVisible(!1).setCollisionCategory(this.collisionLady);e.bodyAnim=this.addAnimation(i.PROTECT.LADY,i.ANIMATIONS.GRANNYDIE_BODY).setLoop(!1).setImagePosition(0).setDepth(3),e.hand1=this.addAnimation(i.PROTECT.HAND_1,i.ANIMATIONS.GRANNY_HAND1).setImageOrigin(.0355,.889).setDepth(10).setLoop(!0).start(),e.hand2=this.addAnimation(i.PROTECT.HAND_2,i.ANIMATIONS.GRANNY_HAND2).setImageOrigin(.933,.9564).setDepth(10).setLoop(!0).start(),e.kill=()=>{e.bodyAnim.start(),e.hand1.setAnimation(this.cache.json.get(i.ANIMATIONS.GRANNYDIE_HAND1)).setLoop(!1),e.hand2.setAnimation(this.cache.json.get(i.ANIMATIONS.GRANNYDIE_HAND2)).setLoop(!1),this.triggerLose()},this.lady=e}spawnGhost(){var e={anim:this.addAnimation(i.FLY.GHOST,i.ANIMATIONS.GHOST_IDLE).setDepth(10).setImageInteractive().setOffset(-38,-29).setPositionOverride(695,153).setScaleMultiplier(2).setLoop(!0).start(),body:this.matter.add.image(695,153,i.FLY.GHOST,null,{chamfer:{radius:55},label:"player",ignoreGravity:!0,frictionAir:.25,friction:0}).setCollisionCategory(this.collisionPlayer).setCollidesWith([this.collisionKiller]).setScale(.5).setVisible(!1),isDragging:!1,isAlive:!0,onUpdate:t=>{if(e.anim.setPositionOverride(e.body.x,e.body.y),e.body.setAngle(0),e.isAlive&&e.isDragging){var i={x:this.input.activePointer.x-e.anim.GetPositionOverride().x,y:this.input.activePointer.y-e.anim.GetPositionOverride().y};e.body.setVelocity(i.x*this.moveSensitivity,i.y*this.moveSensitivity)}}};e.anim.GetImage().on("pointerdown",function(e){this.canActivateEnemies=!0,this.ghost.isDragging=!0},this),this.input.on("pointerup",function(e){this.ghost.isDragging=!1},this),this.ghost=e}spawnEnemies(){this.enemyConfig.forEach(e=>{this.spawnedEnemiesCount++,this.spawnEnemy(e)}),this.enemies=this.shuffle(this.enemies)}spawnEnemy(e){var t="killer"+this.spawnedEnemiesCount,i=this.matter.add.image(e.spawnPos.x,e.spawnPos.y,e.image,null,{chamfer:{radius:13},label:t,ignoreGravity:!0,frictionAir:0,friction:0}).setScale(e.scale,1).setDepth(15),s=Phaser.Physics.Matter.Matter.Bodies.rectangle(e.spawnPos.x,e.spawnPos.y,e.colliderW,e.colliderH,{label:t,chamfer:{radius:e.chamferRadius}}),a=Phaser.Physics.Matter.Matter.Body.create({parts:[s]});i.label=t,i.setExistingBody(a),i.setIgnoreGravity(!0),i.setFrictionAir(1),i.setCollisionCategory(this.collisionKiller),i.setCollidesWith([this.collisionPlayer,this.collisionLady]),i.isActive=!1,i.wasKilled=!1,i.moveVector=new Phaser.Math.Vector2(-e.spawnPos.x+this.enemyTargetPos.x,-e.spawnPos.y+this.enemyTargetPos.y).normalize().scale(e.moveSpeed),i.onUpdate=t=>{i.setAngle(i.angle+e.rotationSpeed*t/1e3),i.isActive&&i.setPosition(i.x+i.moveVector.x*t/1e3,i.y+i.moveVector.y*t/1e3)},i.activate=()=>{i.isActive=!0},i.kill=()=>{i.wasKilled||(i.setScale(-i.scaleX,i.scaleY),i.moveVector.scale(-1),i.wasKilled=!0,this.handleEnemyKilled())},i.deactivate=()=>{i.isActive=!1},i.isLabelEqual=e=>i.label===e,this.enemies.push(i)}handleEnemyKilled(){this.killedEnemiesCount++,this.killedEnemiesCount>=this.enemyConfig.length&&this.triggerWin()}_update(e,t){this.ghost.onUpdate(t),this.enemies.forEach(e=>{e.onUpdate(t)}),this.activateEnemies(t)}activateEnemies(e){this.canActivateEnemies&&!(this.activatedEnemiesCount>=this.enemyConfig.length)&&(this.enemyActivationTimer+=e,this.enemyActivationTimer>this.nextEnemySpawnTime&&(this.enemies[this.activatedEnemiesCount].activate(),this.enemyActivationTimer=0,this.activatedEnemiesCount++,this.nextEnemySpawnTime=this.getRandomInt(this.enemySpawning.spawnInterval.min,this.enemySpawning.spawnInterval.max)))}shuffle(e){var t,i,s;for(s=e.length-1;s>0;s--)t=Math.floor(Math.random()*(s+1)),i=e[s],e[s]=e[t],e[t]=i;return e}_timeout(){}_afterLoss(){}_afterWin(){}triggerLose(){this.loseGame(1e3)}triggerWin(){this.time.delayedCall(2e3,()=>{this.winAnimDelayed()},null,this),this.winGame(3500)}winAnimDelayed(){this.addAnimation(i.PROTECT.WIN_SCREEN,i.ANIMATIONS.WIN_IMAGE_POPUP).setDepth(300).setLoop(!1).start()}},class extends g{constructor(){super({sceneName:i.SCENES.JUMPSCARE,duration:16e3,showCountdown:!0,startScreenColor:16731623,startText:"PLAY!",startTextColor:3289650,nextScene:i.SCENES.COMEDIAN,endButtons:{normalNoSkip:{x:426.5,y:421,scale:1},normalWithSkip:{x:314.5,y:421,scale:1},skip:{x:538.5,y:421,scale:1}}}),this.barClickMovement=21.33,this.actualLevelTime=8e3,this.gameStarted=!1,this.barYSpeed=133.33,this.onGameStarted=()=>{this.gameplayTimer.timeScale=0}}_init(){this.bar=null,this.jack=null,this.gameStarted=!1,this.barYSpeed=133.33}_preload(){}_create(){this.calculateBarYSpeed(),this.createBackground(),this.createJack(),this.createText(),this.createButton(),this.createBar()}calculateBarYSpeed(){var e=this.registry.get(i.REGISTRY.JUMPSCARE_ATTEMPTS);e||(e=1),this.registry.set(i.REGISTRY.JUMPSCARE_ATTEMPTS,e+1),this.barYSpeed-=35.3*Math.log(e)}createBackground(){this.addBackgroundImage(i.JUMPSCARE.BACKGROUND),this.add.image(184,111,i.JUMPSCARE.WALLPAPER).setDepth(1),this.add.image(581,306,i.JUMPSCARE.TABLE).setDepth(2),this.add.image(347,248,i.JUMPSCARE.CHAIR).setDepth(3)}createJack(){var e={body:this.add.image(367,207,i.JUMPSCARE.JACK).setDepth(4),hands:{first:[this.add.image(386,213,i.JUMPSCARE.ARM_1).setDepth(5),this.add.image(383,188,i.JUMPSCARE.ARM_2).setDepth(3)],second:[this.add.image(386,195,i.JUMPSCARE.ARM_1).setDepth(5).setAngle(-27),this.add.image(383,210,i.JUMPSCARE.ARM_2).setDepth(3).setAngle(22)]},firstHandsVisible:!0,normalFace:this.add.image(356,141,i.JUMPSCARE.NORMAL_EYES).setDepth(6),scaredFace:this.add.image(356,143.5,i.JUMPSCARE.SCARED_EYES).setDepth(6).setVisible(!1),playTV:this.add.image(468,0,i.JUMPSCARE.TV_PLAY).setOrigin(0).setDepth(6),scareTV:this.add.image(468,0,i.JUMPSCARE.TV_SCARE).setOrigin(0).setDepth(6).setVisible(!1),onButtonPress:()=>{e.firstHandsVisible=!e.firstHandsVisible,e.hands.first.forEach(t=>{t.setVisible(e.firstHandsVisible)}),e.hands.second.forEach(t=>{t.setVisible(!e.firstHandsVisible)})},animateScared:()=>{e.normalFace.setVisible(!1),e.scaredFace.setVisible(!0),e.playTV.setVisible(!1),e.scareTV.setVisible(!0),e.hands.first.forEach(e=>{e.setVisible(!1)}),e.hands.second.forEach(e=>{e.setVisible(!1)}),this.addAnimation(i.JUMPSCARE.ARM_1,i.ANIMATIONS.SCARYARM_FRONT).setImageOrigin(.02733,.1334).setDepth(5).setLoop(!0).start(),this.addAnimation(i.JUMPSCARE.ARM_2,i.ANIMATIONS.SCARYARM_BACK).setImageOrigin(.0205,.8977).setDepth(3).setLoop(!0).start()}};e.onButtonPress(),this.jack=e}createText(){this.clickText=this.add.image(155,452,i.JUMPSCARE.CLICK_TEXT).setDepth(2),this.fastText=this.add.image(157,457,i.JUMPSCARE.FAST_TEXT).setDepth(2).setVisible(!1)}createButton(){this.button=this.add.image(157,336,i.JUMPSCARE.BUTTON).setInteractive(this.input.makePixelPerfect()).setDepth(5).setAlpha(1),this.buttonPressed=this.add.image(157,344,i.JUMPSCARE.BUTTON_PRESSED).setDepth(5).setAlpha(0),this.button.on("pointerdown",function(e,t){this.isCurrentState(i.GAMESTATE.PLAYING)&&(this.customStartGame(),this.button.setAlpha(0),this.buttonPressed.setAlpha(1),this.jack.onButtonPress(),this.bar.onButtonPress(),this.sound.play(i.AUDIO.CLICK,{detune:this.getDetune()}))},this),this.input.on("pointerup",function(e,t,s){this.isCurrentState(i.GAMESTATE.PLAYING)&&(this.button.setAlpha(1),this.buttonPressed.setAlpha(0),this.sound.play(i.AUDIO.CLICK,{detune:this.getDetune()}))},this)}createBar(){var e={background:this.add.image(40,327,i.JUMPSCARE.BAR).setDepth(6),clicker:this.add.image(41,439,i.JUMPSCARE.BAR_LINE).setDepth(8),limits:{bottom:438,top:212},onUpdate:t=>{!this.isCurrentState(i.GAMESTATE.WIN)&&(e.clicker.y+=this.barYSpeed*t/1e3,e.clicker.y>e.limits.bottom&&(e.clicker.y=e.limits.bottom))},onButtonPress:()=>{e.clicker.y-=this.barClickMovement,e.clicker.y<e.limits.top&&(e.clicker.y=e.limits.top,this.triggerWin())}};this.bar=e}_update(e,t){this.bar.onUpdate(t)}customStartGame(){this.gameStarted||(this.gameStarted=!0,this.gameplayTimer.timeScale=1,this.time.delayedCall(this.actualLevelTime,()=>{this._timeout()},null,this),this.time.delayedCall(this.actualLevelTime-5e3,()=>{this.switchText()},null,this))}switchText(){this.clickText.setVisible(!1),this.fastText.setVisible(!0)}_timeout(){this.triggerLose()}_afterLoss(){}_afterWin(){}triggerLose(){this.isCurrentState(i.GAMESTATE.PLAYING)&&(this.sound.play(i.AUDIO.SCARE2,{volume:.5}),this.add.image(0,0,i.JUMPSCARE.SCARE_SCREEN).setOrigin(0).setDepth(200),this.cameras.main.shake(1e3,.03),this.loseGame(1e3))}triggerWin(){this.sound.play(i.AUDIO.SCARE1,{volume:.35}),this.winGame(2e3),this.jack.animateScared()}},class extends g{constructor(){super({sceneName:i.SCENES.COMEDIAN,duration:1e3,showCountdown:!1,startScreenColor:16733800,startText:"MAKE THEM\nLAUGH!",startTextYOrigin:.35,startTextColor:3289650,endScreen:i.COMEDIAN.END,nextScene:i.SCENES.PARTY,endButtons:{normalNoSkip:{x:650,y:282,scale:1.3},normalWithSkip:{x:650,y:282,scale:1.3},skip:{x:650,y:384,scale:1.3}}}),this.winGhosts=[{x:497,y:446,depth:501,image:i.COMEDIAN.GHOST_1},{x:388,y:431,depth:501,image:i.COMEDIAN.GHOST_2},{x:272,y:430,depth:501,image:i.COMEDIAN.GHOST_3},{x:609,y:447,depth:501,image:i.COMEDIAN.GHOST_4},{x:727,y:458,depth:501,image:i.COMEDIAN.GHOST_5},{x:812,y:462,depth:501,image:i.COMEDIAN.GHOST_6},{x:160,y:433,depth:501,image:i.COMEDIAN.GHOST_7},{x:45,y:457,depth:501,image:i.COMEDIAN.GHOST_8}],this.ghostMoveDistance=16,this.jokeConfigs=[{question:{x:617,y:57,image:i.COMEDIAN.JOKE_1_QUESTION},answers:[{x:529,y:152,scale:.81,angle:0,depth:100,correctAnswer:!1,image:i.COMEDIAN.JOKE_1_ANSWER_1},{x:726,y:161,scale:1,angle:16,depth:100,correctAnswer:!0,image:i.COMEDIAN.JOKE_1_ANSWER_2},{x:714,y:255,scale:.92,angle:-2.8,depth:100,correctAnswer:!1,image:i.COMEDIAN.JOKE_1_ANSWER_3}]},{question:{x:617,y:72,image:i.COMEDIAN.JOKE_2_QUESTION},answers:[{x:511,y:166,scale:.76,angle:10,depth:100,correctAnswer:!0,image:i.COMEDIAN.JOKE_2_ANSWER_1},{x:730,y:186,scale:.83,angle:5,depth:100,correctAnswer:!1,image:i.COMEDIAN.JOKE_2_ANSWER_2},{x:717,y:288,scale:.67,angle:-10,depth:100,correctAnswer:!1,image:i.COMEDIAN.JOKE_2_ANSWER_3}]},{question:{x:617,y:80,image:i.COMEDIAN.JOKE_3_QUESTION},answers:[{x:496,y:174,scale:.66,angle:-18,depth:100,correctAnswer:!1,image:i.COMEDIAN.JOKE_3_ANSWER_2},{x:710,y:203,scale:.81,angle:3.3,depth:100,correctAnswer:!0,image:i.COMEDIAN.JOKE_3_ANSWER_1},{x:718,y:273,scale:.67,angle:9,depth:100,correctAnswer:!1,image:i.COMEDIAN.JOKE_3_ANSWER_3}]},{question:{x:621,y:63,image:i.COMEDIAN.JOKE_4_QUESTION},answers:[{x:515,y:157,scale:.87,angle:-6.5,depth:100,correctAnswer:!1,image:i.COMEDIAN.JOKE_4_ANSWER_2},{x:743,y:160,scale:.8,angle:13.3,depth:100,correctAnswer:!1,image:i.COMEDIAN.JOKE_4_ANSWER_3},{x:727,y:258,scale:.76,angle:-10,depth:100,correctAnswer:!0,image:i.COMEDIAN.JOKE_4_ANSWER_1}]},{question:{x:630,y:73,image:i.COMEDIAN.JOKE_5_QUESTION},answers:[{x:527,y:167,scale:.91,angle:-1.5,depth:100,correctAnswer:!1,image:i.COMEDIAN.JOKE_5_ANSWER_2},{x:730,y:200,scale:.87,angle:26,depth:100,correctAnswer:!0,image:i.COMEDIAN.JOKE_5_ANSWER_1},{x:727,y:279,scale:.9,angle:4.5,depth:100,correctAnswer:!1,image:i.COMEDIAN.JOKE_5_ANSWER_3}]}],this.jokeSpawnDelay=500,this.currentJokeIndex=0}_init(){this.activeJoke=null,this.currentJokeIndex=0}_preload(){}_create(){this.createBackground(),this.initJokes()}createBackground(){this.addBackgroundImage(i.COMEDIAN.BACKGROUND),this.add.image(226,177,i.COMEDIAN.MIC).setDepth(10);var e=this.add.image(180,125,i.FLY.GHOST).setDepth(5).setAngle(-6).setScale(.7);this.tweens.add({targets:e,y:"-=4",ease:"Quad.easeInOut",duration:375,repeat:-1,yoyo:!0})}initJokes(){this.currentJokeIndex=0,this.spawnJoke(this.currentJokeIndex)}spawnJoke(e){var t=this.jokeConfigs[e],i=this.add.image(t.question.x,t.question.y,t.question.image).setDepth(100);i.answers=[],t.answers.forEach(e=>{var t=this.add.image(e.x,e.y,e.image).setScale(e.scale).setAngle(e.angle).setDepth(e.depth).setInteractive(this.input.makePixelPerfect());t.isCorrect=e.correctAnswer,t.hoverStart=null,t.hoverEnd=null,t.isInteractable=!0,t.on("pointerover",function(){t.isInteractable&&(null!=t.hoverEnd&&t.hoverEnd.stop(),t.hoverStart=this.tweens.add({targets:t,scaleX:1.2*e.scale,scaleY:1.2*e.scale,ease:"Sine.easeOut",duration:83,repeat:0,yoyo:!1}))},this),t.on("pointerout",function(){t.isInteractable&&(null!=t.hoverStart&&t.hoverStart.stop(),t.hoverEnd=this.tweens.add({targets:t,scaleX:e.scale,scaleY:e.scale,ease:"Sine.easeOut",duration:83,repeat:0,yoyo:!1}))},this),t.on("pointerup",function(){t.isInteractable&&(null!=t.hoverStart&&t.hoverStart.stop(),null!=t.hoverEnd&&t.hoverEnd.stop(),this.tweens.timeline({targets:t,ease:"Cubic.easeInOut",duration:500,loop:0,tweens:[{targets:t,scaleX:1.4*e.scale,scaleY:1.4*e.scale,duration:150,repeat:0,yoyo:!1},{targets:t,scaleX:0,scaleY:0,duration:350,repeat:0,yoyo:!1}]}),this.handleAnswerSelected(t.isCorrect))},this),i.answers.push(t)},this),i.endAnimation=()=>{this.tweens.add({targets:i,scaleX:0,scaleY:0,ease:"Cubic.easeInOut",duration:500,repeat:0,yoyo:!1});for(var e=0;e<i.answers.length;e++)i.answers[e].isInteractable=!1,i.answers[e].isCorrect||this.tweens.add({targets:i.answers[e],scaleX:0,scaleY:0,ease:"Cubic.easeInOut",duration:500,repeat:0,yoyo:!1})},this.activeJoke=i}handleAnswerSelected(e){e?(this.activeJoke.endAnimation(),this.currentJokeIndex<this.jokeConfigs.length-1?(this.currentJokeIndex++,this.time.delayedCall(this.jokeSpawnDelay,()=>{this.spawnJoke(this.currentJokeIndex)},null,this),this.playWinAudio()):this.time.delayedCall(this.jokeSpawnDelay,()=>{this.triggerWin()},null,this)):this.triggerLose()}_update(e,t){}_timeout(){}_afterLoss(){}_afterWin(){}triggerLose(){this.add.image(0,0,i.COMEDIAN.LOSEIMAGE).setDepth(500).setOrigin(0),this.loseGame(2e3)}triggerWin(){this.showWin(),this.winGame(2500)}showWin(){this.add.image(0,0,i.COMEDIAN.WIN_BACKGROUND).setDepth(500).setOrigin(0),this.addAnimation(i.COMEDIAN.HANDS_1,i.ANIMATIONS.COMEDIAN_HAND_1,30).setDepth(510).setLoop(!0).setImageOrigin(.898,.592).start(),this.addAnimation(i.COMEDIAN.HANDS_2,i.ANIMATIONS.COMEDIAN_HAND_2,30).setDepth(510).setLoop(!0).setImageOrigin(.033,.753).start(),this.winGhosts.forEach(e=>{var t=this.add.image(e.x,e.y,e.image).setDepth(e.depth),i=this.getRandomInt(-this.ghostMoveDistance,this.ghostMoveDistance);t.x-=i,this.tweens.add({targets:t,x:t.x+2*i,ease:"Linear",duration:this.getRandomInt(100,200),repeat:-1,yoyo:!0,progress:Math.random()})})}},class extends g{constructor(){super({sceneName:i.SCENES.PARTY,duration:21200,timeToStart:1500,showCountdown:!1,startScreenColor:16750848,startText:"PARTY!",startTextColor:3289650,endScreen:i.PARTY.END,nextScene:i.SCENES.DRESSUP,endButtons:{normalNoSkip:{x:664,y:300,scale:1.2},normalWithSkip:{x:664,y:300,scale:1.2},skip:{x:398,y:300,scale:1.2}}}),this.noteInfo={pink:{color:"pink",spawnX:712,spawnY:-141,targetX:528,targetY:391,moveSpeed:240,deathY:480,image:i.PARTY.DOT_PINK},blue:{color:"blue",spawnX:797,spawnY:-141,targetX:614,targetY:391,moveSpeed:240,deathY:480,image:i.PARTY.DOT_BLUE},green:{color:"green",spawnX:881,spawnY:-141,targetX:698,targetY:391,moveSpeed:240,deathY:480,image:i.PARTY.DOT_GREEN}},this.buttonInfo=[{color:"pink",x:510,y:437,clickRadius:44,clickYRange:100,image:i.PARTY.END_PINK},{color:"blue",x:598,y:437,clickRadius:44,clickYRange:100,image:i.PARTY.END_BLUE},{color:"green",x:686,y:437,clickRadius:44,clickYRange:100,image:i.PARTY.END_GREEN}],this.ghostConfig=[{x:118,y:356,depth:25,image:i.PARTY.GHOST_1_BODY},{x:370,y:382,depth:25,image:i.PARTY.GHOST_2_BODY},{x:256,y:258,depth:12,image:i.PARTY.GHOST_3_BODY},{x:452,y:183,depth:25,image:i.PARTY.GHOST_4_BODY}],this.allowedMisses=3,this.currentNoteSpawn=0,this.currentFFTFrame=0,this.timer=0,this.timerOffset=2.6,this.allNotesSpawned=!1,this.skippedNotes=0,this.notes=[],this.buttons=[],this.endMusicTimer=0,this.isEndMusicFading=!1,this.scalableObjects=[],this.isMinigameReady=!1,this.onCommercialEnded=()=>{this.isMinigameReady=!0,this.createAfterCommercial()}}_init(){this.currentNoteSpawn=0,this.currentFFTFrame=0,this.endMusicTimer=0,this.timer=this.timerOffset,this.nextNoteSpawn=null,this.allNotesSpawned=!1,this.skippedNotes=0,this.notes=[],this.buttons=[],this.isEndMusicFading=!1,this.scalableObjects=[],this.isMinigameReady=!1}_preload(){}_create(){}createAfterCommercial(){this.getMusicInfo(),this.createStaticImages(),this.spawnButtons(),this.createDynamicImages(),this.spawnGhosts(),this.createLights()}getMusicInfo(){this.notesJson=this.cache.json.get(i.JSONPARTY.MUSIC),this.nextNoteSpawn=this.notesJson[0],this.fftJson=this.cache.json.get(i.JSONPARTY.FFT),this.music&&this.music.stop(),this.music=this.sound.add(i.AUDIO.PARTY_MUSIC),this.music.play(),this.fadeSoundtrack(0,100)}createStaticImages(){this.addBackgroundImage(i.PARTY.BACKGROUND_BACK),this.add.image(0,0,i.PARTY.BACKGROUND_FRONT).setOrigin(0).setDepth(10),this.add.image(620,124,i.PARTY.LINE_PINK).setDepth(11),this.add.image(706,126,i.PARTY.LINE_BLUE).setDepth(11),this.add.image(791,124,i.PARTY.LINE_GREEN).setDepth(11),this.add.image(327,325,i.PARTY.GRAVE).setDepth(20),this.add.image(318,205,i.PARTY.MARTINI).setDepth(20)}spawnButtons(){this.buttonInfo.forEach(e=>{var t=this.add.image(e.x,e.y,e.image).setDepth(11).setInteractive(this.input.makePixelPerfect());t.config=e,t.handleClicked=()=>{var e=null;for(let i of this.notes)i.isAlive&&t.config.color===i.config.color&&Phaser.Math.Distance.Between(t.x,t.y,i.GetPositionOverride().x,i.GetPositionOverride().y)<t.config.clickYRange&&(null===e||i.GetPositionOverride().y>e.GetPositionOverride().y)&&(e=i);null!==e&&e.handleClicked()},t.on("pointerover",function(){null!=t.hoverEnd&&t.hoverEnd.stop(),t.hoverStart=this.tweens.add({targets:t,scaleX:1.2,scaleY:1.2,ease:"Sine.easeOut",duration:83,repeat:0,yoyo:!1})},this),t.on("pointerout",function(){null!=t.hoverStart&&t.hoverStart.stop(),t.hoverEnd=this.tweens.add({targets:t,scaleX:1,scaleY:1,ease:"Sine.easeOut",duration:83,repeat:0,yoyo:!1})},this),this.buttons.push(t)}),this.input.on("pointerdown",function(e){this.buttons.forEach(t=>{Phaser.Math.Distance.Between(t.x,t.y,e.x,e.y)<t.config.clickRadius&&t.handleClicked()})},this)}createDynamicImages(){this.scalableObjects.push(this.startTextObject),this.scalableObjects.push(this.add.image(159,254,i.PARTY.LUNA).setDepth(1)),this.scalableObjects.push(this.add.image(107,97,i.PARTY.BATS).setDepth(12))}spawnGhosts(){this.ghostConfig.forEach(e=>{this.scalableObjects.push(this.add.image(e.x,e.y,e.image).setDepth(e.depth))})}createLights(){this.addAnimation(i.PARTY.LIGHT_BLUE,i.ANIMATIONS.BLUE_LIGHT,30).setImageOrigin(.045,.912).setDepth(5).setLoop(!0).start(),this.addAnimation(i.PARTY.LIGHT_GREEN,i.ANIMATIONS.GREEN_LIGHT,30).setImageOrigin(.854,.917).setDepth(5).setLoop(!0).start(),this.addAnimation(i.PARTY.LIGHT_PINK,i.ANIMATIONS.PINK_LIGHT,30).setImageOrigin(.1267,.953).setDepth(5).setLoop(!0).start()}_update(e,t){this.isMinigameReady&&(this.spawnMusic(t),this.notes.forEach(e=>{e.onUpdate(t)}),this.fadeEndMusic(t),this.updateFFTScales())}spawnMusic(e){if(!this.allNotesSpawned&&(this.timer+=e/1e3,this.timer>this.nextNoteSpawn.t&&(this.spawnNote(this.notesJson[this.currentNoteSpawn]),this.currentNoteSpawn++,this.nextNoteSpawn=this.notesJson[this.currentNoteSpawn],this.currentNoteSpawn>=this.notesJson.length))){this.allNotesSpawned=!0;return}}spawnNote(e){var t="p"===e.c?this.noteInfo.pink:"b"===e.c?this.noteInfo.blue:this.noteInfo.green,e=this.addAnimation(t.image,i.ANIMATIONS.NOTE_DEATH).setDepth(30).setOffset(-599,-177).setPositionOverride(t.spawnX,t.spawnY).setImagePosition(0).setAnimFinishCallback(()=>{e.image.setVisible(!1)}).setLoop(!1);e.config=t,e.moveVector=new Phaser.Math.Vector2(t.targetX-t.spawnX,t.targetY-t.spawnY).normalize(),e.isAlive=!0,e.onUpdate=t=>{e.setPositionOverride(e.GetPositionOverride().x+e.moveVector.x*e.config.moveSpeed*t/1e3,e.GetPositionOverride().y+e.moveVector.y*e.config.moveSpeed*t/1e3),e.checkPosition(),e.IsAnimating()||e.setImagePosition(e.isAlive?0:1e3)},e.checkPosition=()=>{e.isAlive&&e.GetPositionOverride().y>e.config.deathY&&(this.skippedNotes<this.allowedMisses?(s.Debug("Missed a note!"),this.skippedNotes++,e.handleClicked()):this.triggerLose())},e.handleClicked=()=>{e.isAlive&&(e.isAlive=!1,e.start())},this.notes.push(e)}fadeEndMusic(e){if(this.isEndMusicFading){if(this.endMusicTimer+=e,this.endMusicTimer>1e3){this.music.setVolume(0),this.music.stop(),s.Debug("Party music stopped!"),this.isEndMusicFading=!1;return}this.music.setVolume(Phaser.Math.Linear(1,0,this.endMusicTimer/1e3))}}updateFFTScales(){let e=this.GetCurrentFFTFrame();e!=this.currentFFTFrame&&(this.setFFTScales(e),this.currentFFTFrame=e)}GetCurrentFFTFrame(){for(var e=this.currentFFTFrame;e<this.fftJson.length;e++)if(this.fftJson[e].t>this.music.seek)return e;return this.fftJson.length-1}setFFTScales(e){let t=this.fftJson[e].s;this.scalableObjects.forEach(e=>{e.setScale(t)}),this.notes.forEach(e=>{e.isAlive&&e.setScaleMultiplier(t)})}_timeout(){this.triggerWin()}_afterLoss(){}_afterWin(){}triggerLose(){this.isCurrentState(i.GAMESTATE.PLAYING)&&(s.Debug("Lose Party minigame"),this.fadeSoundtrack(1,1e3),this.isEndMusicFading=!0,this.loseGame(0))}triggerWin(){s.Debug("Win Party minigame"),this.isEndMusicFading=!0,this.fadeSoundtrack(1,1e3),this.addAnimation(i.PARTY.WIN_SCREEN,i.ANIMATIONS.WIN_IMAGE_POPUP).setDepth(300).setLoop(!1).start(),this.winGame(1500)}},class extends g{constructor(){super({sceneName:i.SCENES.DRESSUP,duration:2e4,showCountdown:!1,startScreenColor:4954111,startText:"DRESS\nUP!",startTextColor:3289650,startTextYOrigin:.35,endScreen:i.DRESSUP.END,nextScene:i.SCENES.COLLECT,endButtons:{skipEnabled:!1,rotation:-10,normalNoSkip:{x:565,y:327,scale:1.3},normalWithSkip:{x:283,y:386,scale:1.3},skip:{x:570,y:386,scale:1.3}}}),this.clothesConfigs=[{imageName:i.DRESSUP.BOY_1,startPos:{x:482,y:56},dressedPos:{x:295,y:177},type:0,costumeSet:0,scale:1.02,depth:21},{imageName:i.DRESSUP.BOY_2,startPos:{x:519,y:165},dressedPos:{x:295,y:258},type:1,costumeSet:0,scale:1.02,depth:21},{imageName:i.DRESSUP.BOY_3,startPos:{x:726,y:174},dressedPos:{x:282,y:312},type:2,costumeSet:0,scale:1.02,depth:21},{imageName:i.DRESSUP.DPOOL_1,startPos:{x:586,y:66},dressedPos:{x:297.5,y:184.5},type:0,costumeSet:2,scale:1.02,depth:22},{imageName:i.DRESSUP.DPOOL_2,startPos:{x:516,y:218},dressedPos:{x:296,y:257.5},type:1,costumeSet:2,scale:1.02,depth:22},{imageName:i.DRESSUP.DPOOL_3,startPos:{x:725,y:216},dressedPos:{x:283,y:313},type:2,costumeSet:2,scale:1.02,depth:22},{imageName:i.DRESSUP.DINO_1,startPos:{x:671,y:54},dressedPos:{x:282.5,y:169.5},type:0,costumeSet:1,scale:1.02,depth:23},{imageName:i.DRESSUP.DINO_2,startPos:{x:506,y:267},dressedPos:{x:281,y:259},type:1,costumeSet:1,scale:1.02,depth:23},{imageName:i.DRESSUP.DINO_3,startPos:{x:720,y:265},dressedPos:{x:279,y:313},type:2,costumeSet:1,scale:1.02,depth:23},{imageName:i.DRESSUP.WITCH_1,startPos:{x:755,y:62},dressedPos:{x:294,y:119},type:0,costumeSet:3,scale:1.02,depth:24},{imageName:i.DRESSUP.WITCH_2,startPos:{x:519,y:317},dressedPos:{x:295,y:258},type:1,costumeSet:3,scale:1.02,depth:24},{imageName:i.DRESSUP.WITCH_3,startPos:{x:722,y:313},dressedPos:{x:282,y:311},type:2,costumeSet:3,scale:1.02,depth:24}],this.dressedPositions=[{type:0,x:300,y:187},{type:1,x:299,y:262},{type:2,x:295,y:320}],this.maxDropDistance=80,this.clothes=[]}_init(){this.clothes=[],this.dressedClothes=Array.apply(null,[,,,]).map(function(){})}_preload(){}_create(){this.addBackgroundImage(i.DRESSUP.BACKGROUND),this.add.image(283,234,i.DRESSUP.GHOST).setDepth(1),this.createFinishButton(),this.createClothes()}createFinishButton(){this.add.image(625,431,i.DRESSUP.FABULOUS_BUTTON).setDepth(50).setInteractive({useHandCursor:!0}).on("pointerup",()=>{this.checkForWin()})}checkForWin(){for(var e=-1,t=!0,i=0;i<this.dressedClothes.length;i++)if(null==this.dressedClothes[i]||(-1===e&&(e=this.dressedClothes[i].config.costumeSet),this.dressedClothes[i].config.costumeSet!==e)){t=!1;break}t?this.triggerWin(e):this.triggerLose()}createClothes(){this.clothesConfigs.forEach(e=>{let t=this.add.image(e.startPos.x,e.startPos.y,e.imageName).setInteractive({useHandCursor:!0}).setScale(e.scale,e.scale).setDepth(e.depth);t.config=e,t.isDressed=!1,t.setDressed=e=>{t.isDressed=e,t.isDressed?(this.smoothMoveObject(t,t.config.dressedPos.x,t.config.dressedPos.y,200),t.setDepth(9+t.config.type)):(this.smoothMoveObject(t,t.config.startPos.x,t.config.startPos.y,400),t.setDepth(t.config.depth))},t.dress=()=>{t.setDressed(!0),this.dressedClothes[t.config.type]&&this.dressedClothes[t.config.type].setDressed(!1),this.dressedClothes[t.config.type]=t},this.input.setDraggable(t)}),this.input.on("dragstart",function(e,t){this.isCurrentState(i.GAMESTATE.PLAYING)&&(t.isDressed||this.sound.play(i.AUDIO.GRAB,{detune:this.getDetune()}))},this),this.input.on("drag",function(e,t,i,s){t.isDressed||(t.x=i,t.y=s)}),this.input.on("dragend",function(e,t,s){this.isCurrentState(i.GAMESTATE.PLAYING)&&(t.isDressed||(this.canDress(t)?(t.dress(),this.sound.play(i.AUDIO.BOUNCE,{detune:this.getDetune()})):(t.setDressed(!1),this.sound.play(i.AUDIO.GRAB,{detune:this.getDetune()}))))},this)}canDress(e){for(let t of this.dressedPositions)if(t.type==e.config.type)return Phaser.Math.Distance.Between(t.x,t.y,e.x,e.y)<=this.maxDropDistance;return!1}_update(e,t){}_timeout(){}_afterLoss(){}_afterWin(){}triggerLose(){this.loseGame()}triggerWin(e){this.storagePlugin.setItem(i.STORAGE_KEYS.DRESSUP_COSTUME,e),this.winGame()}},class extends g{constructor(){super({sceneName:i.SCENES.COLLECT,duration:36e3,showCountdown:!0,startScreenColor:5433142,startText:"COLLECT!",startTextColor:3289650,endScreen:i.COLLECT.END,nextScene:i.SCENES.SORT,endButtons:{normalNoSkip:{x:426.5,y:386,scale:1.3},normalWithSkip:{x:283,y:386,scale:1.3},skip:{x:570,y:386,scale:1.3}}}),this.worldColliders=[{x:66.5,y:74.5,width:75,height:85},{x:132,y:34.5,width:44,height:27},{x:252,y:46,width:154,height:50},{x:387.5,y:68.5,width:85,height:123},{x:295.5,y:142,width:311,height:16},{x:444,y:69,width:16,height:132},{x:502.5,y:57.5,width:57,height:45},{x:136.5,y:100.5,width:61,height:-17},{x:158.5,y:120,width:29,height:-22},{x:127,y:415,width:116,height:102},{x:94,y:344.5,width:40,height:25},{x:268,y:296,width:88,height:120},{x:232.5,y:433,width:77,height:66},{x:356,y:348.5,width:46,height:259},{x:214.5,y:381.5,width:59,height:21},{x:729,y:242.5,width:176,height:197},{x:450.5,y:174.5,width:29,height:37},{x:497,y:368.5,width:42,height:65},{x:540.5,y:363,width:39,height:40},{x:587,y:353.5,width:50,height:43}],this.costumes=[{costumeSet:0,image:i.COLLECT.PLAYER_0},{costumeSet:1,image:i.COLLECT.PLAYER_1},{costumeSet:2,image:i.COLLECT.PLAYER_2},{costumeSet:3,image:i.COLLECT.PLAYER_3}],this.candies=[{image:i.COLLECT.CANDY_5,spawnPosition:new Phaser.Math.Vector2(746,418),scaleOverride:.3,angleOverride:33},{image:i.COLLECT.CANDY_4,spawnPosition:new Phaser.Math.Vector2(76,153),scaleOverride:.457,angleOverride:0},{image:i.COLLECT.CANDY_2,spawnPosition:new Phaser.Math.Vector2(743,73),scaleOverride:.69,angleOverride:-44},{image:i.COLLECT.CANDY_1,spawnPosition:new Phaser.Math.Vector2(136,295),scaleOverride:.597,angleOverride:33},{image:i.COLLECT.CANDY_3,spawnPosition:new Phaser.Math.Vector2(580,253),scaleOverride:.34,angleOverride:0}],this.playerSpawnPosition={x:51,y:183},this.moveForce=.03,this.candyCollectDistance=75,this.currentCandy=-1}_init(){this.player=null,this.currentCandy=-1,this.candyObject=null}_preload(){}_create(){this.addBackgroundImage(i.COLLECT.BACKGROUND),this.initPhysics(),this.spawnPlayer(),this.spawnNextCandy()}initPhysics(){this.matter.world.setBounds(0,0,this.game.renderer.width,this.game.renderer.height),this.worldColliders.forEach(e=>{this.matter.add.rectangle(e.x,e.y,e.width,e.height,{isStatic:!0})})}spawnPlayer(){var e=this.matter.add.image(this.playerSpawnPosition.x,this.playerSpawnPosition.y,this.costumes[0].image,null,{chamfer:{radius:55},ignoreGravity:!0,frictionAir:0,friction:0}).setDepth(10).setScale(.375);e.setTexture(this.getCostumeImageKey()),e.isTouching=!1,e.update=t=>{var i=this.input.activePointer.position,s=new Phaser.Math.Vector2(i.x-e.x,i.y-e.y);e.rotateToPointer(s),e.move(t,s)},e.rotateToPointer=t=>{e.setRotation(t.angle()+ +Math.PI/2)},e.move=(t,i)=>{e.isTouching&&e.applyForce(i.normalize().scale(t/1e3*this.moveForce))},this.player=e,this.input.on("pointerdown",function(e){this.player.isTouching=!0},this),this.input.on("pointerup",function(e){this.player.isTouching=!1},this)}getCostumeImageKey(){var e=this.storagePlugin.getItem(i.STORAGE_KEYS.DRESSUP_COSTUME);return e||(e=0),this.costumes.find(t=>t.costumeSet==e).image}spawnNextCandy(){if(this.currentCandy++,this.currentCandy>=this.candies.length){this.triggerWin();return}var e=this.candies[this.currentCandy],t=this.addAnimation(e.image,i.ANIMATIONS.CANDY_DIE,60).setOffset(-76,-153).setPositionOverride(e.spawnPosition.x,e.spawnPosition.y).setScaleMultiplier(e.scaleOverride).setAngleOffset(e.angleOverride).setDepth(90).setLoop(!1).setPlaybackSpeed(-1).setAnimFinishCallback(()=>{t.setAnimation(this.cache.json.get(i.ANIMATIONS.CANDY_IDLE)).setLoop(!0).setPlaybackSpeed(1).start()}).start();t.isActive=!0,t.onUpdate=e=>{t.isActive&&t.checkDistanceToPlayer()},t.checkDistanceToPlayer=()=>{Phaser.Math.Distance.Between(t.image.x,t.image.y,this.player.x,this.player.y)<=this.candyCollectDistance&&(t.isActive=!1,t.setAnimation(this.cache.json.get(i.ANIMATIONS.CANDY_DIE)).setPlaybackSpeed(1).setLoop(!1).setAnimFinishCallback(()=>{t.image.setVisible(!1)}),this.spawnNextCandy(),this.sound.play(i.AUDIO.WINK,{detune:this.getDetune(),volume:10}))},this.candyObject=t}_update(e,t){this.player.update(t),this.candyObject.onUpdate(t)}_timeout(){this.triggerLose()}_afterLoss(){}_afterWin(){}triggerLose(){this.loseGame()}triggerWin(){this.winGame(1500)}},class extends g{constructor(){super({sceneName:i.SCENES.SORT,duration:14e3,showCountdown:!0,startScreenColor:16748688,startText:"SORT!",startTextColor:3289650,endScreen:i.SORT.END,nextScene:i.SCENES.GHOSTBUSTERS,endButtons:{normalNoSkip:{x:688,y:293,scale:1.25},normalWithSkip:{x:688,y:293,scale:1.25},skip:{x:688,y:395,scale:1.25}}}),this.itemConfig=[{image:i.SORT.CANDY_1,startX:525,startY:68,startAngle:0,isTrash:!1,trash:{x:538,y:246,scale:.83,angle:-93,depth:10},pumpkin:{x:212,y:222,scale:1,angle:28,depth:10}},{image:i.SORT.CANDY_2,startX:99,startY:107,startAngle:0,isTrash:!1,trash:{x:669,y:207,scale:.91,angle:29,depth:10},pumpkin:{x:181,y:293,scale:.85,angle:-118,depth:10}},{image:i.SORT.CANDY_3,startX:750,startY:71,startAngle:-44.2,isTrash:!1,trash:{x:591,y:289,scale:1,angle:-110,depth:10},pumpkin:{x:338,y:269,scale:1,angle:-103,depth:10}},{image:i.SORT.CANDY_4,startX:796,startY:241,startAngle:1,isTrash:!1,trash:{x:658,y:255,scale:1,angle:-153,depth:10},pumpkin:{x:257.5,y:266.6,scale:1,angle:-164,depth:10}},{image:i.SORT.CANDY_5,startX:438,startY:161,startAngle:0,isTrash:!1,trash:{x:582,y:200,scale:.91,angle:-12,depth:10},pumpkin:{x:286,y:215,scale:.92,angle:7,depth:10}},{image:i.SORT.RAZOR,startX:59,startY:238,startAngle:0,isTrash:!0,trash:{x:560,y:216,scale:1,angle:-44,depth:10},pumpkin:{x:224,y:294,scale:.76,angle:174,depth:10}},{image:i.SORT.MEAT,startX:84,startY:350,startAngle:16,isTrash:!0,trash:{x:580,y:273,scale:.76,angle:-43,depth:10},pumpkin:{x:202,y:250,scale:.81,angle:9,depth:10}},{image:i.SORT.TOOTHBRUSH,startX:327,startY:73,startAngle:-26,isTrash:!0,trash:{x:706,y:269,scale:1,angle:46,depth:10},pumpkin:{x:258,y:246,scale:1,angle:-5,depth:10}},{image:i.SORT.BROCCOLI,startX:780,startY:341,startAngle:0,isTrash:!0,trash:{x:660,y:263,scale:1,angle:47,depth:10},pumpkin:{x:321,y:265,scale:1,angle:-87,depth:10}}],this.basketPosition={x:260,y:250},this.trashPosition={x:615,y:253},this.maxCupDistance=110,this.dragDepth=101,this.idleDepth=50,this.items=[],this.itemDepth=10,this.sortedItemsCount=0}_init(){this.items=[],this.itemDepth=10,this.sortedItemsCount=0}_preload(){}_create(){this.addBackgroundImage(i.SORT.BACKGROUND),this.add.image(426.5,431,i.SORT.SORT_TEXT).setDepth(1),this.spawnGhost(),this.addBins(),this.spawnItems()}spawnGhost(){this.ghost=this.add.image(731,485,i.SORT.GHOST).setDepth(200).setScale(.93)}addBins(){this.add.image(this.basketPosition.x,this.basketPosition.y,i.SORT.PUMPKIN_BACK).setDepth(1),this.add.image(this.basketPosition.x,this.basketPosition.y+50,i.SORT.PUMPKIN_FRONT).setDepth(100),this.add.image(this.trashPosition.x,this.trashPosition.y,i.SORT.TRASH_BACK).setDepth(1),this.add.image(this.trashPosition.x,this.trashPosition.y,i.SORT.TRASH_FRONT).setDepth(100)}spawnItems(){this.itemConfig.forEach(e=>{var t=this.add.image(e.startX,e.startY,e.image).setDepth(50).setAngle(e.startAngle).setInteractive(this.input.makePixelPerfect());this.input.setDraggable(t),this.items.push({key:e.image,image:t,isTrash:e.isTrash,config:e,sortedCorrectly:!1,putInCup:(e,t,s)=>{this.input.disable(e.image),s||e.key!==i.SORT.RAZOR||e.image.setTint(13290186);var a=s?e.config.pumpkin:e.config.trash;this.tweens.add({targets:e.image,x:a.x,y:a.y,scaleX:a.scale,scaleY:a.scale,angle:a.angle,ease:"Cubic",duration:200,repeat:0,yoyo:!1,onComplete:()=>{e.image.setDepth(a.depth)}})}})}),this.input.on("dragstart",function(e,t){this.isCurrentState(i.GAMESTATE.PLAYING)&&(t.setDepth(this.dragDepth),this.sound.play(i.AUDIO.GRAB,{detune:this.getDetune()}))},this),this.input.on("drag",function(e,t,i,s){t.x=i,t.y=s}),this.input.on("dragend",function(e,t,s){this.isCurrentState(i.GAMESTATE.PLAYING)&&(t.setDepth(this.idleDepth),this.PutInCup(t),this.sound.play(i.AUDIO.GRAB,{detune:this.getDetune()}))},this)}PutInCup(e){var t=this.isItemInCup(!0,e),i=this.isItemInCup(!1,e);(t||i)&&this.items.forEach(s=>{if(s.key===e.texture.key){this.itemDepth++,this.sortedItemsCount++,s.sortedCorrectly=s.isTrash===i,s.putInCup(s,this.itemDepth,t),this.CheckForWin();return}})}isItemInCup(e,t){return Phaser.Math.Distance.Between(t.x,t.y,e?this.basketPosition.x:this.trashPosition.x,e?this.basketPosition.y:this.trashPosition.y)<=this.maxCupDistance}CheckForWin(){var e=!0;for(let t of this.items)if(!t.sortedCorrectly){e=!1;break}e?this.triggerWin():this.sortedItemsCount===this.items.length&&this.triggerLose(500)}_update(e,t){this.ghost.x=Phaser.Math.Interpolation.SmoothStep(.1,this.ghost.x,this.input.activePointer.x)}_timeout(){this.triggerLose(0)}_afterLoss(){}_afterWin(){}triggerLose(e){this.loseGame(e)}triggerWin(){var e=this.add.image(238,685,i.SORT.WIN_GHOST).setDepth(502);this.time.delayedCall(400,()=>{this.add.image(0,0,i.SORT.WIN_BACKGROUND).setOrigin(0,0).setDepth(500)},null,this),this.tweens.add({targets:e,x:230.8,y:244.8,ease:"Sine.easeOut",duration:1700,delay:500,repeat:0,yoyo:!1}),this.winGame(3e3)}},class extends g{constructor(){super({sceneName:i.SCENES.GHOSTBUSTERS,duration:2e4,showCountdown:!1,startScreenColor:1710618,startText:"BUST\nOUT!",startTextColor:16777215,startTextYOrigin:.35,endScreen:i.GHOSTBUSTERS.END,nextScene:i.SCENES.HEAVENHELL,endButtons:{normalNoSkip:{x:426.5,y:365,scale:1.25},normalWithSkip:{x:283,y:365,scale:1.25},skip:{x:570,y:365,scale:1.25}}}),this.worldColliders=[{x:424,y:230,width:162,height:144},{x:434.5,y:313,width:533,height:18},{x:643,y:394,width:114,height:16},{x:430.5,y:396,width:113,height:16},{x:206.5,y:394.5,width:101,height:9},{x:534,y:7,width:548,height:12},{x:829,y:244.5,width:46,height:467},{x:162.5,y:354.5,width:11,height:63},{x:164,y:151,width:6,height:300},{x:245.5,y:119.5,width:7,height:233},{x:24.5,y:269.5,width:43,height:413}],this.spikeColliders=[{x:57.5,y:271.5,width:21,height:401},{x:145.5,y:197,width:13,height:382},{x:260,y:115.5,width:16,height:199},{x:257,y:222,width:10,height:14},{x:147,y:392.5,width:8,height:7}],this.winZones=[{x:203.5,y:24.5,width:67,height:43}],this.moveSensitivity=.1,this.spinnerRotationSpeed=-85,this.laserSwitchFrequency=1200,this.cannonConfig={interval:1300,topStartPosition:{x:829,y:353.3},topEndPosition:179,bottomStartPosition:{x:829,y:440.8},bottomEndPosition:86,ballSpeed:-4.2},this.hasGradient=!1,this.pointerOffset=null,this.balls=[]}_init(){this.ghost=null,this.spinner=null,this.hasGradient=!1,this.balls=[],this.pointerOffset=null}_preload(){}_create(){this.initPhysics(),this.addBackgroundImage(i.GHOSTBUSTERS.BACKGROUND),this.add.image(96,33,i.PROTECT.DRAG_TEXT).setTint(8882062).setScale(.32).setDepth(1),this.createLevel(),this.spawnGhost(),this.createStartGradient()}initPhysics(){this.matter.world.setBounds(0,0,this.game.renderer.width,this.game.renderer.height),this.worldColliders.forEach(e=>{this.matter.add.rectangle(e.x,e.y,e.width,e.height,{isStatic:!0})}),this.spikeColliders.forEach(e=>{this.matter.add.rectangle(e.x,e.y,e.width,e.height,{label:"killer",isStatic:!0})}),this.winZones.forEach(e=>{this.matter.add.rectangle(e.x,e.y,e.width,e.height,{label:"winZone",isStatic:!0})}),this.collisionPlayer=2,this.matter.world.on("collisionstart",function(e,t,i){("player"===t.label||"player"===i.label)&&(("killer"===t.label||"killer"===i.label)&&this.ghost.die(),("winZone"===t.label||"winZone"===i.label)&&this.ghost.win())},this)}createLevel(){this.add.image(0,0,i.GHOSTBUSTERS.LEVEL).setOrigin(0).setDepth(5),this.spawnSpinner(656.3,157.3),this.spawnCannon(866.3,396),this.spawnLaser(473.4,84,this.laserSwitchFrequency,this.laserSwitchFrequency,!0),this.spawnLaser(409.5,84,this.laserSwitchFrequency,this.laserSwitchFrequency,!1),this.spawnLaser(344.9,84,this.laserSwitchFrequency,this.laserSwitchFrequency,!0)}spawnSpinner(e,t){var s=this.matter.add.image(e,t,i.GHOSTBUSTERS.SPINNER).setDepth(9),a=Phaser.Physics.Matter.Matter.Bodies,n=a.rectangle(e,t,15,270,{label:"killer"}),r=a.rectangle(e,t,270,15,{label:"killer"}),o=Phaser.Physics.Matter.Matter.Body.create({parts:[n,r]});o.isStatic=!0,s.setExistingBody(o),s.onUpdate=e=>{s.setAngle(s.angle+this.spinnerRotationSpeed*e/1e3)},this.spinner=s}spawnCannon(e,t){var s=this.add.image(e,t,i.GHOSTBUSTERS.CANNON).setDepth(16);s.nextSpawnOnTop=!0,s.spawnNextBall=()=>{this.spawnBall(s.nextSpawnOnTop?this.cannonConfig.topStartPosition:this.cannonConfig.bottomStartPosition,this.cannonConfig.ballSpeed,s.nextSpawnOnTop?this.cannonConfig.topEndPosition:this.cannonConfig.bottomEndPosition),this.time.delayedCall(this.cannonConfig.interval,()=>{s.nextSpawnOnTop=!s.nextSpawnOnTop,s.spawnNextBall()},null,this)},s.spawnNextBall()}spawnBall(e,t,s){var a=this.matter.add.image(e.x,e.y,i.GHOSTBUSTERS.BALL,null,{chamfer:{radius:13},label:"killer",ignoreGravity:!0,frictionAir:0,friction:0}).setDepth(15),n=Phaser.Physics.Matter.Matter.Bodies.rectangle(e.x,e.y,28,28,{label:"killer",chamfer:{radius:16}}),r=Phaser.Physics.Matter.Matter.Body.create({parts:[n]});a.setExistingBody(r),a.setIgnoreGravity(!0),a.setFrictionAir(0),a.setCollidesWith([this.collisionPlayer]),a.onUpdate=e=>{a.setVelocity(t,0),a.x<=s&&(a.setVisible(!1),a.setCollidesWith([]),this.balls.shift(),a.destroy())},this.balls.push(a)}spawnLaser(e,t,s,a,n){var r=this.matter.add.image(e,t,i.GHOSTBUSTERS.LASER).setDepth(5);this.add.image(e,t,i.GHOSTBUSTERS.LASER).setDepth(4).setAlpha(.1).setBlendMode(Phaser.BlendModes.ERASE).setScale(.5,1);var o=Phaser.Physics.Matter.Matter.Bodies.rectangle(e,t,7,140,{label:"killer"}),h=Phaser.Physics.Matter.Matter.Body.create({parts:[o]});h.isStatic=!0,r.setExistingBody(h),r.logic={timeToSwitch:s,delay:a,active:n,switchLasers:()=>{r.logic.active=!r.logic.active,r.setVisible(r.logic.active),r.setCollidesWith(r.logic.active?[this.collisionPlayer]:[]),this.time.delayedCall(r.logic.timeToSwitch,()=>{r.logic.switchLasers()},null,this)}},this.time.delayedCall(a,r.logic.switchLasers(),null,this),r.setCollidesWith([]),r.setVisible(!1)}spawnGhost(){var e={anim:this.addAnimation(i.FLY.GHOST,i.ANIMATIONS.GHOST_IDLE).setDepth(10).setImageInteractive().setOffset(-38,-29).setPositionOverride(38,29).setScaleMultiplier(.7).setLoop(!0).start(),body:this.matter.add.image(38,29,i.FLY.GHOST,null,{chamfer:{radius:55},label:"player",ignoreGravity:!0,frictionAir:.25,friction:0}).setCollisionCategory(this.collisionPlayer).setScale(.22).setVisible(!1),isDragging:!1,isAlive:!0,onUpdate:t=>{if(e.anim.setPositionOverride(e.body.x,e.body.y),e.body.setAngle(0),e.isAlive&&e.isDragging){var i={x:this.input.activePointer.x+this.pointerOffset.x-e.anim.GetPositionOverride().x,y:this.input.activePointer.y+this.pointerOffset.y-e.anim.GetPositionOverride().y};e.body.setVelocity(i.x*this.moveSensitivity,i.y*this.moveSensitivity,t)}},die:()=>{this.triggerLose(),e.isAlive=!1,e.anim.setAnimation(this.cache.json.get(i.ANIMATIONS.GHOST_DIE)).setPlaybackSpeed(1).setLoop(!1).setAnimFinishCallback(()=>{e.anim.GetImage().setVisible(!1)})},win:()=>{e.isAlive=!1,e.anim.stop(),this.tweens.add({targets:e.anim.GetImage(),alpha:0,y:"-=100",ease:"Quad.easeIn",duration:1e3,repeat:0,yoyo:!1}),this.triggerWin()}};this.input.on("pointerdown",function(t){this.hasGradient&&this.gradient.fadeOut(),this.pointerOffset={x:e.anim.GetPositionOverride().x-t.x,y:e.anim.GetPositionOverride().y-t.y},this.ghost.isDragging=!0},this),this.input.on("pointerup",function(e){this.ghost.isDragging=!1},this),this.ghost=e}createStartGradient(){var e=this.registry.get(i.REGISTRY.GHOSTBUSTERS_ATTEMPTED);if(this.hasGradient=!e,!e){this.registry.set(i.REGISTRY.GHOSTBUSTERS_ATTEMPTED,!0);var t=this.add.image(0,0,i.GHOSTBUSTERS.START_GRADIENT).setOrigin(0).setDepth(100);t.canFade=!0,t.fadeOut=()=>{t.canFade&&(t.canFade=!1,this.tweens.add({targets:t,alpha:0,ease:"Linear",duration:1e3,repeat:0,yoyo:!1}))},this.gradient=t}}_update(e,t){this.ghost.onUpdate(t),this.spinner.onUpdate(t),this.balls.forEach(e=>e.onUpdate(t))}_timeout(){}_afterLoss(){}_afterWin(){}triggerLose(){this.loseGame(1500)}triggerWin(){this.winGame(1e3)}},class extends g{constructor(){super({sceneName:i.SCENES.HEAVENHELL,duration:2e4,showCountdown:!1,startScreenColor:5379472,startText:"CHOOSE!",startTextColor:16777215,endScreen:i.HEAVENHELL.END,nextScene:i.SCENES.CREDITS,endButtons:{normalNoSkip:{x:426.5,y:386,scale:1.3},normalWithSkip:{x:283,y:386,scale:1.3},skip:{x:570,y:386,scale:1.3}}}),this.clickableWidth=100,this.clickerSwingTime=750,this.swingStartX=162,this.swingEndX=691,this.cameraFollowConfig={lerp:.8,offsetX:0,offsetY:75},this.startButtonConfig=[{x:274,y:32.8,image:i.HEAVENHELL.SIGN_HELL,onClick:()=>{this.startHellMinigame()},firstYMove:24.5,secondYMove:-264.5},{x:618.72,y:316,image:i.HEAVENHELL.SIGN_HEAVEN,onClick:()=>{this.startHeavenMinigame()},firstYMove:-24.5,secondYMove:264.5}],this.hellGhostConfig={scaleX:-1,image:i.HEAVENHELL.GHOST_SIDE,moveSpeed:107,winPos:{x:-1895,y:-81},losePos:{x:-1640,y:306}},this.hellDuckConfig=[{startX:-206,startY:404,endX:-400,endY:461,tweenTime:2e3,scaleX:-1,scaleY:1,image:i.HEAVENHELL.NORMAL_DUCK,shape:"suck-a-duck"},{startX:-568,startY:390,endX:-575,endY:254,tweenTime:2e3,scaleX:1,scaleY:1,image:i.HEAVENHELL.EVIL_DUCK,shape:"duck-devil"},{startX:-874,startY:464,endX:-881,endY:329,tweenTime:2e3,scaleX:1,scaleY:1,image:i.HEAVENHELL.EVIL_DUCK,shape:"duck-devil"},{startX:-1222,startY:265,endX:-1057,endY:186,tweenTime:2e3,scaleX:1,scaleY:1,image:i.HEAVENHELL.NORMAL_DUCK,shape:"suck-a-duck"},{startX:-1275,startY:109,endX:-987,endY:-77,tweenTime:2e3,scaleX:1,scaleY:1,image:i.HEAVENHELL.EVIL_DUCK,shape:"duck-devil"},{startX:-1298,startY:-61,endX:-1508,endY:-257,tweenTime:2e3,scaleX:-1,scaleY:1,image:i.HEAVENHELL.NORMAL_DUCK,shape:"suck-a-duck"},{startX:-1340,startY:558,endX:-1219,endY:355,tweenTime:2e3,scaleX:1,scaleY:1,image:i.HEAVENHELL.EVIL_DUCK,shape:"duck-devil"}],this.heavenSteps=[{x:612,y:191},{x:665,y:140},{x:715,y:90},{x:768,y:38},{x:819,y:-14},{x:870,y:-66},{x:921,y:-117},{x:970,y:-168},{x:1021,y:-221},{x:1074,y:-271},{x:1128,y:-322},{x:1179,y:-375},{x:1233,y:-427},{x:1282,y:-477},{x:1331,y:-527},{x:1386,y:-584},{x:1434,y:-634},{x:1487,y:-684},{x:1541,y:-736},{x:1589,y:-788},{x:1661,y:-839}],this.heavenClouds=[{scrollFactor:2,depth:10,clouds:[{x:920,y:-209,image:i.HEAVENHELL.CLOUD_5},{x:1271,y:-505,image:i.HEAVENHELL.CLOUD_7},{x:729,y:102,image:i.HEAVENHELL.CLOUD_2},{x:1064,y:-458,image:i.HEAVENHELL.CLOUD_1},{x:1704,y:-1192,image:i.HEAVENHELL.CLOUD_1},{x:1912,y:-1239,image:i.HEAVENHELL.CLOUD_7},{x:1561,y:-943,image:i.HEAVENHELL.CLOUD_5},{x:1370,y:-633,image:i.HEAVENHELL.CLOUD_2},{x:1237,y:-30,image:i.HEAVENHELL.CLOUD_2},{x:1429,y:-340,image:i.HEAVENHELL.CLOUD_5},{x:1557,y:-1279,image:i.HEAVENHELL.CLOUD_1},{x:1764,y:-1326,image:i.HEAVENHELL.CLOUD_7},{x:1413,y:-1029,image:i.HEAVENHELL.CLOUD_5},{x:1222,y:-719,image:i.HEAVENHELL.CLOUD_2},{x:1090,y:-116,image:i.HEAVENHELL.CLOUD_2},{x:1281,y:-427,image:i.HEAVENHELL.CLOUD_5},{x:1632,y:-723,image:i.HEAVENHELL.CLOUD_7},{x:1425,y:-676,image:i.HEAVENHELL.CLOUD_1},{x:1780,y:-637,image:i.HEAVENHELL.CLOUD_7},{x:1572,y:-590,image:i.HEAVENHELL.CLOUD_1},{x:2080,y:-652,image:i.HEAVENHELL.CLOUD_1},{x:2287,y:-699,image:i.HEAVENHELL.CLOUD_7},{x:1936,y:-402,image:i.HEAVENHELL.CLOUD_5},{x:1745,y:-92,image:i.HEAVENHELL.CLOUD_2},{x:1877,y:-694,image:i.HEAVENHELL.CLOUD_2},{x:2069,y:-1005,image:i.HEAVENHELL.CLOUD_5},{x:2419,y:-1301,image:i.HEAVENHELL.CLOUD_7},{x:2212,y:-1254,image:i.HEAVENHELL.CLOUD_1},{x:2227,y:-565,image:i.HEAVENHELL.CLOUD_1},{x:2435,y:-612,image:i.HEAVENHELL.CLOUD_7},{x:2084,y:-316,image:i.HEAVENHELL.CLOUD_5}]},{scrollFactor:1.5,depth:9,clouds:[{x:1748,y:-1125,image:i.HEAVENHELL.CLOUD_1},{x:1955,y:-1172,image:i.HEAVENHELL.CLOUD_7},{x:1604,y:-875,image:i.HEAVENHELL.CLOUD_5},{x:1413,y:-565,image:i.HEAVENHELL.CLOUD_2},{x:1545,y:-1167,image:i.HEAVENHELL.CLOUD_2},{x:1736,y:-1478,image:i.HEAVENHELL.CLOUD_5},{x:2087,y:-1774,image:i.HEAVENHELL.CLOUD_7},{x:1880,y:-1727,image:i.HEAVENHELL.CLOUD_1},{x:866,y:-346,image:i.HEAVENHELL.CLOUD_4},{x:1126,y:-348,image:i.HEAVENHELL.CLOUD_3},{x:866,y:-561,image:i.HEAVENHELL.CLOUD_1},{x:1074,y:-608,image:i.HEAVENHELL.CLOUD_7},{x:723,y:-311,image:i.HEAVENHELL.CLOUD_5},{x:532,y:-1,image:i.HEAVENHELL.CLOUD_2},{x:399,y:602,image:i.HEAVENHELL.CLOUD_2},{x:591,y:291,image:i.HEAVENHELL.CLOUD_5},{x:942,y:-5,image:i.HEAVENHELL.CLOUD_7},{x:734,y:42,image:i.HEAVENHELL.CLOUD_1},{x:2054,y:-546,image:i.HEAVENHELL.CLOUD_1},{x:2262,y:-593,image:i.HEAVENHELL.CLOUD_7},{x:1911,y:-296,image:i.HEAVENHELL.CLOUD_5},{x:1719,y:14,image:i.HEAVENHELL.CLOUD_2},{x:1852,y:-588,image:i.HEAVENHELL.CLOUD_2},{x:2043,y:-899,image:i.HEAVENHELL.CLOUD_5},{x:2394,y:-1195,image:i.HEAVENHELL.CLOUD_7},{x:2186,y:-1148,image:i.HEAVENHELL.CLOUD_1}]},{scrollFactor:1.1,depth:8,clouds:[{x:1170,y:-195,image:i.HEAVENHELL.CLOUD_1},{x:1378,y:-242,image:i.HEAVENHELL.CLOUD_7},{x:1027,y:55,image:i.HEAVENHELL.CLOUD_5},{x:835,y:365,image:i.HEAVENHELL.CLOUD_2},{x:968,y:-237,image:i.HEAVENHELL.CLOUD_2},{x:1159,y:-548,image:i.HEAVENHELL.CLOUD_5},{x:1510,y:-844,image:i.HEAVENHELL.CLOUD_7},{x:1302,y:-797,image:i.HEAVENHELL.CLOUD_1},{x:760,y:5,image:i.HEAVENHELL.CLOUD_1},{x:775,y:-123,image:i.HEAVENHELL.CLOUD_7},{x:1434,y:-1237,image:i.HEAVENHELL.CLOUD_1},{x:1642,y:-1284,image:i.HEAVENHELL.CLOUD_7},{x:1291,y:-987,image:i.HEAVENHELL.CLOUD_5},{x:1099,y:-677,image:i.HEAVENHELL.CLOUD_2},{x:967,y:-74,image:i.HEAVENHELL.CLOUD_2},{x:1159,y:-384,image:i.HEAVENHELL.CLOUD_5},{x:1509,y:-681,image:i.HEAVENHELL.CLOUD_7},{x:1302,y:-634,image:i.HEAVENHELL.CLOUD_1},{x:1497,y:1,image:i.HEAVENHELL.CLOUD_1},{x:1704,y:-46,image:i.HEAVENHELL.CLOUD_7},{x:1354,y:251,image:i.HEAVENHELL.CLOUD_5},{x:1162,y:561,image:i.HEAVENHELL.CLOUD_2},{x:1294,y:-42,image:i.HEAVENHELL.CLOUD_2},{x:1486,y:-352,image:i.HEAVENHELL.CLOUD_5},{x:1837,y:-649,image:i.HEAVENHELL.CLOUD_7},{x:1629,y:-602,image:i.HEAVENHELL.CLOUD_1},{x:1498,y:-162,image:i.HEAVENHELL.CLOUD_1},{x:970,y:513,image:i.HEAVENHELL.CLOUD_7},{x:955,y:641,image:i.HEAVENHELL.CLOUD_1}]}],this.startSigns=[],this.isPlaying=!1,this.isHell=!1,this.hellDucks=[]}_init(){this.startSigns=[],this.isPlaying=!1,this.isHell=!1,this.hellGhost=null,this.hellFollowRect=null,this.hellDucks=[],this.clickerMovingRight=!0,this.swingTimer=0}_preload(){}_create(){this.initPhysics(),this.createStaticCombined(),this.createButtons(),this.createGhost(),this.createHellLevel(),this.initHeavenImages()}initPhysics(){this.physicsShapes=this.cache.json.get(i.PHYSICS.HEAVENHELL_SHAPES),this.hellGhostCollisionCategory=2,this.matter.world.on("collisionstart",function(e,t,i){("ghost-side"===t.gameObject.body.label&&"suck-a-duck"===i.gameObject.body.label||"ghost-side"===t.gameObject.body.label&&"duck-devil"===i.gameObject.body.label||"ghost-side"===i.gameObject.body.label&&"suck-a-duck"===t.gameObject.body.label||"ghost-side"===i.gameObject.body.label&&"duck-devil"===t.gameObject.body.label)&&this.hellGhost.die()},this)}createStaticCombined(){this.add.image(1542,-209,i.HEAVENHELL.HEAVEN_BACKGROUND).setScale(2.336,122.7).setDepth(0),this.add.image(426.5,240,i.HEAVENHELL.START_CLOUD).setDepth(15);for(var e=0;e<4;e++)this.add.image(-1519.4,1581,i.HEAVENHELL.HELL_BACKGROUND).setScale(6.89,29380)}createButtons(){this.startButtonConfig.forEach(e=>{var t=this.add.image(e.x,e.y,e.image).setInteractive(this.input.makePixelPerfect()).setDepth(200);t.config=e,t.hoverStart=null,t.hoverEnd=null,t.isInteractable=!0,t.on("pointerover",function(){t.isInteractable&&(null!=t.hoverEnd&&t.hoverEnd.stop(),t.hoverStart=this.tweens.add({targets:t,scaleX:1.2,scaleY:1.2,ease:"Sine.easeOut",duration:83,repeat:0,yoyo:!1}))},this),t.on("pointerout",function(){t.isInteractable&&(null!=t.hoverStart&&t.hoverStart.stop(),t.hoverEnd=this.tweens.add({targets:t,scaleX:1,scaleY:1,ease:"Sine.easeOut",duration:83,repeat:0,yoyo:!1}))},this),t.on("pointerup",function(){t.config.onClick(),this.startSigns.forEach(e=>{e.slideOut()})},this),t.slideOut=()=>{t.isInteractable&&(null!=t.hoverStart&&t.hoverStart.stop(),null!=t.hoverEnd&&t.hoverEnd.stop(),this.tweens.timeline({targets:t,ease:"Cubic.easeInOut",duration:500,loop:0,tweens:[{targets:t,y:t.y+t.config.firstYMove,duration:166,repeat:0,yoyo:!1},{targets:t,y:t.y+t.config.secondYMove,alpha:0,duration:583,repeat:0,yoyo:!1}]}))},this.startSigns.push(t)})}createGhost(){this.startGhost=this.add.image(435.4,233.4,i.HEAVENHELL.START_GHOST).setOrigin(.518,.9131).setDepth(20),this.cameras.main.startFollow(this.startGhost,void 0,this.cameraFollowConfig.lerp,this.cameraFollowConfig.lerp,this.cameraFollowConfig.offsetX,this.cameraFollowConfig.offsetY)}startHellMinigame(){this.startGhost.setVisible(!1),this.initHellGhost(),this.initHellFollowRect(),this.initHellDucks(),this.isPlaying=!0,this.isHell=!0}initHellGhost(){var e=this.matter.add.image(422.5,234.6,i.HEAVENHELL.GHOST_SIDE,void 0,{shape:this.physicsShapes["ghost-side"]}).setScale(this.hellGhostConfig.scaleX,1).setDepth(20).setStatic(!1).setIgnoreGravity(!0);e.setCollisionCategory(this.hellGhostCollisionCategory),e.isActive=!1,e.onUpdate=t=>{if(e.setDepth(this.getHellSortingOrder(e.y)),!e.isActive){e.setVelocity(0,0);return}e.setAngle(0);var i=this.cameras.main.getWorldPoint(this.input.activePointer.x,this.input.activePointer.y);i=new Phaser.Math.Vector2(i.x-e.x,i.y-e.y).scale(.025),e.setVelocity(i.x,i.y),e.checkForWin()},e.checkForWin=()=>{e.x<this.hellGhostConfig.winPos.x&&e.y<this.hellGhostConfig.winPos.y?(e.isActive=!1,this.tweens.add({targets:e,scaleX:-2,scaleY:2,alpha:0,tint:"0xFF0000",ease:"Linear",duration:1e3,repeat:0,yoyo:!1,onComplete:()=>{}}),this.triggerWin(!0)):e.x<this.hellGhostConfig.losePos.x&&e.y>this.hellGhostConfig.losePos.y&&e.die()},e.die=()=>{e.isActive&&(e.setCollidesWith([]),this.triggerLose(!0),e.isActive=!1,this.tweens.timeline({targets:e,ease:"Cubic.easeInOut",duration:1e3,loop:0,tweens:[{targets:e,scaleX:-1.2,scaleY:1.2,angle:47,duration:250},{targets:e,scaleX:.1,scaleY:.1,angle:-250,alpha:.3,duration:1200}]}))},this.tweens.add({targets:e,x:212.8,y:281.6,ease:"Sine.easeInOut",duration:400,repeat:0,yoyo:!1,onComplete:()=>{e.isActive=!0}}),this.cameras.main.startFollow(e,void 0,this.cameraFollowConfig.lerp,this.cameraFollowConfig.lerp,this.cameraFollowConfig.offsetX,this.cameraFollowConfig.offsetY),this.hellGhost=e}initHellFollowRect(){var e=this.matter.add.image(800,240,i.FLY.WHITE_SQUARE,void 0,{isStatic:!0}).setScale(.5,30).setAlpha(0);e.onUpdate=()=>{if(this.hellGhost.isActive){var t=this.hellGhost.x+150;t<e.x&&(e.x=t),e.y=this.hellGhost.y}},this.hellFollowRect=e}initHellDucks(){this.hellDuckConfig.forEach(e=>{var t=this.matter.add.image(e.startX,e.startY,e.image,void 0,{shape:this.physicsShapes[e.shape]}).setCollidesWith([this.hellGhostCollisionCategory]).setScale(e.scaleX,e.scaleY).setDepth(20).setStatic(!1).setIgnoreGravity(!0);this.hellDucks.push(t),this.tweens.add({targets:t,x:e.endX,y:e.endY,ease:"Sine.easeInOut",duration:e.tweenTime,repeat:-1,yoyo:!0,onUpdate:()=>{t.setDepth(this.getHellSortingOrder(t.y))},progress:Math.random()})})}getHellSortingOrder(e){return(e- -300)*150/1e3+100}createHellLevel(){this.matter.add.image(-760,66,i.HEAVENHELL.ROAD,void 0,{shape:this.physicsShapes.road}).setDepth(50).setCollidesWith([this.hellGhostCollisionCategory]),this.add.image(-672.8,551,i.HEAVENHELL.ROAD_FIRE).setDepth(300)}startHeavenMinigame(){this.isPlaying=!0,this.isHell=!1,this.initHeavenClicker(),this.startGhost.setVisible(!1),this.initHeavenGhost()}initHeavenImages(){this.add.image(706.92,139.7,i.HEAVENHELL.STAIRS_START).setAngle(-45).setDepth(50),this.add.image(1097.7,-259.73,i.HEAVENHELL.STAIRS_MID).setAngle(-45).setDepth(51),this.add.image(1602.57,-854.4,i.HEAVENHELL.STAIRS_END).setDepth(52),this.heavenClouds.forEach(e=>{for(let t of e.clouds)this.add.image(t.x,t.y,t.image).setScale(1.2).setDepth(e.depth).setScrollFactor(e.scrollFactor,e.scrollFactor)})}initHeavenClicker(){this.swing=this.add.image(426,413,i.HEAVENHELL.SWING).setDepth(900).setScrollFactor(0),this.clicker=this.add.image(426,413,i.HEAVENHELL.CLICKER).setDepth(900).setScrollFactor(0),this.input.on("pointerdown",()=>{this.handleHeavenClick()})}handleHeavenClick(){this.isPlaying&&!this.isHell&&this.heavenGhost.moveToStep(this.isClickerWithinLimits())}initHeavenGhost(){var e=this.add.image(458,238,i.HEAVENHELL.GHOST_SIDE).setOrigin(.784,.9933).setDepth(100);e.currentStep=0,e.currentTween=null,e.isActive=!0,e.moveToStep=t=>{if(null!=e.currentTween&&e.currentTween.stop(),e.currentStep+=t?1:-1,e.currentStep<0&&(e.currentStep=0),e.currentStep>=this.heavenSteps.length){e.animateWin(),e.isActive=!1;return}t?e.currentTween=this.tweens.timeline({targets:e,ease:"Linear",duration:500,loop:0,tweens:[{targets:e,x:this.heavenSteps[e.currentStep].x-25,y:this.heavenSteps[e.currentStep].y-15,ease:"Linear",duration:250},{targets:e,x:this.heavenSteps[e.currentStep].x,y:this.heavenSteps[e.currentStep].y,ease:"Linear",duration:250}]}):e.currentTween=this.tweens.add({targets:e,x:this.heavenSteps[e.currentStep].x,y:this.heavenSteps[e.currentStep].y,ease:"Linear",duration:500})},e.animateWin=()=>{null!=e.currentTween&&e.currentTween.stop(),e.currentTween=this.tweens.add({targets:e,x:"+=284",y:"-=28",scaleX:1.4,scaleY:1.4,alpha:0,ease:"Sine.easeIn",duration:1e3}),this.triggerWin(!1)},e.moveToStep(0),this.cameras.main.startFollow(e,void 0,.02,.02,this.cameraFollowConfig.offsetX,this.cameraFollowConfig.offsetY),this.heavenGhost=e}isClickerWithinLimits(){return Phaser.Math.Difference(this.clicker.x,this.swing.x)<this.clickableWidth}_update(e,t){this.isPlaying&&(this.isHell?(this.hellGhost.onUpdate(t),this.hellFollowRect.onUpdate()):this.moveClicker(t))}moveClicker(e){this.clickerMovingRight?(this.swingTimer+=e/this.clickerSwingTime,this.swingTimer>=1&&(this.clickerMovingRight=!this.clickerMovingRight,this.swingTimer=1)):(this.swingTimer-=e/this.clickerSwingTime,this.swingTimer<=0&&(this.clickerMovingRight=!this.clickerMovingRight,this.swingTimer=0)),this.clicker.x=Phaser.Math.Interpolation.SmoothStep(this.swingTimer,this.swingStartX,this.swingEndX)}_timeout(){}_afterLoss(){}_afterWin(){}triggerLose(e){this.loseGame(1e3)}triggerWin(e){this.registry.set(i.REGISTRY.HELL_COMPLETED,e),this.winGame(1500)}},class extends g{constructor(){super({sceneName:i.SCENES.CREDITS,duration:5e3,showCountdown:!0,startScreenColor:5618412,startText:"WELCOME\nTO HEAVEN!",startTextYOrigin:.35,timeToStart:1500,startTextColor:16777215,nextScene:i.SCENES.MENU,endButtons:{normalNoSkip:{x:426.5,y:386,scale:1.3},normalWithSkip:{x:283,y:386,scale:1.3},skip:{x:570,y:386,scale:1.3}}}),this.isHell=!1}_init(){this.isHell=this.registry.get(i.REGISTRY.HELL_COMPLETED),this.isHell&&(this.startText="WELCOME\nTO HELL!",this.startScreenColor=16711680,this.startTextColor=0),this.registry.set(i.REGISTRY.GAME_COMPLETED,!0)}_preload(){}_create(){this.add.image(0,0,this.isHell?i.CREDITS.HELL:i.CREDITS.HEAVEN).setOrigin(0,0).setDepth(10),this.isHell||this.add.image(85,252,i.CREDITS.HEAVEN).setDepth(2)}_update(e,t){}_timeout(){this.winGame()}_afterLoss(){}_afterWin(){}}],physics:{default:"matter",matter:{debug:!1,autoUpdate:!1}}});
//# sourceMappingURL=index.fc14028a.js.map
