!function (e) { function t(t) { for (var i, o, r = t[0], h = t[1], c = t[2], d = 0, u = []; d < r.length; d++)o = r[d], Object.prototype.hasOwnProperty.call(a, o) && a[o] && u.push(a[o][0]), a[o] = 0; for (i in h) Object.prototype.hasOwnProperty.call(h, i) && (e[i] = h[i]); for (l && l(t); u.length;)u.shift()(); return n.push.apply(n, c || []), s() } function s() { for (var e, t = 0; t < n.length; t++) { for (var s = n[t], i = !0, r = 1; r < s.length; r++) { var h = s[r]; 0 !== a[h] && (i = !1) } i && (n.splice(t--, 1), e = o(o.s = s[0])) } return e } var i = {}, a = { 0: 0 }, n = []; function o(t) { var s; return (i[t] || (s = i[t] = { i: t, l: !1, exports: {} }, e[t].call(s.exports, s, s.exports, o), s.l = !0, s)).exports } o.m = e, o.c = i, o.d = function (e, t, s) { o.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: s }) }, o.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, o.t = function (e, t) { if (1 & t && (e = o(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var s = Object.create(null); if (o.r(s), Object.defineProperty(s, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var i in e) o.d(s, i, function (t) { return e[t] }.bind(null, i)); return s }, o.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return o.d(t, "a", t), t }, o.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, o.p = "./"; var r = (h = window.webpackJsonp = window.webpackJsonp || []).push.bind(h); h.push = t; for (var h = h.slice(), c = 0; c < h.length; c++)t(h[c]); var l = r; n.push([191, 1]), s() }({ 191: function (e, t, s) { e.exports = s(412) }, 412: function (e, t, s) { "use strict"; s.r(t); t = s(17); var i = s.n(t); s(192); const a = Symbol("singleton"); class n { static get instance() { return this[a] || (this[a] = new this), this[a] } constructor() { var e = this.constructor; return e[a] || (e[a] = this), e[a] } } class o extends n { constructor() { super(), this.scene = null, this.audioAtlasses = ["main-audio", "general-audio", "bb-audio", "ln-audio"], this.audios = {}, this.musicKeys = ["menumusic", "dance-1", "dance-2", "dance-3"], this.musicVolume = 1, this.sfxVolume = 1, this.missingAudios = {} } updateAllVolumes() { var e = this.audioAtlasses; for (let s = 0; s < e.length; s++) { var t = e[s]; if (!(t = this.audios[t])) return; Object.values(t).forEach(e => { this.updateVolume(e) }) } } updateVolume(e) { e.currentMarker ? this.musicKeys.includes(e.currentMarker.name) ? e.setVolume(this.musicVolume ? 1 : 0) : e.setVolume(this.sfxVolume ? 1 : 0) : console.warn("current marker not found") } init(e) { this.scene = e } addAudioSprite(e) { this.key = e } hasAtlasLoaded(e) { return !!this.scene.cache.audio.entries.entries[e] } playSound(e, t, s, i) { if (s && this.init(s), s = this.getAudioSprite(e, t), this.hasAtlasLoaded(e)) return s.play(t, i), this.updateVolume(s), s } getAudioSprite(e, t) { this.audios[e] || (this.audios[e] = {}); let s = this.audios[e][t]; return s || (this.audios[e][t] = this.scene.sound.addAudioSprite(e), (s = this.audios[e][t]).markers[t]) || (this.audios[e][t] = this.scene.sound.addAudioSprite("main-audio"), s = this.audios[e][t]), s } stopSound(e, t) { this.getAudioSprite(e, t).stop() } pauseSound(e, t) { this.getAudioSprite(e, t).pause() } resumeSound(e, t) { this.getAudioSprite(e, t).resume() } stopAll() { var e = this.audioAtlasses; for (let n = 0; n < e.length; n++) { var t = e[n], s = this.audios[t]; if (!s) return; var i = Object.keys(s); for (let e = 0; e < i.length; e++) { var a = i[e]; this.stopSound(t, a) } } } pauseAll() { var e = this.audioAtlasses; for (let n = 0; n < e.length; n++) { var t = e[n], s = this.audios[t]; if (!s) return; var i = Object.keys(s); for (let e = 0; e < i.length; e++) { var a = i[e]; this.pauseSound(t, a) } } } resumeAll() { var e = this.audioAtlasses; for (let n = 0; n < e.length; n++) { var t = e[n], s = this.audios[t]; if (!s) return; var i = Object.keys(s); for (let e = 0; e < i.length; e++) { var a = i[e]; this.resumeSound(t, a) } } } fadeOut(e, t, s) { const i = this.getAudioSprite(e, t); var a = this.musicKeys.includes(i.currentMarker.name); !this.musicVolume && a || (this.sfxVolume || a) && this.scene.tweens.addCounter({ duration: s, from: 1, to: 0, onUpdate: e => { e = e.getValue(), i.setVolume(e) }, onComplete: () => { this.resetSoundAfterFade(e, t, i) } }) } resetSoundAfterFade(e, t, s) { this.stopSound(e, t), s.setVolume(1) } fadeOutAllSoundsForSpecificScenario(e, t) { this.stopAll() } play(e) { var t = 1 < arguments.length && void 0 !== arguments[1] && arguments[1]; if (!this.audios[e]) try { this.audios[e] = this.scene.sound.add(e) } catch (t) { this.missingAudios[e] = !0 } this.audios[e] && (this.audios[e].play(), this.audios[e].setLoop(t)) } getMissingAudios() { return Object.keys(this.missingAudios) } pause() { this.scene.sound.pauseAll() } resume() { this.scene.sound.resumeAll() } } class r extends n { constructor() { super(), this.viewport = document.querySelector("meta[name=viewport]"), this.viewportContent = this.viewport.content, window.addEventListener("resize", this._onWindowResizeDelay.bind(this), !1), this._emitterTimeout = null, this.moved = !0, this._realDPR = window.devicePixelRatio, this.previousHeight = 0, this.emitter = new Phaser.Events.EventEmitter, this.keyboardVisible = !1, this._currentScene = null, this._gameSizeReference = { width: 1280, height: 812 }, this._gameScale = { x: 1, y: 1 }, this._gameSize = { width: 0, height: 0 }, window.cordova && "android" === window.cordova.platformId && window.cordova.plugins.AndroidKeyboard.on("keyboard", e => { e = e.height, this.calculateVisibleHeight(e) }), "virtualKeyboard" in navigator ? (navigator.virtualKeyboard.overlaysContent = !0, navigator.virtualKeyboard.addEventListener("geometrychange", e => { e = e.target.boundingRect.height, this.calculateVisibleHeight(e) })) : window.visualViewport && window.visualViewport.addEventListener("resize", e => { e = e.target.height, this.visibleHeight = e }), this.cordovaRatio = .4 } calculateVisibleHeight(e) { e = this.windowHeight - e, this.visibleHeight = e < this.windowHeight / 2 ? this.windowHeight / 2 : e, this.setKeyboardOffset() } get width() { return this._gameSize.width } get height() { return this._gameSize.height } get gameSize() { return this._gameSize } get gameScale() { return this._gameScale } get realDPR() { return this._realDPR } get dpr() { return this._currentScene.game.config.resolution || window.devicePixelRatio || 1 } init(e) { this.windowHeight = window.innerHeight, this.windowWidth = window.innerWidth, this.visibleHeight = window.innerHeight, this._currentScene ? (this._currentScene.scale.off("resize", this._onResize, this), this.emitter.removeAllListeners("resize"), this._currentScene = e) : (this._currentScene = e, this._onWindowResize()), this.content = this._currentScene.scale.canvas, this._currentScene.scale.on("resize", this._onResize, this), this._onWindowResize(), this.moved = !0 } fireResizeEvent() { this.emitter.emit("resize", this._gameSize, this._gameScale) } _onResize(e) { this._gameSize.width = e.width, this._gameSize.height = e.height, this._gameScale.x = e.width / this._gameSizeReference.width, this._gameScale.y = e.height / this._gameSizeReference.height, this.emitter.emit("resize", this._gameSize, this._gameScale) } _onWindowResize() { if (this.setKeyboardOffset(), this.previousWidth !== window.innerWidth) this.emitter.emit("preresize"); else if (Math.abs(this.previousHeight - document.documentElement.clientHeight) < 5) return; window.focus(); var e = this._getWidth(), t = this.keyboardVisible ? this.windowHeight : this._getHeight(), s = this.dpr, i = Math.round(e * s); s = Math.round(t * s); this._currentScene.scale.parent.width = Math.round(e), this._currentScene.scale.parent.height = Math.round(t), this._currentScene.scale.canvas.width = i, this._currentScene.scale.canvas.height = s, this._currentScene.scale.canvas.style.width = Math.round(e) + "px", this._currentScene.scale.canvas.style.height = Math.round(t) + "px", this._currentScene.scale.resize(i, s), this.previousHeight = document.documentElement.clientHeight, this.previousWidth = window.innerWidth, this._currentScene.cameras.main && this._currentScene.cameras.main.setSize(i, s) } setKeyboardOffset() { if (this.content && !this.moved && !this._currentScene.sys.game.device.os.iOS && this.emitter && this._currentScene) { var e = this.keyboardVisible ? -(this.windowHeight - this.visibleHeight) / 2 * this.dpr : 0; this.moved = !0, this.emitter.emit("setVisibility", !1); const t = this._currentScene.tweens.addCounter({ from: this._currentScene.cameras.main.y, to: e, duration: 200, ease: Phaser.Math.Easing.Sine.InOut, onUpdate() { this.emitter.emit("setVisibility", !0); var e = t.getValue(); this._currentScene.cameras.main.setPosition(0, e), this.emitter.emit("cameraMoved", this.windowHeight, this._getHeight(), e) }, onComplete: () => { this.moved = !1 }, onCompleteScope: this, onUpdateScope: this }) } } _getWidth() { return window.innerWidth } _getHeight() { return window.innerHeight } _onWindowResizeDelay() { this.windowWidth !== window.innerWidth && (this.windowWidth = window.innerWidth, this.windowHeight = window.innerHeight, this.visibleHeight = window.innerHeight), this._timeout && clearTimeout(this._timeout), this.previousWidth !== window.innerWidth && this.emitter.emit("preresize"), this._timeout = setTimeout(() => { this._onWindowResize(), this._timeout = null }, this._currentScene.sys.game.device.os.iOS ? r.IOS_DELAY : r.DEFAULT_DELAY), this.emitter.emit("setVisibility", !1) } setKeyboardVisible(e) { this.keyboardVisible = e, this.moved = !1, this.oldHeight || (this.oldHeight = window.innerHeight), this.viewport.setAttribute("content", this.viewportContent + ", height=" + this.oldHeight) } resetViewport() { this.viewport.setAttribute("content", this.viewportContent + ", height=" + this.windowHeight) } isScreenBigger() { return r.instance.width > this.getMaximumWidth() } getScreenWidth() { return this.isScreenBigger() ? this.getMaximumWidth() : r.instance.width } getMaximumWidth() { return r.MAXIMUM_WIDTH * this.dpr * this.gameScale.y } } r.MAXIMUM_WIDTH = 390, r.DEFAULT_DELAY = 100, r.IOS_DELAY = 500; var h = s(176), c = s(99), l = s(98), d = s(67), u = s(189), g = s(40), m = s(190), p = { characterFormat: { current: "9.1" }, TOSFormat: { current: "3.2" }, gameVersion: { current: "v1.9.5.0" } }; class b extends n { constructor() { super(), this.enabled = !1 } init() { var e; window.famobi_tracking && (e = p.gameVersion.current.replace("v", "").replaceAll(".", ""), window.famobi_tracking.init("love-tester-tiktok", null, e, !1, !1), this.enabled = !0) } trackCustomEvent(e, t) { this.enabled && window.famobi_tracking.trackEvent("event/custom", { category: e, name: t, value: 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : 1 }) } } class y extends n { constructor() { super(), this._userId = null, this._completed = !1, this._loginFailed = !1, this._loggedIn = !1, this.emitter = new Phaser.Events.EventEmitter, this.tt = void 0 !== window.tt ? window.tt : null, this.registerEventListeners() } isInTikTokEnv() { return !!this.tt } registerEventListeners() { this.isInTikTokEnv() && (this.tt.onShow(this.onShow.bind(this)), this.tt.onHide(this.onHide.bind(this)), this.tt.onShareRecordVideo(this.onShareRecordVideo.bind(this))) } onShow() { this.emitter.emit("onShow") } onHide() { this.emitter.emit("onHide") } onShareRecordVideo() { this.emitter.emit("onShareRecordVideo"); try { var e = O.instance.getData("totalVideosShared") || 0; e++, O.instance.setData({ totalVideosShared: e }) } catch (e) { console.error(e) } N.instance.performAction("shared_video"), b.instance.trackCustomEvent("TikTok", "video_shares"), A.instance.logCustomEvent("video_shared") } async login() { var e = await this.tt.login().catch(e => (console.error(e), this._loginFailed = !0, { data: {} })); return this.setUserId(e.data.id), e.data.id } async tiktokLogin() { } async devLogin() { var e = window.location.search; e = new URLSearchParams(e).get("id") || "testing"; await this.setUserId(e) } async setUserId(e) { e ? (this._userId = e, this._loggedIn = !!this.userId, this._completed = !0, O.instance.setData({ userId: this._userId }), this.emitter.emit("login", this._userId)) : console.warn("tiktok user id is null") } get userId() { return this._userId } get loginFailed() { return this._loginFailed } } const S = s(134); class _ extends n { constructor() { super(), this.active = !0, this.api = window.GameAnalytics || S.GameAnalytics, this.gameKey = "949c0efb773af10deb6b4c170f41f3a3", this.secretKey = "104836ca0e15164d825ba2151cdbe32726849752" } configureVersion() { var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : p.gameVersion.current; this.active && !this.isInitialised && (this.isInitialised = !0, e = x.instance.getVersionOrigin(e), this.api.configureBuild(e), this.api.configureAvailableResourceCurrencies(["gems", "gold"]), this.api.configureAvailableResourceItemTypes(["boost", "lives"]), this.api.configureAvailableCustomDimensions01(["ninja", "samurai"]), this.api.configureAvailableCustomDimensions02(["whale", "dolphin"]), this.api.configureAvailableCustomDimensions03(["horde", "alliance"])) } init() { var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : this.gameKey, t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : this.secretKey; this.active && (window.cordova ? this.api.initialize({ gameKey: e, secretKey: t }) : this.api.initialize(e, t), this.api.setEnabledInfoLog(!0)) } setUserID(e) { this.api.configureUserId(e) } trackBusiness(e, t, s, i, a) { this.active && (e = { currency: e, amount: t, itemType: s, itemId: i, cartType: a }, window.device ? this.api.addBusinessEvent(e) : this.api.addBusinessEvent(...Object.values(e))) } onInterstitialClick(e, t) { e = { adAction: this.api.EGAAdAction.Clicked, adType: this.api.EGAAdType.Interstitial, adSdkName: e, adPlacement: t }, this.addAdEvent(e) } onInterstitialSuccess(e, t) { e = { adAction: this.api.EGAAdAction.Show, adType: this.api.EGAAdType.Banner, adSdkName: e, adPlacement: t }, this.addAdEvent(e) } onInterstitialFail(e, t) { e = { adAction: this.api.EGAAdAction.FailedShow, adType: this.api.EGAAdType.Banner, adSdkName: e, adPlacement: t }, this.addAdEvent(e) } addAdEvent(e) { window.cordova ? this.api.addAdEvent(e, e => console.log("callback", e)) : this.api.addAdEvent(...Object.values(e)) } source(e, t, s, i) { e = { flowType: this.api.EGAResourceFlowType.Source, currency: e, amount: t, itemType: s, itemId: i }, window.device ? this.api.addResourceEvent(e) : this.api.addResourceEvent(...Object.values(e)) } sink(e, t, s, i) { e = { flowType: this.api.EGAResourceFlowType.Sink, currency: e, amount: t, itemType: s, itemId: i }, window.device ? this.api.addResourceEvent(e) : this.api.addResourceEvent(...Object.values(e)) } trackProgression(e, t) { this.active && (e = { progressStatus: e, progression01: t, progression02: 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : void 0, progression03: 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : void 0, custonFields: 4 < arguments.length && void 0 !== arguments[4] ? arguments[4] : void 0 }, window.device ? this.api.addProgressionEvent(e) : this.api.addProgressionEvent(...Object.values(e))) } trackError(e, t) { e = { severity: e, reason: t }, window.device ? this.api.addErrorEvent(e) : this.api.addErrorEvent(...Object.values(e)) } trackDesign(e, t) { e = { eventId: e, value: t }, window.device ? this.api.addDesignEvent(e, this.done.bind(this)) : this.api.addDesignEvent(...Object.values(e)) } done(e) { console.log("done", e) } toggleTracking(e) { this.api.setEnabledEventSubmission(e) } } class f extends n { constructor() { super(), this.provider = "AdMob", this.active = !1, this.debug = !1, this.eventEmitter = new Phaser.Events.EventEmitter, this.admob = window.admob, this.ids = { android: { interstitial: "ca-app-pub-8700401253704627/3573599024" }, android_test: { interstitial: "ca-app-pub-3940256099942544/1033173712" }, ios: { interstitial: "ca-app-pub-8700401253704627/3521666126" }, ios_test: { interstitial: "ca-app-pub-3940256099942544/4411468910" } }, (window.wk = this).id = null } async init(e) { this.setScene(e), this.showATT(), this.getId(), await this.setup() } async showATT() { if (window.device && "iOS" === window.device.platform) if (window.consent) { console.warn("[ATT] start"); var e = await window.consent.trackingAuthorizationStatus(); console.warn("[ATT] Current status is " + e); try { var t = await window.consent.requestTrackingAuthorization(); console.warn("[ATT] New status: " + t) } catch (e) { console.warn("[ATT] Error"), console.warn(e) } } else console.warn("Plugin consent is not installed"); else console.warn("Not an iOS device") } getId() { this.scene.sys.game.device.os.android ? (this.id = this.debug ? this.ids.android_test : this.ids.android, this.active = !0) : this.scene.sys.game.device.os.iOS ? (this.id = this.debug ? this.ids.ios_test : this.ids.ios, this.active = !0) : (console.warn("AdMobApi - unsupported", JSON.stringify(this.scene.sys.game.device.os)), this.active = !1) } setScene(e) { this.scene = e } async setup() { this.active && (await this.admob.start(), this.interstitial = new this.admob.InterstitialAd({ adUnitId: this.id.interstitial }), this.interstitial.on("load", e => { console.warn("AdMobApi - load", e), this.eventEmitter.emit("load") }), this.interstitial.on("loadfail", e => { console.warn("AdMobApi - load fail", e), this.eventEmitter.emit("loadfail") }), this.interstitial.on("show", e => { console.warn("AdMobApi - show", e), this.eventEmitter.emit("show"), x.instance.sendGAEvent(x.GA_EVENTS.INTERSTITIAL_SUCCESS, this.provider, this.id.interstitial) }), this.interstitial.on("showfail", e => { console.warn("AdMobApi - show fail", e), this.eventEmitter.emit("showfail"), x.instance.sendGAEvent(x.GA_EVENTS.INTERSTITIAL_FAIL, this.provider, this.id.interstitial) }), this.interstitial.on("dismiss", e => { console.warn("AdMobApi - dismiss", e), this.eventEmitter.emit("dismiss"), this.loadInterstitialAd() }), this.loadInterstitialAd()) } showInterstitialAd() { return console.warn("AdMobApi - showInterstitialAd"), this.active ? new Promise(async e => { try { this.onLoadFail(e), this.onShowFail(e), await this.loadInterstitialAd(), await this.interstitial.show(), await this.onDismiss(), e() } catch (t) { console.warn(t), e() } }) : null } onDismiss() { return new Promise(e => this.eventEmitter.once("dismiss", e)) } onLoadFail(e) { this.eventEmitter.once("loadfail", e) } onShowFail(e) { this.eventEmitter.once("showfail", e) } async loadInterstitialAd() { await this.interstitial.isLoaded() || await this.interstitial.load() } } class w { constructor() { this._key = "LOVE_TESTER:", this._supportedFeatures = ["initializeAsync", "setLoadingProgress", "startGameAsync", "getDataAsync", "setDataAsync", "TOS", "share", "credits", "version", "copyright", "logo"] } async init(e) { A.instance.login(), _.instance.configureVersion(), _.instance.init(), await f.instance.init(e) } getPlatformName() { try { return window.device.platform + " native" } catch (e) { return console.log(e), "Mobile" } } login() { } hasFeature(e) { return this._supportedFeatures.includes(e) } getSupportedAPIs() { return this._supportedAPIs } initializeAsync() { return new Promise(e => { e() }) } setLoadingProgress(e) { } startGameAsync() { return new Promise(e => { e() }) } getDataAsync(e) { if (A.instance.hasData()) return A.instance.getData(); var t = {}; for (let i = 0; i < e.length; i++) { var s = e[i]; let a = null; try { a = (a = window.localStorage.getItem(this._getKey(s))) && atob(a) } catch (e) { try { a = window.localStorage.getItem(this._getKey(s)) } catch (e) { } } try { a = JSON.parse(a) } catch (e) { } t[s] = a } return t } setDataAsync(e) { try { for (var [t, s] of Object.entries(e)) window.localStorage.setItem(this._getKey(t), btoa(JSON.stringify(s))) } catch (t) { try { for (var [i, a] of Object.entries(e)) window.localStorage.setItem(this._getKey(i), JSON.stringify(a)) } catch (t) { console.error(t) } } } _getKey(e) { return this._key + e } async showInterstitialAd() { return f.instance.showInterstitialAd() } async getRewardedVideoAsync() { } getLocale() { return navigator.languages && navigator.languages.length ? navigator.languages[0] : navigator.userLanguage || navigator.language || navigator.browserLanguage || "en-US" } sendGAEvent(e) { for (var t = arguments.length, s = new Array(1 < t ? t - 1 : 0), i = 1; i < t; i++)s[i - 1] = arguments[i]; switch (e) { case x.GA_EVENTS.PROGRESSION: _.instance.trackProgression(...s); break; case x.GA_EVENTS.DESIGN: _.instance.trackDesign(...s); break; case x.GA_EVENTS.INTERSTITIAL_SUCCESS: _.instance.onInterstitialSuccess(...s); break; case x.GA_EVENTS.INTERSTITIAL_FAIL: _.instance.onInterstitialFail(...s); break; default: console.warn(e + " is not implemented") } } onPauseRequested() { } onResumeRequested() { } gameReady() { } getBrandingButtonImage() { } levelStart() { } levelRestart() { } levelSuccess() { } levelFailed() { } levelQuit() { } levelEnd() { } liveScore() { } } const C = e => (Object.keys(e).forEach(t => { void 0 === e[t] && delete e[t] }), e); class v extends n { constructor() { super(), this.famobi = window.famobi, this.analytics = window.famobi_analytics, this.featureList = ["logoLink"], this.standAlone = this.famobi.hasFeature("standalone"), this.disabledFeatures = ["share", "logoLink", "downloadApp"] } getPlatformName() { return "Famobi" } init() { A.instance.login(), this.sendGAEvent(x.GA_EVENTS.VERSION) } hasFeature(e) { return (!this.standAlone || !this.featureList.includes(e)) && (!!this.featureList.includes(e) || this.famobi.hasFeature(e)) } getOrientation() { return this.famobi.getOrientation() || "portrait" } onOrientationChange(e, t) { this.famobi.onOrientationChange(e.bind(t)) } gameReady() { try { this.famobi.gameReady() } catch (e) { console.log(this.famobi) } } async levelStart(e) { await this.analytics.trackEvent("EVENT_LEVELSTART", { levelName: e }) } async levelRestart(e) { await this.analytics.trackEvent("EVENT_LEVELRESTART", { levelName: e }) } async levelSuccess(e, t) { var s = this.analytics.trackEvent("EVENT_LEVELSUCCESS", { levelName: e }), i = (e = this.analytics.trackEvent("EVENT_LEVELSCORE", { levelName: e, levelScore: t }), t = this.analytics.trackEvent("EVENT_TOTALSCORE", { totalScore: t }), this.famobi.showInterstitialAd()); await Promise.all([s, e, t, i]) } async levelFailed(e, t) { var s = this.analytics.trackEvent("EVENT_LEVELFAIL", { levelName: e, reason: "wrong_answer" }), i = (e = this.analytics.trackEvent("EVENT_LEVELSCORE", { levelName: e, levelScore: t }), t = this.analytics.trackEvent("EVENT_TOTALSCORE", { totalScore: t }), this.famobi.showInterstitialAd()); await Promise.all([s, e, t, i]) } async levelQuit(e) { e = window.famobi_analytics.trackEvent("EVENT_LEVELFAIL", { levelName: e, reason: "quit" }), await Promise.all([e]) } async levelEnd(e, t) { await this.analytics.trackEvent("EVENT_CUSTOM", { eventName: "LEVELEND", result: e, score: t }) } liveScore(e) { this.analytics.trackEvent("EVENT_LIVESCORE", { liveScore: e }) } async pause() { await this.analytics.trackEvent("EVENT_PAUSE") } async resume() { await this.analytics.trackEvent("EVENT_RESUME") } getBrandingButtonImage() { return this.famobi.getBrandingButtonImage(!0) } openBrandingLink() { this.famobi.openBrandingLink() } onPauseRequested(e, t) { window.famobi_onPauseRequested = e.bind(t) } onResumeRequested(e, t) { window.famobi_onResumeRequested = e.bind(t) } getDataAsync(e) { if (A.instance.hasData()) return A.instance.getData(); const t = {}; return e.forEach(e => { var s = this.famobi.localStorage.getItem(e); try { t[e] = JSON.parse(s) } catch (i) { t[e] = s } }), t } setDataAsync(e) { for (var [t, s] of Object.entries(e)) try { this.famobi.localStorage.setItem(t, JSON.stringify(s)) } catch (e) { } } getLocale() { return this.famobi.getCurrentLanguage() } async showInterstitialAd() { } sendGAEvent(e) { var t = {}; switch (e) { case x.GA_EVENTS.VERSION: console.log(x.instance.getVersionOrigin()); break; case x.GA_EVENTS.PROGRESSION: Object.assign(t, C({ eventName: "GA:Progression", progressionStatus: arguments.length <= 1 ? void 0 : arguments[1], progression01: arguments.length <= 2 ? void 0 : arguments[2], progression02: arguments.length <= 3 ? void 0 : arguments[3], progression03: arguments.length <= 4 ? void 0 : arguments[4], value: arguments.length <= 5 ? void 0 : arguments[5] })), window.famobi_analytics.trackEvent("EVENT_CUSTOM", t); break; case x.GA_EVENTS.DESIGN: Object.assign(t, C({ eventName: "GA:Design", eventId: arguments.length <= 1 ? void 0 : arguments[1], value: arguments.length <= 2 ? void 0 : arguments[2] })), window.famobi_analytics.trackEvent("EVENT_CUSTOM", t); break; default: this.famobi.log(e + " is not implemented") } } } class T { constructor() { this._key = "LOVE_TESTER:", this._supportedFeatures = ["initializeAsync", "setLoadingProgress", "startGameAsync", "getDataAsync", "setDataAsync", "downloadApp"] } getPlatformName() { return "TikTok" } init() { y.instance.login(), A.instance.login() } hasFeature(e) { return this._supportedFeatures.includes(e) } getSupportedAPIs() { return this._supportedAPIs } initializeAsync() { return new Promise(e => { e() }) } setLoadingProgress(e) { } startGameAsync() { return new Promise(e => { e() }) } getDataAsync(e) { if (A.instance.hasData()) return A.instance.getData(); var t = {}; for (let i = 0; i < e.length; i++) { var s = e[i]; let a = null; try { a = (a = window.localStorage.getItem(this._getKey(s))) && atob(a) } catch (e) { try { a = window.localStorage.getItem(this._getKey(s)) } catch (e) { } } try { a = JSON.parse(a) } catch (e) { } t[s] = a } return t } setDataAsync(e) { try { for (var [t, s] of Object.entries(e)) window.localStorage.setItem(this._getKey(t), btoa(JSON.stringify(s))) } catch (t) { try { for (var [i, a] of Object.entries(e)) window.localStorage.setItem(this._getKey(i), JSON.stringify(a)) } catch (t) { } } } _getKey(e) { return this._key + e } showInterstitialAd() { } showRewardedAd() { } getLocale() { return navigator.languages && navigator.languages.length ? navigator.languages[0] : navigator.userLanguage || navigator.language || navigator.browserLanguage || "en-US" } } class k { constructor() { this._key = "LOVE_TESTER:", this._supportedFeatures = ["initializeAsync", "setLoadingProgress", "startGameAsync", "getDataAsync", "setDataAsync", "downloadApp", "TOS", "share", "credits", "version", "copyright", "logo"] } getPlatformName() { return "Web" } init() { A.instance.login(), _.instance.configureVersion(), _.instance.init() } hasFeature(e) { return this._supportedFeatures.includes(e) } getSupportedAPIs() { return this._supportedAPIs } initializeAsync() { return new Promise(e => { e() }) } setLoadingProgress(e) { } startGameAsync() { return new Promise(e => { e() }) } onPauseRequested() { } onResumeRequested() { } gameReady() { } getBrandingButtonImage() { } levelStart() { } levelRestart() { } levelSuccess() { } levelFailed() { } levelQuit() { } levelEnd() { } liveScore() { } getDataAsync(e) { if (A.instance.hasData()) return A.instance.getData(); var t = {}; for (let i = 0; i < e.length; i++) { var s = e[i]; let a = null; try { a = (a = window.localStorage.getItem(this._getKey(s))) && atob(a) } catch (e) { try { a = window.localStorage.getItem(this._getKey(s)) } catch (e) { } } try { a = JSON.parse(a) } catch (e) { } t[s] = a } return t } setDataAsync(e) { try { for (var [t, s] of Object.entries(e)) window.localStorage.setItem(this._getKey(t), btoa(JSON.stringify(s))) } catch (t) { try { for (var [i, a] of Object.entries(e)) window.localStorage.setItem(this._getKey(i), JSON.stringify(a)) } catch (t) { } } } _getKey(e) { return this._key + e } showInterstitialAd() { } showRewardedAd() { } getLocale() { return navigator.languages && navigator.languages.length ? navigator.languages[0] : navigator.userLanguage || navigator.language || navigator.browserLanguage || "en-US" } sendGAEvent(e) { for (var t = arguments.length, s = new Array(1 < t ? t - 1 : 0), i = 1; i < t; i++)s[i - 1] = arguments[i]; switch (e) { case x.GA_EVENTS.PROGRESSION: _.instance.trackProgression(...s); break; case x.GA_EVENTS.DESIGN: _.instance.trackDesign(...s); break; case x.GA_EVENTS.INTERSTITIAL_SUCCESS: _.instance.onInterstitialSuccess(...s); break; case x.GA_EVENTS.INTERSTITIAL_FAIL: _.instance.onInterstitialFail(...s); break; default: console.warn(e + " is not implemented") } } } class x extends n { constructor() { super(), this._getAPI() } _getAPI() { switch (console.log("Platform = ", this.platform), this.platform) { case "cordova": return void (this._api = new w); case "web": return void (this._api = new k); case "famobi": return void (this._api = new v); case "tiktok": return void (this._api = new T); default: this._api = new k } } get platform() { return window.famobi ? "famobi" : window.cordova ? "cordova" : window.tt ? "tiktok" : "web" } getPlatformName() { return this._api.getPlatformName() } init() { return this._api.init(...arguments) } hasFeature(e) { return this._api.hasFeature(e) } initializeAsync() { return this._api.initializeAsync() } setLoadingProgress(e) { this._api.setLoadingProgress(e) } startGameAsync() { return this._api.startGameAsync() } getDataAsync(e) { return this._api.getDataAsync(e) } setDataAsync(e) { return this._api.setDataAsync(e) } showInterstitialAd() { return this._api.showInterstitialAd() } showRewardedAd() { return this._api.showRewardedAd() } getLocale() { return this._api.getLocale() } gameReady() { return this._api.gameReady() } levelStart() { return this._api.levelStart(...arguments) } levelRestart() { return this._api.levelRestart(...arguments) } levelSuccess() { return this._api.levelSuccess(...arguments) } levelFailed() { return this._api.levelFailed(...arguments) } levelEnd() { return this._api.levelEnd(...arguments) } liveScore() { this._api.liveScore(...arguments) } getBrandingButtonImage() { return this._api.getBrandingButtonImage() } sendGAEvent() { return this._api.sendGAEvent(...arguments) } getVersionOrigin() { return (0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : p.gameVersion.current) + " " + x.instance.getPlatformName() } onPauseRequested() { return this._api.onPauseRequested(...arguments) } onResumeRequested() { return this._api.onResumeRequested(...arguments) } openBrandingLink() { this._api.openBrandingLink() } } var D = { userId: "", mainCharacter: {}, secondaryCharacter: {}, acceptedTOS: !(x.GA_EVENTS = { VERSION: "Version", BUSINESS: "Business", RESOURCE: "Resource", PROGRESSION: "Progression", ERROR: "Error", DESIGN: "Design", INTERSTITIAL_SUCCESS: "InterstitialSuccess", INTERSTITIAL_FAIL: "InterstitialFail", INTERSTITIAL_CLICKED: "InterstitialClicked" }), version: { characterFormat: "0", TOSFormat: "0", gameVersion: "v0.0.1" }, characterSlots: [], action_history: [], name_history: { main_character: [], secondary_character: [] }, matchHistory: [], totalVideosShared: 0, completedTutorialSteps: [], skippedTutorial: !1, playthroughs: {}, sessions: [], localeData: { origin: null, userCountry: null, userRegion: null }, loadData: [], settings: { language: "", music: 1, sfx: 1 }, mainSceneOpened: 0, spinningWheelOpened: 0, scenarioOpened: 0, customCharactersA: [], customCharactersB: [] }; class O extends n { constructor() { super(), this.emitter = new Phaser.Events.EventEmitter, this._data = null, (window.sm = this).saveQueue = [], this.emitter.on("localUserDataLoaded", () => { this.resolveSaveQueue() }) } resolveSaveQueue() { this.saveQueue.forEach(e => { this.setData(e) }) } setData(e) { for (var [t, s] of (this.emitter.emit("setData", e), x.instance.setDataAsync(e), Object.entries(e))) { if (!this._data) return void this.saveQueue.push(e); this._data[t] = s } } getData(e) { if (this._data) return this._data[e] } getDatas(e) { return Array.isArray(e) || (e = [e]), x.instance.getDataAsync(e) } async loadData() { var e = await x.instance.getDataAsync(Object.keys(D)); return this._validateData(e), this._data = e, this._data.version.characterFormat !== p.characterFormat.current && (this._data.mainCharacter.options = {}, this._data.secondaryCharacter.options = {}), window.setTimeout(() => { this.emitter.emit("localUserDataLoaded", this._data) }, 1), this._data } _validateData(e) { let t = !0; for (const s of Object.keys(D)) null === e[s] || void 0 === e[s] || typeof e[s] != typeof D[s] ? (e[s] = D[s], x.instance.setDataAsync({ [s]: D[s] })) : t = !1; for (const t of Object.keys(e)); } updateVersion() { const e = this.getData("version"); e && (Object.keys(e).forEach(t => { var s = e[t], i = p[t].current; s !== i && (e[t] = i) }), this.setData({ version: e })) } } class A extends n { constructor() { super(), this.emitter = new Phaser.Events.EventEmitter, this.region = "europe-west3", this.failed = !1, this.completed = !1, this.loggedIn = !1, this.fetchedData = !1, this.app = null, this.database = null, this.functions = null, this.userDocument = null } initialize() { this.app = Object(h.a)({ apiKey: "AIzaSyCQfRqpcJlg99usg6zmkLo8nMt8YppJdcM", authDomain: "love-tester-tiktok.firebaseapp.com", projectId: "love-tester-tiktok", storageBucket: "love-tester-tiktok.appspot.com", messagingSenderId: "62199588960", appId: "1:62199588960:web:187e65a72284fe349afb05", measurementId: "G-CGWHT2WTQ2" }), this.analytics = Object(d.a)(this.app), this.performance = Object(u.a)(this.app), Object(d.c)(this.analytics, !0), this.functions = Object(c.a)(this.app), this.functions.region = this.region, this.initialiseCloud() } async initialiseCloud() { this.database = Object(g.c)(this.app) } getCustomToken() { return Object(c.b)(this.functions, "token")({ uid: window.userId }) } helloWorld() { return Object(c.b)(this.functions, "world")() } logCustomEvent(e) { var t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : void 0; Object(d.b)(this.analytics, e, t) } setUserProperty() { this.setUserProperty(this.analytics, 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {}) } logScreenView(e, t) { Object(d.b)(this.analytics, "screen_view", { firebase_screen: e, firebase_screen_class: t }) } logListView(e, t, s) { e = { item_list_id: e, item_list_name: t, items: s }, Object(d.b)(this.analytics, "view_item_list", e) } logItemSelect(e, t, s) { e = { item_list_id: e, item_list_name: t, selected_item: s }, Object(d.b)(this.analytics, "select_item", e) } getUserID() { return window.tt ? (console.log("tt login"), y.instance.userId) : window.device ? (console.log("device login"), window.device.uuid) : this.generateUUID() } getSavedUUID() { var e = O.instance.getData("userId"); return this.savedUUID = e } generateUUID() { var e = Object(m.b)(); return O.instance.setData({ userId: e }), e } async login() { var e, t = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : this.getUserID(); (window.userId = t) ? (console.warn("userId found:", t), t = this.token = null, e = await this.getCustomToken().catch(e => (console.warn(e), { data: {} })), this.token = e.data.uid, this.token ? (e = window.cordova ? Object(l.b)(this.app) : Object(l.a)(), t = await Object(l.c)(e, this.token).catch(e => (this.onError(e), {})), this.loggedIn = !!t && !!t.user, this.fetchUserData(), A.instance.emitter.emit("firebase:loggedIn")) : this.onError("No token found")) : this.onError("No user id is found.") } async fetchUserData() { if (this.userData = Object(g.a)(this.database, "users", "" + window.userId), this.userDocument = await Object(g.b)(this.userData).catch(e => { this.onError(e) }), this.userDocument) { if (this.userDocument.exists()) this.data = this.userDocument.data(); else { if (!await Object(g.d)(this.userData, {}).then(() => !0).catch(e => (console.warn(e), !1))) return void this.onError("Unable to create user document."); this.data = {} } this.fetchedData = !!this.data, this.subscribeListeners(), this.sendCompletedEvent(), O.instance.setData({ action_history: D.action_history }) } else this.onError("Unable to fetch user document") } onError(e) { e && console.error(e), this.failed = !0, this.sendCompletedEvent() } async sendCompletedEvent() { this.completed = !0, this.emitter.emit("firebaseCompleted") } subscribeListeners() { O.instance.emitter.on("setData", this.onSetData, this) } onSetData(e) { Object(g.d)(this.userData, e, { merge: !0 }) } onFetchedData() { return new Promise(e => { this.completed ? e() : this.emitter.once("firebaseCompleted", () => { e(), console.warn("on fetch complete") }) }) } delay(e) { return new Promise(t => setTimeout(t, e)) } hasData() { return !!this.data } getData() { return this.data } getLinkUuid() { return Object(m.b)() } async setLinkData(e, t) { var s = Object(g.a)(this.database, "links", "" + e); await Object(g.d)(s, { link: e, danceA: t.danceA, danceB: t.danceB, text: t.text, scenario: t.scenario, mainCharacterName: t.nameA, secondaryCharacterName: t.nameB, mainCharacterOptions: t.optionsA, secondaryCharacterOptions: t.optionsB, user: window.userId }).then(() => !0).catch(e => (console.warn(e), !1)) || console.warn("Unable to create Link data") } async fetchLinkData(e) { e = Object(g.a)(this.database, "links", "" + e), e = (await Object(g.b)(e).catch(e => { this.onError(e) })).data(); var t = {}; return t.danceA = e.danceA, t.danceB = e.danceB, t.text = e.text, t.scenario = e.scenario, t.mainCharacterName = e.mainCharacterName, t.secondaryCharacterName = e.secondaryCharacterName, t.mainCharacterOptions = e.mainCharacterOptions, t.secondaryCharacterOptions = e.secondaryCharacterOptions, t } } const I = { Andorra: "Andorra", Dubai: "United Arab Emirates", Kabul: "Afghanistan", Tirane: "Albania", Yerevan: "Armenia", Casey: "Antarctica", Davis: "Antarctica", Mawson: "Antarctica", Palmer: "Antarctica", Rothera: "Antarctica", Troll: "Antarctica", Vostok: "Antarctica", Buenos_Aires: "Argentina", Cordoba: "Argentina", Salta: "Argentina", Jujuy: "Argentina", Tucuman: "Argentina", Catamarca: "Argentina", La_Rioja: "Argentina", San_Juan: "Argentina", Mendoza: "Argentina", San_Luis: "Argentina", Rio_Gallegos: "Argentina", Ushuaia: "Argentina", Pago_Pago: "Samoa (American)", Vienna: "Austria", Lord_Howe: "Australia", Macquarie: "Australia", Hobart: "Australia", Melbourne: "Australia", Sydney: "Australia", Broken_Hill: "Australia", Brisbane: "Australia", Lindeman: "Australia", Adelaide: "Australia", Darwin: "Australia", Perth: "Australia", Eucla: "Australia", Baku: "Azerbaijan", Barbados: "Barbados", Dhaka: "Bangladesh", Brussels: "Belgium", Sofia: "Bulgaria", Bermuda: "Bermuda", Brunei: "Brunei", La_Paz: "Bolivia", Noronha: "Brazil", Belem: "Brazil", Fortaleza: "Brazil", Recife: "Brazil", Araguaina: "Brazil", Maceio: "Brazil", Bahia: "Brazil", Sao_Paulo: "Brazil", Campo_Grande: "Brazil", Cuiaba: "Brazil", Santarem: "Brazil", Porto_Velho: "Brazil", Boa_Vista: "Brazil", Manaus: "Brazil", Eirunepe: "Brazil", Rio_Branco: "Brazil", Thimphu: "Bhutan", Minsk: "Belarus", Belize: "Belize", St_Johns: "Canada", Halifax: "Canada", Glace_Bay: "Canada", Moncton: "Canada", Goose_Bay: "Canada", Toronto: "Canada", Nipigon: "Canada", Thunder_Bay: "Canada", Iqaluit: "Canada", Pangnirtung: "Canada", Winnipeg: "Canada", Rainy_River: "Canada", Resolute: "Canada", Rankin_Inlet: "Canada", Regina: "Canada", Swift_Current: "Canada", Edmonton: "Canada", Cambridge_Bay: "Canada", Yellowknife: "Canada", Inuvik: "Canada", Dawson_Creek: "Canada", Fort_Nelson: "Canada", Whitehorse: "Canada", Dawson: "Canada", Vancouver: "Canada", Cocos: "Cocos (Keeling) Islands", Zurich: "Switzerland", Abidjan: "Côte d Ivoire", Rarotonga: "Cook Islands", Santiago: "Chile", Punta_Arenas: "Chile", Easter: "Chile", Shanghai: "China", Urumqi: "China", Bogota: "Colombia", Costa_Rica: "Costa Rica", Havana: "Cuba", Cape_Verde: "Cape Verde", Christmas: "Christmas Island", Nicosia: "Cyprus", Famagusta: "Cyprus", Prague: "Czech Republic", Berlin: "Germany", Copenhagen: "Denmark", Santo_Domingo: "Dominican Republic", Algiers: "Algeria", Guayaquil: "Ecuador", Galapagos: "Ecuador", Tallinn: "Estonia", Cairo: "Egypt", El_Aaiun: "Western Sahara", Madrid: "Spain", Ceuta: "Spain", Canary: "Spain", Helsinki: "Finland", Fiji: "Fiji", Stanley: "Falkland Islands", Chuuk: "Micronesia", Pohnpei: "Micronesia", Kosrae: "Micronesia", Faroe: "Faroe Islands", Paris: "France", London: "Britain (UK)", Tbilisi: "Georgia", Cayenne: "French Guiana", Gibraltar: "Gibraltar", Nuuk: "Greenland", Danmarkshavn: "Greenland", Scoresbysund: "Greenland", Thule: "Greenland", Athens: "Greece", South_Georgia: "South Georgia & the South Sandwich Islands", Guatemala: "Guatemala", Guam: "Guam", Bissau: "Guinea-Bissau", Guyana: "Guyana", Hong_Kong: "Hong Kong", Tegucigalpa: "Honduras", "Port-au-Prince": "Haiti", Budapest: "Hungary", Jakarta: "Indonesia", Pontianak: "Indonesia", Makassar: "Indonesia", Jayapura: "Indonesia", Dublin: "Ireland", Jerusalem: "Israel", Kolkata: "India", Chagos: "British Indian Ocean Territory", Baghdad: "Iraq", Tehran: "Iran", Reykjavik: "Iceland", Rome: "Italy", Jamaica: "Jamaica", Amman: "Jordan", Tokyo: "Japan", Nairobi: "Kenya", Bishkek: "Kyrgyzstan", Tarawa: "Kiribati", Kanton: "Kiribati", Kiritimati: "Kiribati", Pyongyang: "Korea (North)", Seoul: "Korea (South)", Almaty: "Kazakhstan", Qyzylorda: "Kazakhstan", Qostanay: "Kazakhstan", Aqtobe: "Kazakhstan", Aqtau: "Kazakhstan", Atyrau: "Kazakhstan", Oral: "Kazakhstan", Beirut: "Lebanon", Colombo: "Sri Lanka", Monrovia: "Liberia", Vilnius: "Lithuania", Luxembourg: "Luxembourg", Riga: "Latvia", Tripoli: "Libya", Casablanca: "Morocco", Monaco: "Monaco", Chisinau: "Moldova", Majuro: "Marshall Islands", Kwajalein: "Marshall Islands", Yangon: "Myanmar (Burma)", Ulaanbaatar: "Mongolia", Hovd: "Mongolia", Choibalsan: "Mongolia", Macau: "Macau", Martinique: "Martinique", Malta: "Malta", Mauritius: "Mauritius", Maldives: "Maldives", Mexico_City: "Mexico", Cancun: "Mexico", Merida: "Mexico", Monterrey: "Mexico", Matamoros: "Mexico", Mazatlan: "Mexico", Chihuahua: "Mexico", Ojinaga: "Mexico", Hermosillo: "Mexico", Tijuana: "Mexico", Bahia_Banderas: "Mexico", Kuala_Lumpur: "Malaysia", Kuching: "Malaysia", Maputo: "Mozambique", Windhoek: "Namibia", Noumea: "New Caledonia", Norfolk: "Norfolk Island", Lagos: "Nigeria", Managua: "Nicaragua", Amsterdam: "Netherlands", Oslo: "Norway", Kathmandu: "Nepal", Nauru: "Nauru", Niue: "Niue", Auckland: "New Zealand", Chatham: "New Zealand", Panama: "Panama", Lima: "Peru", Tahiti: "French Polynesia", Marquesas: "French Polynesia", Gambier: "French Polynesia", Port_Moresby: "Papua New Guinea", Bougainville: "Papua New Guinea", Manila: "Philippines", Karachi: "Pakistan", Warsaw: "Poland", Miquelon: "St Pierre & Miquelon", Pitcairn: "Pitcairn", Puerto_Rico: "Puerto Rico", Gaza: "Palestine", Hebron: "Palestine", Lisbon: "Portugal", Madeira: "Portugal", Azores: "Portugal", Palau: "Palau", Asuncion: "Paraguay", Qatar: "Qatar", Reunion: "Réunion", Bucharest: "Romania", Belgrade: "Serbia", Kaliningrad: "Russia", Moscow: "Russia", Simferopol: "Russia", Kirov: "Russia", Volgograd: "Russia", Astrakhan: "Russia", Saratov: "Russia", Ulyanovsk: "Russia", Samara: "Russia", Yekaterinburg: "Russia", Omsk: "Russia", Novosibirsk: "Russia", Barnaul: "Russia", Tomsk: "Russia", Novokuznetsk: "Russia", Krasnoyarsk: "Russia", Irkutsk: "Russia", Chita: "Russia", Yakutsk: "Russia", Khandyga: "Russia", Vladivostok: "Russia", "Ust-Nera": "Russia", Magadan: "Russia", Sakhalin: "Russia", Srednekolymsk: "Russia", Kamchatka: "Russia", Anadyr: "Russia", Riyadh: "Saudi Arabia", Guadalcanal: "Solomon Islands", Mahe: "Seychelles", Khartoum: "Sudan", Stockholm: "Sweden", Singapore: "Singapore", Paramaribo: "Suriname", Juba: "South Sudan", Sao_Tome: "Sao Tome & Principe", El_Salvador: "El Salvador", Damascus: "Syria", Grand_Turk: "Turks & Caicos Is", Ndjamena: "Chad", Kerguelen: "French Southern & Antarctic Lands", Bangkok: "Thailand", Dushanbe: "Tajikistan", Fakaofo: "Tokelau", Dili: "East Timor", Ashgabat: "Turkmenistan", Tunis: "Tunisia", Tongatapu: "Tonga", Istanbul: "Turkey", Funafuti: "Tuvalu", Taipei: "Taiwan", Kiev: "Ukraine", Uzhgorod: "Ukraine", Zaporozhye: "Ukraine", Wake: "US minor outlying islands", New_York: "United States", Detroit: "United States", Louisville: "United States", Monticello: "United States", Indianapolis: "United States", Vincennes: "United States", Winamac: "United States", Marengo: "United States", Petersburg: "United States", Vevay: "United States", Chicago: "United States", Tell_City: "United States", Knox: "United States", Menominee: "United States", Center: "United States", New_Salem: "United States", Beulah: "United States", Denver: "United States", Boise: "United States", Phoenix: "United States", Los_Angeles: "United States", Anchorage: "United States", Juneau: "United States", Sitka: "United States", Metlakatla: "United States", Yakutat: "United States", Nome: "United States", Adak: "United States", Honolulu: "United States", Montevideo: "Uruguay", Samarkand: "Uzbekistan", Tashkent: "Uzbekistan", Caracas: "Venezuela", Ho_Chi_Minh: "Vietnam", Efate: "Vanuatu", Wallis: "Wallis & Futuna", Apia: "Samoa (western)", Johannesburg: "South Africa", Antigua: "Antigua & Barbuda", Anguilla: "Anguilla", Luanda: "Angola", McMurdo: "Antarctica", DumontDUrville: "Antarctica", Syowa: "Antarctica", Aruba: "Aruba", Mariehamn: "Åland Islands", Sarajevo: "Bosnia & Herzegovina", Ouagadougou: "Burkina Faso", Bahrain: "Bahrain", Bujumbura: "Burundi", "Porto-Novo": "Benin", St_Barthelemy: "St Barthelemy", Kralendijk: "Caribbean NL", Nassau: "Bahamas", Gaborone: "Botswana", "Blanc-Sablon": "Canada", Atikokan: "Canada", Creston: "Canada", Kinshasa: "Congo (Dem. Rep.)", Lubumbashi: "Congo (Dem. Rep.)", Bangui: "Central African Rep.", Brazzaville: "Congo (Rep.)", Douala: "Cameroon", Curacao: "Curaçao", Busingen: "Germany", Djibouti: "Djibouti", Dominica: "Dominica", Asmara: "Eritrea", Addis_Ababa: "Ethiopia", Libreville: "Gabon", Grenada: "Grenada", Guernsey: "Guernsey", Accra: "Ghana", Banjul: "Gambia", Conakry: "Guinea", Guadeloupe: "Guadeloupe", Malabo: "Equatorial Guinea", Zagreb: "Croatia", Isle_of_Man: "Isle of Man", Jersey: "Jersey", Phnom_Penh: "Cambodia", Comoro: "Comoros", St_Kitts: "St Kitts & Nevis", Kuwait: "Kuwait", Cayman: "Cayman Islands", Vientiane: "Laos", St_Lucia: "St Lucia", Vaduz: "Liechtenstein", Maseru: "Lesotho", Podgorica: "Montenegro", Marigot: "St Martin (French)", Antananarivo: "Madagascar", Skopje: "North Macedonia", Bamako: "Mali", Saipan: "Northern Mariana Islands", Nouakchott: "Mauritania", Montserrat: "Montserrat", Blantyre: "Malawi", Niamey: "Niger", Muscat: "Oman", Kigali: "Rwanda", St_Helena: "St Helena", Ljubljana: "Slovenia", Longyearbyen: "Svalbard & Jan Mayen", Bratislava: "Slovakia", Freetown: "Sierra Leone", San_Marino: "San Marino", Dakar: "Senegal", Mogadishu: "Somalia", Lower_Princes: "St Maarten (Dutch)", Mbabane: "Eswatini (Swaziland)", Lome: "Togo", Port_of_Spain: "Trinidad & Tobago", Dar_es_Salaam: "Tanzania", Kampala: "Uganda", Midway: "US minor outlying islands", Vatican: "Vatican City", St_Vincent: "St Vincent", Tortola: "Virgin Islands (UK)", St_Thomas: "Virgin Islands (US)", Aden: "Yemen", Mayotte: "Mayotte", Lusaka: "Zambia", Harare: "Zimbabwe" }; class N extends n { constructor() { super(), this.history = {}, this.actions = {}, this.preloadStart = 0, this.recentTimeStamp = 0, this.AM = b.instance, this.countTrackingKey = "user_activity_count", this.durationTrackingKey = "user_activity_duration", this.firstInteractionKey = "user_activity_first_interaction", this.assetLoadCountKey = "asset_load_count", this.assetLoadDurationKey = "asset_load_duration", this.playthroughs = [], this.createSession() } getTime() { return Number(String(Date.now()).slice(-7)) } createSession() { this.sessionID = this.formatJsDateToNormalDateTime(void 0, -1) } logSession() { let e = O.instance.getData("sessions"); (e = e || []).push(this.sessionID), O.instance.setData({ sessions: e }) } updatePlaythrough(e) { this.currentPlayThrough[e] = !0, this.currentPlayThrough.timeEnd = this.getTime(), this.logPlaythrough() } logPlaythrough() { let e = O.instance.getData("playthroughs"); (e = e || {})[this.sessionID] = this.playthroughs; try { O.instance.setData({ playthroughs: e }) } catch (e) { console.error("something went wrong updating playthrough", e) } } createNewPlaythrough() { this.currentPlayThrough = { sessionID: this.sessionID, timeStart: this.getTime(), timeEnd: this.getTime(), enterName1: !1, editCharacter1: !1, enterName2: !1, editCharacter2: !1, swap: !1, startGame: !1, backToHome: !1 }, this.playthroughs.push(this.currentPlayThrough) } addToHistory(e) { try { var t = this.formatJsDateToNormalDateTime(); this.history[t] = e, this.getHistory(), this.uploadHistory() } catch (e) { console.warn("something went wrong trying to upload history") } } checkHistoryKey(e, t) { return this.history[e] ? this.formatJsDateToNormalDateTime(void 0, t + 1) : e } formatJsDateToNormalDateTime() { var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : new Date, t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : 0, s = (s = e.getMonth() + 1) < 10 ? "0" + s : String(s), i = e.getDate() < 10 ? "0" + e.getDate() : String(e.getDate()), a = 0 <= t ? e.toTimeString().slice(0, 9) + t : e.toTimeString().slice(0, 8); let n = e = [e.getFullYear(), s, i, a].join(":"); return 0 <= t ? this.checkHistoryKey(e, t) : n } getHistory() { return this.history } uploadHistory() { O.instance && O.instance.setData({ action_history: this.history }) } uploadNames(e, t) { if (O.instance) { let s = O.instance.getData("name_history"); (s = s && s.main_character ? s : this.setDefaultNameHistory())[t].push(e), 10 < s[t].length && s[t].shift(), O.instance.setData({ name_history: s }) } } setDefaultNameHistory() { return { main_character: [], secondary_character: [] } } trackLoading() { this.preloadStart = this.getTimeStamp() } trackGame() { this.startTimeStamp = this.getTimeStamp(), this.recentTimeStamp = this.getTimeStamp() } getDurationSincePrevious() { var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : this.recentTimeStamp, t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : this.getTimeStamp(); e = Phaser.Math.RoundTo(t - e, 0); return this.recentTimeStamp = t, e } getDurationFromStart() { var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : this.startTimeStamp, t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : this.getTimeStamp(); return Phaser.Math.RoundTo(t - e, 0) } getTimeStamp() { return Phaser.Math.RoundTo(window.performance.now(), 0) } hasPerformedAction(e) { return !!Object.values(this.history).find(t => t.key === e) } loadAction() { var e, t, s = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "load"; this.hasPerformedAction(s) || (e = this.getDurationSincePrevious(this.preloadStart), this.AM.trackCustomEvent(this.countTrackingKey, "load_count", 1), this.AM.trackCustomEvent(this.durationTrackingKey, "load_duration", e), A.instance.logCustomEvent("load_duration", { value: e / 1e3 }), (t = this.getUserRegionAndCountry()).origin = this.getOrigin(), s = { key: s, duration: e, value: t }, this.saveLocaleData(t), this.saveLoadData(e), this.addToHistory(s)) } saveLocaleData(e) { if (e) { e.origin || (e.origin = "unknown"), e.userCountry || (e.origin = "unknown"), e.userRegion || (e.origin = "unknown"); try { O.instance.setData({ localeData: e }) } catch (e) { console.error(e) } } } saveLoadData(e) { this.loadData = { sessionID: this.sessionID, duration: e }, O.instance.getData("loadData") || (this.queuLoadUpload = !0) } uploadQueuedData() { if (this.queuLoadUpload = !1, this.loadData) { let e = O.instance.getData("loadData"); (e = e || []).push(this.loadData), O.instance.setData({ loadData: e }) } } getUserRegionAndCountry() { var e = (t = Intl.DateTimeFormat().resolvedOptions().timeZone.split("/"))[0], t = t[t.length - 1]; return { userRegion: e, userCountry: I[t] } } getOrigin() { return y.instance.tt ? "TikTok" : window.device ? window.device.platform : "Website" } setLoadData(e) { e.forEach(e => { var t = e.duration, s = { key: e = e.item, duration: t }; this.hasPerformedAction(e) || (this.AM.trackCustomEvent(this.assetLoadCountKey, e + "_count", 1), this.AM.trackCustomEvent(this.assetLoadDurationKey, e + "_duration", t)), this.addToHistory(s) }) } checkFirstInteraction() { var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "first_interaction", t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : this.recentTimeStamp; return !this.hasPerformedAction(e) && (t = this.getDurationSincePrevious(t), this.AM.trackCustomEvent(this.countTrackingKey, e + "_count", 1), this.AM.trackCustomEvent(this.durationTrackingKey, e + "_duration", t), this.addToHistory({ key: e, duration: t }), !0) } performAction(e) { var t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {}, s = 2 < arguments.length && void 0 !== arguments[2] && arguments[2], i = this.recentTimeStamp, a = this.getDurationSincePrevious(3 < arguments.length ? arguments[3] : void 0); t = { key: e, duration: a, value: t }; this.hasPerformedAction(e) || (this.AM.trackCustomEvent(this.countTrackingKey, e + "_count", 1), this.AM.trackCustomEvent(this.durationTrackingKey, e + "_duration", a)), s && this.checkFirstInteraction(void 0, i) && this.AM.trackCustomEvent(this.firstInteractionKey, e + "_count", 1), this.addToHistory(t) } } const E = { background_top: { hash: "#bcffb7", hex: "0xbcffb7" }, background_bot: { hash: "#58c8ec", hex: "0x58c8ec" }, category_main_bar: { hash: "#E63B79", hex: "0xE63B79" }, category_main_selected: { hash: "#FFFFFF", hex: "0xFFFFFF" }, category_sub_bar: { hash: "#FFFFFF", hex: "0xffffff" }, category_sub_selected: { hash: "#1765C1", hex: "0x1765C1" }, category_window: { hash: "#A7D6EA", hex: "0xA7D6EA" }, category_item_frame: { hash: "#C7EAFA", hex: "0xC7EAFA" }, category_item_selected: { hash: "#52A1FF", hex: "0x52A1FF" }, category_item_none: { hash: "#97CEE8", hex: "0x97CEE8" }, TOS_window: { hash: "#f8cf68", hex: "0xf8cf68" }, slider: { hash: "#E63B79", hex: "0xE63B79" }, slider_bar: { hash: "#A7D6EA", hex: "0xA7D6EA" }, slider_secmented: { hash: "#e8d897", hex: 15259799 }, main_bar_icon: { hash: "#FFFFFF", hex: "0xFFFFFF" }, main_bar_icon_selected: { hash: "#E63B79", hex: "0xE63B79" }, secondary_bar_icon: { hash: "#E63B79", hex: "0xE63B79" }, secondary_bar_icon_selected: { hash: "#FFFFFF", hex: "0xFFFFFF" }, character_slot_save_icon: { hash: "#E63B79", hex: "0xE63B79" }, character_slot_remove_icon: { hash: "#E63B79", hex: "0xE63B79" }, character_slot_name: { hash: "#E63B79", hex: "0xE63B79" }, character_slot_name_background: { hash: "#FFFFFF", hex: "0xFFFFFF" }, character_slot_background_top: { hash: "#C6F9D6", hex: "0xC6F9D6" }, character_slot_background_bot: { hash: "#87D9FE", hex: "0x87D9FE" }, character_SLOT_CUSTOM_background_top: { hash: "#FFD8E6", hex: "0xFFD8E6" }, character_SLOT_CUSTOM_background_bot: { hash: "#FFA9C8", hex: "0xFFA9C8" }, character_slot_background_light_top: { hash: "#defaee", hex: "0xdefaee" }, character_slot_background_light_bot: { hash: "#b3effc", hex: "0xb3effc" }, character_slot_background_dark_top: { hash: "#6aad7f", hex: "0x6aad7f" }, character_slot_background_dark_bot: { hash: "#37708a", hex: "0x37708a" }, overlay_black: { hash: "#000000", hex: "0x000000" }, option_grey_dark: { hash: "#444444", hex: "0x444444" }, option_grey_normal: { hash: "#999999", hex: "0x999999" }, option_grey_light: { hash: "#fefefe", hex: "0xfefefe" }, splash_loading_background: { hash: "#ffffff", hex: "0xffffff" }, splash_loading_text: { hash: "#000000", hex: "0x000000" }, splash_loading_percentage: { hash: "#999999", hex: "0x999999" }, scenario_loading_background: { hash: "#000000", hex: "0x000000" }, scenario_loading_text: { hash: "#ffffff", hex: "0xffffff" }, scenario_loading_percentage: { hash: "#999999", hex: "0x999999" }, white: { hash: "#ffffff", hex: "0xffffff" }, black: { hash: "#000000", hex: "0x000000" }, scenario_wheel_arrow: { hash: "#FFFF00", hex: "0xFFFF00" }, button_color_red: { hash: "#f15e4a", hex: "0xf15e4a" }, button_color_blue: { hash: "#3b83f0", hex: "0x3b83f0" }, button_pink_default: { hash: "#E63B79", hex: "0xE63B79", r: 82, g: 149, b: 198 }, button_pink_pressed: { hash: "#00948B", hex: "0x00948B", r: 12, g: 70, b: 112 }, button_blue_default: { hash: "#5195C6", hex: "0x5195C6", r: 82, g: 149, b: 198 }, button_blue_pressed: { hash: "#0C4670", hex: "0x0C4670", r: 12, g: 70, b: 112 }, button_fade_pressed: { hash: "", hex: "", r: 0, g: 0, b: 0 }, button_confirmed_default: { hash: "#e63b7a", hex: "0xe63b7a", r: 230, g: 59, b: 122 }, button_confirmed_pressed: { hash: "#b40948", hex: "0xb40948", r: 180, g: 9, b: 72 }, button_green: { hash: "#00B68A", hex: "0x00B68A", r: 0, g: 182, b: 138 }, input_field_main: { hash: "#ffffff", hex: "0xffffff" }, input_field_main_disabled: { hash: "#aaaaaa", hex: "0xaaaaaa" }, input_field_main_text: { hash: "#e63b7a", hex: "0xe63b7a" }, input_field_sub: { hash: "#1765C1", hex: "0x1765C1" }, input_field_sub_disabled: { hash: "#0c386d", hex: "0x0c386d" }, input_field_sub_text: { hash: "#ffffff", hex: "0xffffff" }, tutorial_highlight: { hash: "#0xff0066", hex: "0xff0066" }, color_picker_background: { hash: "#A7D6EA", hex: "0xA7D6EA" }, button_rewatch: { hash: "#E63B79", hex: "0xE63B79" }, button_text_background: { hash: "#3694D5", hex: "0x3694D5" }, character_select_back_inactive: { hash: "#555555", hex: "0x555555" }, character_select_back_active: { hash: "#FFFFFF", hex: "0xFFFFFF" }, character_select_title: { hash: "#880131", hex: "0x880131" }, download: { hash: "#024482", hex: "0x024482" }, dialog_funny: { hash: "#024482", hex: "0x024482" }, heart_outline_positive: { hash: "#A11043", hex: "0xA11043" }, heart_outline_negative: { hash: "#105BA1", hex: "0x105BA1" } }, P = { skinColors: [Phaser.Display.Color.HexStringToColor("0xffd6bb"), Phaser.Display.Color.HexStringToColor("0xffcfa7"), Phaser.Display.Color.HexStringToColor("0xfcb885"), Phaser.Display.Color.HexStringToColor("0xe1996b"), Phaser.Display.Color.HexStringToColor("0xca8b65"), Phaser.Display.Color.HexStringToColor("0xb37e64"), Phaser.Display.Color.HexStringToColor("0x916451"), Phaser.Display.Color.HexStringToColor("0x68483d"), Phaser.Display.Color.HexStringToColor("0xfbd52a"), Phaser.Display.Color.HexStringToColor("0x68ff86"), Phaser.Display.Color.HexStringToColor("0x05e31f"), Phaser.Display.Color.HexStringToColor("0x41cfff"), Phaser.Display.Color.HexStringToColor("0x9226ca"), Phaser.Display.Color.HexStringToColor("0xc779ff"), Phaser.Display.Color.HexStringToColor("0xff0066")], eyeColors: [Phaser.Display.Color.HexStringToColor("0x1a1616"), Phaser.Display.Color.HexStringToColor("0x868686"), Phaser.Display.Color.HexStringToColor("0x89522f"), Phaser.Display.Color.HexStringToColor("0x861d00"), Phaser.Display.Color.HexStringToColor("0xc71300"), Phaser.Display.Color.HexStringToColor("0xff5f0c"), Phaser.Display.Color.HexStringToColor("0xfbd52a"), Phaser.Display.Color.HexStringToColor("0x05e31f"), Phaser.Display.Color.HexStringToColor("0x00800f"), Phaser.Display.Color.HexStringToColor("0x68ff86"), Phaser.Display.Color.HexStringToColor("0x41cfff"), Phaser.Display.Color.HexStringToColor("0x2291e7"), Phaser.Display.Color.HexStringToColor("0x0029d7"), Phaser.Display.Color.HexStringToColor("0x5d00ba"), Phaser.Display.Color.HexStringToColor("0xc779ff"), Phaser.Display.Color.HexStringToColor("0xff0066"), Phaser.Display.Color.HexStringToColor("0xf8f3eb")], mouthColors: [Phaser.Display.Color.HexStringToColor("0x1a1616"), Phaser.Display.Color.HexStringToColor("0x861d00"), Phaser.Display.Color.HexStringToColor("0xc71300"), Phaser.Display.Color.HexStringToColor("0xff0000"), Phaser.Display.Color.HexStringToColor("0xff4200"), Phaser.Display.Color.HexStringToColor("0xfb8e37"), Phaser.Display.Color.HexStringToColor("0xfbd52a"), Phaser.Display.Color.HexStringToColor("0xa8f954"), Phaser.Display.Color.HexStringToColor("0x3aff89"), Phaser.Display.Color.HexStringToColor("0x78fdfc"), Phaser.Display.Color.HexStringToColor("0xc2c3f9"), Phaser.Display.Color.HexStringToColor("0xc779ff"), Phaser.Display.Color.HexStringToColor("0xe937da"), Phaser.Display.Color.HexStringToColor("0xff0066"), Phaser.Display.Color.HexStringToColor("0xff6f93")], hairColors: [Phaser.Display.Color.HexStringToColor("0x1a1616"), Phaser.Display.Color.HexStringToColor("0x444444"), Phaser.Display.Color.HexStringToColor("0x72718e"), Phaser.Display.Color.HexStringToColor("0x423232"), Phaser.Display.Color.HexStringToColor("0x633e26"), Phaser.Display.Color.HexStringToColor("0x886047"), Phaser.Display.Color.HexStringToColor("0xba805c"), Phaser.Display.Color.HexStringToColor("0xe1caa7"), Phaser.Display.Color.HexStringToColor("0xbd5435"), Phaser.Display.Color.HexStringToColor("0x862205"), Phaser.Display.Color.HexStringToColor("0xc71300"), Phaser.Display.Color.HexStringToColor("0xff002f"), Phaser.Display.Color.HexStringToColor("0xeb582c"), Phaser.Display.Color.HexStringToColor("0xf3af1d"), Phaser.Display.Color.HexStringToColor("0xffd015"), Phaser.Display.Color.HexStringToColor("0xf8e18f"), Phaser.Display.Color.HexStringToColor("0x59e269"), Phaser.Display.Color.HexStringToColor("0x129c23"), Phaser.Display.Color.HexStringToColor("0x59e29d"), Phaser.Display.Color.HexStringToColor("0x59d5e2"), Phaser.Display.Color.HexStringToColor("0x4585f0"), Phaser.Display.Color.HexStringToColor("0x1541ff"), Phaser.Display.Color.HexStringToColor("0xb037e9"), Phaser.Display.Color.HexStringToColor("0x7e25d1"), Phaser.Display.Color.HexStringToColor("0xe937da"), Phaser.Display.Color.HexStringToColor("0xff0066"), Phaser.Display.Color.HexStringToColor("0xff6f93"), Phaser.Display.Color.HexStringToColor("0xfca5b5"), Phaser.Display.Color.HexStringToColor("0xf8f3eb")], clothingColors: [Phaser.Display.Color.HexStringToColor("0x1a1616"), Phaser.Display.Color.HexStringToColor("0x868686"), Phaser.Display.Color.HexStringToColor("0x72718e"), Phaser.Display.Color.HexStringToColor("0x441b22"), Phaser.Display.Color.HexStringToColor("0x89522f"), Phaser.Display.Color.HexStringToColor("0xe1caa7"), Phaser.Display.Color.HexStringToColor("0x861d00"), Phaser.Display.Color.HexStringToColor("0xc71300"), Phaser.Display.Color.HexStringToColor("0xea4f00"), Phaser.Display.Color.HexStringToColor("0xff9600"), Phaser.Display.Color.HexStringToColor("0xffd015"), Phaser.Display.Color.HexStringToColor("0xffe37b"), Phaser.Display.Color.HexStringToColor("0x05e31f"), Phaser.Display.Color.HexStringToColor("0x00800f"), Phaser.Display.Color.HexStringToColor("0x68ff86"), Phaser.Display.Color.HexStringToColor("0x41cfff"), Phaser.Display.Color.HexStringToColor("0x2291e7"), Phaser.Display.Color.HexStringToColor("0x0029d7"), Phaser.Display.Color.HexStringToColor("0x6700ce"), Phaser.Display.Color.HexStringToColor("0x9d18fe"), Phaser.Display.Color.HexStringToColor("0xc779ff"), Phaser.Display.Color.HexStringToColor("0xe937da"), Phaser.Display.Color.HexStringToColor("0xff0066"), Phaser.Display.Color.HexStringToColor("0xff6f93"), Phaser.Display.Color.HexStringToColor("0xfca5b5"), Phaser.Display.Color.HexStringToColor("0xffb384"), Phaser.Display.Color.HexStringToColor("0xf8f3eb")], nose: [Phaser.Display.Color.HexStringToColor("0xffd6bb")] }; function B(e, t, s) { return { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", attachments: [{ slot: "head", attachment: 2 < arguments.length && void 0 !== s ? s : null }], item_data: { item_id: "shape_" + e, item_name: t, item_category: "shape", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function L(e, t, s) { return { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", attachments: [{ slot: "mouth", attachment: 2 < arguments.length ? s : void 0 }], item_data: { item_id: "mouth_" + e, item_name: t, item_category: "mouth", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function G(e, t, s) { return { id: e, key: "ui", frame: t, attachments: [{ slot: "nose", attachment: s }], item_data: { item_id: "nose_" + e, item_name: t, item_category: "nose", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function F(e, t, s, a, n) { return a = 3 < arguments.length && void 0 !== a ? a : null, { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", bot_frame: s = 2 < arguments.length && void 0 !== s ? s : null, attachments: [{ slot: "eyes", attachment: 4 < arguments.length && void 0 !== n ? n : "eyes-male", color: i.a.Display.Color.HexStringToColor("ffffff") }, { slot: "iris", attachment: a }, { slot: "pupils", attachment: "pupils", color: i.a.Display.Color.HexStringToColor("ffffff") }], item_data: { item_id: "eye_" + e, item_name: t, item_category: "eye", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function R(e, t, s, i) { return { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", attachments: [{ slot: "costume-accessories-hat", attachment: 2 < arguments.length && void 0 !== s ? s : null }, { slot: "costume-accessories-hat-back", attachment: 3 < arguments.length && void 0 !== i ? i : null }], item_data: { item_id: "hat_" + e, item_name: t, item_category: "hat", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function V(e, t, s, i) { return { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", attachments: [{ slot: "costume-accessories-glasses", attachment: 2 < arguments.length && void 0 !== s ? s : null }, { slot: "costume-accessories-glasses-back", attachment: 3 < arguments.length && void 0 !== i ? i : null }], item_data: { item_id: "glasses_" + e, item_name: t, item_category: "glasses", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function M(e, t, s, i) { return { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", attachments: [{ slot: "costume-accessories-jewelry", attachment: 2 < arguments.length && void 0 !== s ? s : null }, { slot: "costume-accessories-jewelry-back", attachment: 3 < arguments.length && void 0 !== i ? i : null }], item_data: { item_id: "jewelry_" + e, item_name: t, item_category: "jewelry", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function U(e, t, s, i, a) { return { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", attachments: [{ slot: "hair-top", attachment: s = 2 < arguments.length && void 0 !== s ? s : null }, { slot: "hair-middle", attachment: 4 < arguments.length && void 0 !== a ? a : null }, { slot: "hair-behind", attachment: i = 3 < arguments.length && void 0 !== i ? i : null }, { slot: "brow-l", attachment: "brow-l" }, { slot: "brow-r", attachment: "brow-r" }], item_data: { item_id: "hair_front_" + e, item_name: t, item_category: "hair_front", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function z(e, t, s, i) { return { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", attachments: [{ slot: "hair-facial", attachment: s = 2 < arguments.length && void 0 !== s ? s : null }, { slot: "hair-facial-back", attachment: i = 3 < arguments.length && void 0 !== i ? i : null }, { slot: "no-hair-facial", attachment: !s && !i }], item_data: { item_id: "facial_hair_" + e, item_name: t, item_category: "facial_hair", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function j(e, t, s, i, a, n, o, r) { return { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", attachments: [{ slot: "costume-body", attachment: s = 2 < arguments.length && void 0 !== s ? s : null }, { slot: "costume-body-back", attachment: 7 < arguments.length && void 0 !== r ? r : null }, { slot: "costume-l-arm-upper", attachment: i = 3 < arguments.length && void 0 !== i ? i : null }, { slot: "costume-r-arm-upper", attachment: a = 4 < arguments.length && void 0 !== a ? a : null }, { slot: "costume-l-arm-lower", attachment: n = 5 < arguments.length && void 0 !== n ? n : null }, { slot: "costume-r-arm-lower", attachment: o = 6 < arguments.length && void 0 !== o ? o : null }, { slot: "costume-dress", attachment: null }], item_data: { item_id: "shirt_" + e, item_name: t, item_category: "shirt", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function H(e, t, s, i, a, n, o) { return { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", attachments: [{ slot: "costume-pants", attachment: 2 < arguments.length && void 0 !== s ? s : null }, { slot: "costume-l-leg-upper", attachment: 3 < arguments.length && void 0 !== i ? i : null }, { slot: "costume-r-leg-upper", attachment: 4 < arguments.length && void 0 !== a ? a : null }, { slot: "costume-l-leg-lower", attachment: 5 < arguments.length && void 0 !== n ? n : null }, { slot: "costume-r-leg-lower", attachment: 6 < arguments.length && void 0 !== o ? o : null }], item_data: { item_id: "pants_" + e, item_name: t, item_category: "pants", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function Y(e, t, s, a, n, o) { return o = 5 < arguments.length && void 0 !== o ? o : null, { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", attachments: [{ slot: "costume-l-foot-bot", attachment: s = 2 < arguments.length && void 0 !== s ? s : null }, { slot: "costume-r-foot-bot", attachment: a = 3 < arguments.length && void 0 !== a ? a : null }, { slot: "costume-l-foot-top", attachment: n = 4 < arguments.length && void 0 !== n ? n : null, color: i.a.Display.Color.HexStringToColor("ffffff") }, { slot: "costume-r-foot-top", attachment: o, color: i.a.Display.Color.HexStringToColor("ffffff") }], item_data: { item_id: "shoes_" + e, item_name: t, item_category: "shoes", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function W(e, t, s) { return { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", attachments: [{ slot: "costume-skirt", attachment: 2 < arguments.length && void 0 !== s ? s : null }], item_data: { item_id: "skirt_" + e, item_name: t, item_category: "skirt", item_variant: "undefined", item_brand: "famobi", price: 1 } } } function K(e, t, s, i, a) { return i = 3 < arguments.length ? i : void 0, a = 4 < arguments.length && void 0 !== a ? a : null, { id: e, key: "ui", frame: t = 1 < arguments.length && void 0 !== t ? t : "icon-none", attachments: [{ slot: "costume-dress", attachment: s = 2 < arguments.length && void 0 !== s ? s : null }, { slot: "costume-skirt", attachment: null }, { slot: "costume-body", attachment: (i = { base: null, lUpper: null, rUpper: null, lLower: null, rLower: null, ...i }).base }, { slot: "costume-body-back", attachment: a }, { slot: "costume-l-arm-upper", attachment: i.lUpper }, { slot: "costume-r-arm-upper", attachment: i.rUpper }, { slot: "costume-l-arm-lower", attachment: i.lLower }, { slot: "costume-r-arm-lower", attachment: i.rLower }], item_data: { item_id: "shirt_" + e, item_name: t, item_category: "dress", item_variant: "undefined", item_brand: "famobi", price: 1 } } } var X = { skin: { customizable: !0, icon: { key: "ui", frame: "icon-head" }, subcategories: { shape: { icon: { key: "ui", frame: "icon-face" }, colors: P.skinColors, options: [B(0, "head-1", "head-1"), B(1, "head-2", "head-2"), B(2, "head-3", "head-3")] }, eyes: { icon: { key: "ui", frame: "icon-head-eyes" }, colors: P.eyeColors, options: [F(0, "eye-top-1", "eye-bot-1", null, "eyes-male", "brow-l", "brow-r"), F(1, "eye-top-2", "eye-bot-1", "iris", "eyes-male", "brow-l", "brow-r"), F(4, "eye-top-1", "eye-bot-3", null, "eyes-male-asian", "brow-l", "brow-r"), F(2, "eye-top-1", "eye-bot-2", null, "eyes-female"), F(3, "eye-top-2", "eye-bot-2", "iris", "eyes-female"), F(5, "eye-top-1", "eye-bot-4", null, "eyes-female-asian", "brow-l", "brow-r"), F(6, "eye-top-2", "eye-bot-3", "iris", "eyes-male-asian"), F(7, "eye-top-2", "eye-bot-4", "iris", "eyes-female-asian")] }, nose: { icon: { key: "ui", frame: "icon-head-nose" }, colors: P.nose, options: [G(0, "nose-1", "nose-1"), G(1, "nose-2", "nose-2"), G(5, "nose-6", "nose-6")] }, lips: { icon: { key: "ui", frame: "icon-head-mouth" }, colors: P.mouthColors, options: [L(0, "lip-01", "mouth-01"), L(1, "lip-02", "mouth-02"), L(2, "lip-03", "mouth-03"), L(3, "lip-04", "mouth-04")] } } }, hair: { customizable: !0, icon: { key: "ui", frame: "icon-hair" }, subcategories: { hair_front: { icon: { key: "ui", frame: "icon-hair-front" }, colors: P.hairColors, options: [U(0, "icon-none"), U(1, "hair-0", "hair-1", "hair-1"), U(2, "hair-1", "hair-2", "hair-2"), U(3, "hair-2", "hair-3", "hair-3"), U(4, "hair-3", "hair-4"), U(5, "hair-4", "hair-5"), U(6, "hair-5", "hair-6"), U(7, "hair-7", "hair-7"), U(8, "hair-8", "hair-8"), U(9, "hair-9", "hair-9"), U(10, "hair-10", "hair-10"), U(11, "hair-11", "hair-11"), U(12, "hair-12", "hair-12"), U(13, "hair-13", "hair-13", "hair-13"), U(14, "hair-14", "hair-14", "hair-14"), U(15, "hair-15", "hair-15", "hair-15"), U(16, "hair-16", "hair-16", null, "hair-16"), U(17, "hair-17", "hair-17", "hair-17"), U(18, "hair-18", "hair-18", "hair-18"), U(19, "hair-19", "hair-19"), U(20, "hair-20", "hair-20"), U(21, "hair-21", "hair-21"), U(22, "hair-22", "hair-22"), U(23, "hair-23", "hair-23", "hair-23"), U(24, "hair-24", "hair-24", "hair-24"), U(25, "hair-25", "hair-25"), U(26, "hair-26", "hair-26", "hair-26"), U(27, "hair-27", "hair-27"), U(28, "hair-28", "hair-28"), U(29, "hair-29", "hair-29"), U(30, "hair-30", "hair-30", "hair-30"), U(31, "hair-31", "hair-31"), U(32, "hair-32", "hair-32"), U(33, "hair-33", "hair-33", "hair-33"), U(34, "hair-34", "hair-34"), U(35, "hair-35", "hair-35", null, "hair-35"), U(36, "hair-36", "hair-36"), U(37, "hair-37", "hair-37", "hair-37"), U(38, "hair-38", "hair-38", "hair-38"), U(39, "hair-39", "hair-39"), U(40, "hair-40", "hair-40"), U(41, "hair-41", "hair-41"), U(42, "hair-42", "hair-42"), U(43, "hair-43", "hair-43", null, "hair-43")] }, hair_facial: { icon: { key: "ui", frame: "icon-hair-facial" }, colors: P.hairColors, options: [z(0, "icon-none"), z(6, "stubble-4", null, "stubble-3"), z(1, "facial-1", "costume-facial-1"), z(2, "facial-2", "costume-facial-2"), z(3, "facial-3", "costume-facial-3"), z(4, "facial-4", "costume-facial-4"), z(5, "facial-5", "costume-facial-5")] } } }, clothes: { customizable: !0, icon: { key: "ui", frame: "icon-clothes" }, subcategories: { shirt: { icon: { key: "ui", frame: "icon-top" }, colors: P.clothingColors, options: [j(11, "top-4", "costume-body-2"), j(0, "top-1", "costume-body-4", "costume-l-arm-upper-4", "costume-r-arm-upper-4"), j(1, "top-0", "costume-body-3", "costume-l-arm-upper-3", "costume-r-arm-upper-3"), j(2, "top-3", "costume-body-5"), j(3, "top-2", "costume-body-4", "costume-l-arm-upper-1", "costume-r-arm-upper-1", "costume-l-arm-lower-1", "costume-r-arm-lower-1"), j(4, "top-6", "costume-body-6"), j(5, "top-11", "costume-body-10", "costume-l-arm-upper-10", "costume-r-arm-upper-10", "costume-l-arm-lower-10", "costume-r-arm-lower-10"), j(6, "top-5", "costume-body-1", "costume-l-arm-upper-1", "costume-r-arm-upper-1", "costume-l-arm-lower-1", "costume-r-arm-lower-1"), j(7, "top-8", "costume-body-7", "costume-l-arm-upper-7", "costume-r-arm-upper-7", "costume-l-arm-lower-7", "costume-r-arm-lower-7"), j(8, "top-7", "costume-body-11", "costume-l-arm-upper-11", "costume-r-arm-upper-11", "costume-l-arm-lower-11", "costume-r-arm-lower-11"), j(9, "top-10", "costume-body-9", "costume-l-arm-upper-9", "costume-r-arm-upper-9", "costume-l-arm-lower-9", "costume-r-arm-lower-9"), j(10, "top-9", "costume-body-8", "costume-l-arm-upper-8", "costume-r-arm-upper-8", "costume-l-arm-lower-8", "costume-r-arm-lower-8"), j(12, "top-12", "costume-body-12"), j(13, "top-13", "costume-body-13", "costume-l-arm-upper-13", "costume-r-arm-upper-13"), j(14, "top-14", "costume-body-14", "costume-l-arm-upper-14", "costume-r-arm-upper-14", "costume-l-arm-lower-14", "costume-r-arm-lower-14", "costume-body-14"), j(15, "top-15", "costume-body-15", "costume-l-arm-upper-15", "costume-r-arm-upper-15"), j(16, "top-16", "costume-body-16", "costume-l-arm-upper-16", "costume-r-arm-upper-16"), j(17, "top-17", "costume-body-17", "costume-l-arm-upper-17", "costume-r-arm-upper-17"), j(18, "top-18", "costume-body-18", "costume-l-arm-upper-18", "costume-r-arm-upper-18"), j(19, "top-19", "costume-body-19", "costume-l-arm-upper-19", "costume-r-arm-upper-19", "costume-l-arm-lower-19", "costume-r-arm-lower-19"), j(20, "top-20", "costume-body-20"), j(21, "top-21", "costume-body-21"), j(22, "top-22", "costume-body-22", null, "costume-r-arm-upper-22", null, "costume-r-arm-lower-22"), j(29, "top-29", "costume-body-29", "costume-l-arm-upper-29", "costume-r-arm-upper-29", "costume-l-arm-lower-29", "costume-r-arm-lower-29"), j(30, "top-30", "costume-body-30", null, null, "costume-l-arm-lower-30"), j(31, "top-31", "costume-body-31", "costume-l-arm-upper-31", "costume-r-arm-upper-31", "costume-l-arm-lower-31", "costume-r-arm-lower-31"), K(26, "top-26", "costume-dress-1", { lUpper: "costume-l-arm-upper-26", rUpper: "costume-r-arm-upper-26", lLower: "costume-l-arm-lower-26", rLower: "costume-r-arm-lower-26" }), K(27, "top-27", "costume-dress-2", { lUpper: "costume-l-arm-upper-27", rUpper: "costume-r-arm-upper-27", lLower: "costume-l-arm-lower-27", rLower: "costume-r-arm-lower-27" }), K(23, "top-23", "costume-dress-3", null), K(24, "top-24", "costume-dress-5", null), K(25, "top-25", "costume-dress-4", null), K(28, "top-28", "costume-dress-6", { lUpper: "costume-l-arm-upper-28", rUpper: "costume-r-arm-upper-28", lLower: "costume-l-arm-lower-28", rLower: "costume-r-arm-lower-28" })] }, pants: { icon: { key: "ui", frame: "icon-bottom" }, colors: P.clothingColors, options: [H(2, "bot-1", "costume-pants-3", "costume-l-leg-upper-4", "costume-r-leg-upper-4"), H(0, "bot-10", "costume-pants-9", "costume-l-leg-upper-9", "costume-r-leg-upper-9", "costume-l-leg-lower-9", "costume-r-leg-lower-9"), H(1, "bot-9", "costume-pants-11", "costume-l-leg-upper-11", "costume-r-leg-upper-11", "costume-l-leg-lower-11", "costume-r-leg-lower-11"), H(3, "bot-0", "costume-pants-4", "costume-l-leg-upper-4", "costume-r-leg-upper-4"), H(4, "bot-7", "costume-pants-7", "costume-l-leg-upper-7", "costume-r-leg-upper-7"), H(5, "bot-8", "costume-pants-6", "costume-l-leg-upper-6", "costume-r-leg-upper-6"), H(6, "bot-2", "costume-pants-2", "costume-l-leg-upper-2", "costume-r-leg-upper-2"), H(8, "bot-3", "costume-pants-1", "costume-l-leg-upper-1", "costume-r-leg-upper-1", "costume-l-leg-lower-1", "costume-r-leg-lower-1"), H(9, "bot-4", "costume-pants-3", "costume-l-leg-upper-3", "costume-r-leg-upper-3", "costume-l-leg-lower-3", "costume-r-leg-lower-3"), H(10, "bot-5", "costume-pants-4", "costume-l-leg-upper-3", "costume-r-leg-upper-3", "costume-l-leg-lower-3", "costume-r-leg-lower-3"), H(12, "bot-12", "costume-pants-12", "costume-l-leg-upper-12", "costume-r-leg-upper-12", "costume-l-leg-lower-12", "costume-r-leg-lower-12"), H(17, "bot-17", "costume-pants-17", "costume-l-leg-upper-17", "costume-r-leg-upper-17"), H(18, "bot-18", "costume-pants-18", "costume-l-leg-upper-18", "costume-r-leg-upper-18"), H(20, "bot-20", "costume-pants-20", "costume-l-leg-upper-20", "costume-r-leg-upper-20", "costume-l-leg-lower-20", "costume-r-leg-lower-20"), H(21, "bot-21", "costume-pants-21", "costume-l-leg-upper-21", "costume-r-leg-upper-21", "costume-l-leg-lower-21", "costume-r-leg-lower-21"), H(32, "bot-32", "costume-pants-27", "costume-l-leg-upper-27", "costume-r-leg-upper-27", "costume-l-leg-lower-27", "costume-r-leg-lower-27"), H(28, "bot-28", "costume-pants-28", "costume-l-leg-upper-28", "costume-r-leg-upper-28"), H(29, "bot-29", "costume-pants-29", "costume-l-leg-upper-28", "costume-r-leg-upper-29"), H(30, "bot-30", "costume-pants-30", "costume-l-leg-upper-28", "costume-r-leg-upper-28"), H(31, "bot-31", "costume-pants-31", "costume-l-leg-upper-28", "costume-r-leg-upper-28")] }, skirt: { icon: { key: "ui", frame: "icon-clothes-skirt" }, colors: P.clothingColors, options: [W(0, "icon-none"), W(1, "bot-13", "costume-skirt-1"), W(2, "bot-23", "costume-skirt-2"), W(3, "bot-22", "costume-skirt-3"), W(4, "bot-14", "costume-skirt-4"), W(5, "bot-15", "costume-skirt-5")] }, shoes: { icon: { key: "ui", frame: "icon-clothes-shoes" }, colors: P.clothingColors, options: [Y(0, "icon-none"), Y(1, "shoe-1", "costume-l-foot-1", "costume-r-foot-1", "costume-l-foot-1", "costume-r-foot-1"), Y(2, "shoe-2-2", "costume-l-foot-2-2", "costume-r-foot-2-2", "costume-l-foot-2-1", "costume-r-foot-2-1"), Y(3, "shoe-2-1", "costume-l-foot-2-2", "costume-r-foot-2-2", "costume-l-foot-2-2", "costume-r-foot-2-2"), Y(4, "shoe-3", "costume-l-foot-3", "costume-r-foot-3", "costume-l-foot-3", "costume-r-foot-3"), Y(5, "shoe-4-1", "costume-l-foot-4-1", "costume-r-foot-4-1"), Y(6, "shoe-4-2", "costume-l-foot-4-2", "costume-r-foot-4-2", "costume-l-foot-4-2", "costume-r-foot-4-2"), Y(7, "shoe-5", "costume-l-foot-5", "costume-r-foot-5", "costume-l-foot-5", "costume-r-foot-5"), Y(8, "shoe-6", "costume-l-foot-6", "costume-r-foot-6"), Y(9, "shoe-7", "costume-l-foot-7", "costume-r-foot-7"), Y(10, "shoe-8", "costume-l-foot-8", "costume-r-foot-8", "costume-l-foot-8", "costume-r-foot-8"), Y(11, "shoe-9", "costume-l-foot-9", "costume-r-foot-9"), Y(12, "shoe-10", "costume-l-foot-10", "costume-r-foot-10")] } } }, accessories: { customizable: !0, icon: { key: "ui", frame: "icon-accessories" }, subcategories: { hats: { icon: { key: "ui", frame: "icon-accessories-hats" }, colors: P.clothingColors, options: [R(0, "icon-none"), R(1, "hat-1", "hat-1"), R(2, "hat-2", "hat-2"), R(3, "hat-3", "hat-3"), R(4, "hat-4", "hat-4", "hat-4"), R(5, "hat-5", "hat-5"), R(6, "hat-6", "hat-6"), R(7, "hat-7", "hat-7", "hat-7"), R(8, "hat-8", "hat-8", "hat-8"), R(9, "hat-9", "hat-9", "hat-9"), R(10, "hat-10", "hat-10")] }, glasses: { icon: { key: "ui", frame: "icon-accessories-glasses" }, colors: P.clothingColors, options: [V(0, "icon-none"), V(1, "glasses-1", "glasses-1"), V(2, "glasses-2", "glasses-2"), V(3, "glasses-3", "glasses-3"), V(4, "glasses-4", "glasses-4")] }, jewelry: { icon: { key: "ui", frame: "icon-accessories-jewelry" }, colors: P.clothingColors, options: [M(0, "icon-none"), M(1, "jewelry-1", "jewelry-1"), M(2, "jewelry-2", "jewelry-2"), M(3, "jewelry-3", "jewelry-3"), M(4, "jewelry-4", "jewelry-4"), M(5, "jewelry-5", "jewelry-5"), M(6, "jewelry-6", "jewelry-6", "jewelry-back-6"), M(7, "jewelry-7", "jewelry-7", "jewelry-back-7"), M(8, "jewelry-8", "jewelry-8"), M(9, "jewelry-9", "jewelry-9")] } } } }, J = [{ shape: { id: 2, color: { r: 202, g: 139, b: 101 } }, eyes: { id: 0, color: { r: 248, g: 243, b: 235 } }, nose: { id: 0, color: { r: 145, g: 100, b: 81 } }, lips: { id: 0, color: { r: 251, g: 213, b: 42 } }, hair_front: { id: 39, color: { r: 134, g: 34, b: 5 } }, hair_facial: { id: 0, color: { r: 66, g: 50, b: 50 } }, shirt: { id: 16, color: { r: 68, g: 26, b: 0 } }, pants: { id: 21, color: { r: 199, g: 19, b: 0 } }, skirt: { id: 0, color: { r: 103, g: 0, b: 206 } }, shoes: { id: 1, color: { r: 137, g: 82, b: 47 } }, hats: { id: 5, color: { r: 255, g: 208, b: 21 } }, glasses: { id: 0, color: { r: 104, g: 255, b: 134 } }, jewelry: { id: 0, color: { r: 137, g: 82, b: 47 } } }, { shape: { id: 1, color: { r: 225, g: 153, b: 107 } }, eyes: { id: 2, color: { r: 248, g: 243, b: 235 } }, nose: { id: 5, color: { r: 255, g: 214, b: 187 } }, lips: { id: 3, color: { r: 255, g: 66, b: 0 } }, hair_front: { id: 22, color: { r: 66, g: 50, b: 50 } }, hair_facial: { id: 0, color: { r: 99, g: 62, b: 38 } }, shirt: { id: 1, color: { r: 199, g: 19, b: 0 } }, pants: { id: 9, color: { r: 68, g: 26, b: 0 } }, skirt: { id: 0, color: { r: 103, g: 0, b: 206 } }, shoes: { id: 2, color: { r: 26, g: 22, b: 22 } }, hats: { id: 0, color: { r: 26, g: 22, b: 22 } }, glasses: { id: 0, color: { r: 26, g: 22, b: 22 } }, jewelry: { id: 0, color: { r: 137, g: 82, b: 47 } } }, { shape: { id: 1, color: { r: 104, g: 72, b: 61 } }, eyes: { id: 0, color: { r: 255, g: 203, b: 0 } }, nose: { id: 0, color: { r: 145, g: 100, b: 81 } }, lips: { id: 0, color: { r: 199, g: 121, b: 255 } }, hair_front: { id: 38, color: { r: 68, g: 68, b: 68 } }, hair_facial: { id: 4, color: { r: 68, g: 68, b: 68 } }, shirt: { id: 31, color: { r: 255, g: 150, b: 0 } }, pants: { id: 0, color: { r: 34, g: 145, b: 231 } }, skirt: { id: 0, color: { r: 255, g: 150, b: 0 } }, shoes: { id: 4, color: { r: 255, g: 150, b: 0 } }, hats: { id: 0, color: { r: 68, g: 26, b: 0 } }, glasses: { id: 0, color: { r: 26, g: 22, b: 22 } }, jewelry: { id: 0, color: { r: 234, g: 79, b: 0 } } }, { shape: { id: 2, color: { r: 252, g: 184, b: 133 } }, eyes: { id: 3, color: { r: 199, g: 121, b: 255 } }, nose: { id: 0, color: { r: 255, g: 214, b: 187 } }, lips: { id: 1, color: { r: 134, g: 29, b: 0 } }, hair_front: { id: 43, color: { r: 134, g: 34, b: 5 } }, hair_facial: { id: 0, color: { r: 248, g: 243, b: 235 } }, shirt: { id: 21, color: { r: 255, g: 150, b: 0 } }, pants: { id: 2, color: { r: 34, g: 145, b: 231 } }, skirt: { id: 0, color: { r: 248, g: 243, b: 235 } }, shoes: { id: 6, color: { r: 137, g: 82, b: 47 } }, hats: { id: 0, color: { r: 248, g: 243, b: 235 } }, glasses: { id: 0, color: { r: 248, g: 243, b: 235 } }, jewelry: { id: 4, color: { r: 255, g: 208, b: 21 } } }, { shape: { id: 2, color: { r: 225, g: 153, b: 107 } }, eyes: { id: 3, color: { r: 137, g: 82, b: 47 } }, nose: { id: 1, color: { r: 255, g: 214, b: 187 } }, lips: { id: 2, color: { r: 26, g: 22, b: 22 } }, hair_front: { id: 2, color: { r: 136, g: 96, b: 71 } }, hair_facial: { id: 0, color: { r: 248, g: 243, b: 235 } }, shirt: { id: 6, color: { r: 26, g: 22, b: 22 } }, pants: { id: 20, color: { r: 0, g: 128, b: 15 } }, skirt: { id: 0, color: { r: 248, g: 243, b: 235 } }, shoes: { id: 1, color: { r: 248, g: 243, b: 235 } }, hats: { id: 0, color: { r: 248, g: 243, b: 235 } }, glasses: { id: 0, color: { r: 248, g: 243, b: 235 } }, jewelry: { id: 3, color: { r: 134, g: 134, b: 134 } } }, { shape: { id: 1, color: { r: 255, g: 214, b: 187 } }, eyes: { id: 0, color: { r: 255, g: 203, b: 0 } }, nose: { id: 5, color: { r: 255, g: 214, b: 187 } }, lips: { id: 0, color: { r: 199, g: 121, b: 255 } }, hair_front: { id: 8, color: { r: 189, g: 84, b: 53 } }, hair_facial: { id: 0, color: { r: 68, g: 68, b: 68 } }, shirt: { id: 1, color: { r: 255, g: 111, b: 147 } }, pants: { id: 9, color: { r: 65, g: 207, b: 255 } }, skirt: { id: 0, color: { r: 255, g: 150, b: 0 } }, shoes: { id: 3, color: { r: 134, g: 29, b: 0 } }, hats: { id: 0, color: { r: 68, g: 26, b: 0 } }, glasses: { id: 0, color: { r: 26, g: 22, b: 22 } }, jewelry: { id: 0, color: { r: 234, g: 79, b: 0 } } }, { shape: { id: 0, color: { r: 252, g: 184, b: 133 } }, eyes: { id: 3, color: { r: 0, g: 128, b: 15 } }, nose: { id: 1, color: { r: 255, g: 214, b: 187 } }, lips: { id: 1, color: { r: 255, g: 111, b: 147 } }, hair_front: { id: 17, color: { r: 235, g: 88, b: 44 } }, hair_facial: { id: 0, color: { r: 248, g: 243, b: 235 } }, shirt: { id: 6, color: { r: 199, g: 121, b: 255 } }, pants: { id: 2, color: { r: 248, g: 243, b: 235 } }, skirt: { id: 5, color: { r: 248, g: 243, b: 235 } }, shoes: { id: 4, color: { r: 255, g: 111, b: 147 } }, hats: { id: 0, color: { r: 248, g: 243, b: 235 } }, glasses: { id: 3, color: { r: 199, g: 19, b: 0 } }, jewelry: { id: 0, color: { r: 248, g: 243, b: 235 } } }, { shape: { id: 2, color: { r: 225, g: 153, b: 107 } }, eyes: { id: 0, color: { r: 248, g: 243, b: 235 } }, nose: { id: 5, color: { r: 255, g: 214, b: 187 } }, lips: { id: 0, color: { r: 251, g: 213, b: 42 } }, hair_front: { id: 0, color: { r: 99, g: 62, b: 38 } }, hair_facial: { id: 2, color: { r: 99, g: 62, b: 38 } }, shirt: { id: 31, color: { r: 255, g: 111, b: 147 } }, pants: { id: 21, color: { r: 137, g: 82, b: 47 } }, skirt: { id: 0, color: { r: 103, g: 0, b: 206 } }, shoes: { id: 1, color: { r: 199, g: 19, b: 0 } }, hats: { id: 4, color: { r: 26, g: 22, b: 22 } }, glasses: { id: 3, color: { r: 26, g: 22, b: 22 } }, jewelry: { id: 0, color: { r: 137, g: 82, b: 47 } } }, { shape: { id: 0, color: { r: 179, g: 126, b: 100 } }, eyes: { id: 1, color: { r: 134, g: 134, b: 134 } }, nose: { id: 0, color: { r: 255, g: 214, b: 187 } }, lips: { id: 1, color: { r: 255, g: 0, b: 0 } }, hair_front: { id: 11, color: { r: 189, g: 84, b: 53 } }, hair_facial: { id: 0, color: { r: 248, g: 243, b: 235 } }, shirt: { id: 6, color: { r: 104, g: 255, b: 134 } }, pants: { id: 8, color: { r: 134, g: 134, b: 134 } }, skirt: { id: 0, color: { r: 248, g: 243, b: 235 } }, shoes: { id: 3, color: { r: 234, g: 79, b: 0 } }, hats: { id: 0, color: { r: 248, g: 243, b: 235 } }, glasses: { id: 0, color: { r: 199, g: 19, b: 0 } }, jewelry: { id: 2, color: { r: 255, g: 227, b: 123 } } }, { shape: { id: 0, color: { r: 255, g: 214, b: 187 } }, eyes: { id: 0, color: { r: 248, g: 243, b: 235 } }, nose: { id: 0, color: { r: 255, g: 214, b: 187 } }, lips: { id: 0, color: { r: 251, g: 213, b: 42 } }, hair_front: { id: 21, color: { r: 99, g: 62, b: 38 } }, hair_facial: { id: 0, color: { r: 99, g: 62, b: 38 } }, shirt: { id: 1, color: { r: 255, g: 227, b: 123 } }, pants: { id: 0, color: { r: 34, g: 145, b: 231 } }, skirt: { id: 0, color: { r: 103, g: 0, b: 206 } }, shoes: { id: 2, color: { r: 134, g: 29, b: 0 } }, hats: { id: 0, color: { r: 26, g: 22, b: 22 } }, glasses: { id: 0, color: { r: 26, g: 22, b: 22 } }, jewelry: { id: 0, color: { r: 137, g: 82, b: 47 } } }, { shape: { id: 0, color: { r: 104, g: 72, b: 61 } }, eyes: { id: 3, color: { r: 137, g: 82, b: 47 } }, nose: { id: 0, color: { r: 255, g: 214, b: 187 } }, lips: { id: 3, color: { r: 255, g: 0, b: 0 } }, hair_front: { id: 37, color: { r: 66, g: 50, b: 50 } }, hair_facial: { id: 0, color: { r: 248, g: 243, b: 235 } }, shirt: { id: 14, color: { r: 255, g: 179, b: 132 } }, pants: { id: 21, color: { r: 26, g: 22, b: 22 } }, skirt: { id: 0, color: { r: 248, g: 243, b: 235 } }, shoes: { id: 7, color: { r: 248, g: 243, b: 235 } }, hats: { id: 0, color: { r: 248, g: 243, b: 235 } }, glasses: { id: 0, color: { r: 248, g: 243, b: 235 } }, jewelry: { id: 0, color: { r: 248, g: 243, b: 235 } } }, { shape: { id: 0, color: { r: 255, g: 207, b: 167 } }, eyes: { id: 1, color: { r: 34, g: 145, b: 231 } }, nose: { id: 0, color: { r: 255, g: 214, b: 187 } }, lips: { id: 0, color: { r: 251, g: 213, b: 42 } }, hair_front: { id: 34, color: { r: 136, g: 96, b: 71 } }, hair_facial: { id: 0, color: { r: 99, g: 62, b: 38 } }, shirt: { id: 29, color: { r: 199, g: 19, b: 0 } }, pants: { id: 10, color: { r: 248, g: 243, b: 235 } }, skirt: { id: 0, color: { r: 103, g: 0, b: 206 } }, shoes: { id: 4, color: { r: 134, g: 29, b: 0 } }, hats: { id: 0, color: { r: 26, g: 22, b: 22 } }, glasses: { id: 0, color: { r: 26, g: 22, b: 22 } }, jewelry: { id: 0, color: { r: 137, g: 82, b: 47 } } }, { shape: { id: 2, color: { r: 252, g: 184, b: 133 } }, eyes: { id: 0, color: { r: 248, g: 243, b: 235 } }, nose: { id: 5, color: { r: 255, g: 214, b: 187 } }, lips: { id: 0, color: { r: 26, g: 22, b: 22 } }, hair_front: { id: 9, color: { r: 99, g: 62, b: 38 } }, hair_facial: { id: 0, color: { r: 248, g: 243, b: 235 } }, shirt: { id: 3, color: { r: 199, g: 19, b: 0 } }, pants: { id: 20, color: { r: 68, g: 27, b: 34 } }, skirt: { id: 0, color: { r: 255, g: 0, b: 102 } }, shoes: { id: 4, color: { r: 134, g: 29, b: 0 } }, hats: { id: 0, color: { r: 255, g: 0, b: 102 } }, glasses: { id: 0, color: { r: 26, g: 22, b: 22 } }, jewelry: { id: 0, color: { r: 255, g: 0, b: 102 } } }, { shape: { id: 0, color: { r: 255, g: 214, b: 187 } }, eyes: { id: 5, color: { r: 199, g: 19, b: 0 } }, nose: { id: 5, color: { r: 255, g: 214, b: 187 } }, lips: { id: 1, color: { r: 199, g: 19, b: 0 } }, hair_front: { id: 36, color: { r: 66, g: 50, b: 50 } }, hair_facial: { id: 0, color: { r: 99, g: 62, b: 38 } }, shirt: { id: 28, color: { r: 26, g: 22, b: 22 } }, pants: { id: 28, color: { r: 26, g: 22, b: 22 } }, skirt: { id: 0, color: { r: 255, g: 0, b: 102 } }, shoes: { id: 8, color: { r: 255, g: 111, b: 147 } }, hats: { id: 0, color: { r: 137, g: 82, b: 47 } }, glasses: { id: 0, color: { r: 137, g: 82, b: 47 } }, jewelry: { id: 1, color: { r: 134, g: 134, b: 134 } } }, { shape: { id: 0, color: { r: 179, g: 126, b: 100 } }, eyes: { id: 7, color: { r: 134, g: 134, b: 134 } }, nose: { id: 0, color: { r: 255, g: 214, b: 187 } }, lips: { id: 0, color: { r: 26, g: 22, b: 22 } }, hair_front: { id: 37, color: { r: 68, g: 68, b: 68 } }, hair_facial: { id: 0, color: { r: 248, g: 243, b: 235 } }, shirt: { id: 26, color: { r: 255, g: 208, b: 21 } }, pants: { id: 2, color: { r: 255, g: 150, b: 0 } }, skirt: { id: 0, color: { r: 255, g: 0, b: 102 } }, shoes: { id: 12, color: { r: 234, g: 79, b: 0 } }, hats: { id: 0, color: { r: 255, g: 0, b: 102 } }, glasses: { id: 0, color: { r: 255, g: 0, b: 102 } }, jewelry: { id: 6, color: { r: 255, g: 227, b: 123 } } }, { shape: { id: 1, color: { r: 252, g: 184, b: 133 } }, eyes: { id: 4, color: { r: 0, g: 41, b: 215 } }, nose: { id: 5, color: { r: 145, g: 100, b: 81 } }, lips: { id: 0, color: { r: 251, g: 142, b: 55 } }, hair_front: { id: 30, color: { r: 245, g: 206, b: 53 } }, hair_facial: { id: 2, color: { r: 245, g: 206, b: 53 } }, shirt: { id: 14, color: { r: 0, g: 128, b: 15 } }, pants: { id: 21, color: { r: 134, g: 29, b: 0 } }, skirt: { id: 0, color: { r: 134, g: 134, b: 134 } }, shoes: { id: 3, color: { r: 137, g: 82, b: 47 } }, hats: { id: 0, color: { r: 134, g: 29, b: 0 } }, glasses: { id: 0, color: { r: 26, g: 22, b: 22 } }, jewelry: { id: 0, color: { r: 255, g: 208, b: 21 } } }, { shape: { id: 1, color: { r: 179, g: 126, b: 100 } }, eyes: { id: 0, color: { r: 199, g: 121, b: 255 } }, nose: { id: 1, color: { r: 179, g: 126, b: 100 } }, lips: { id: 0, color: { r: 199, g: 121, b: 255 } }, hair_front: { id: 20, color: { r: 66, g: 50, b: 50 } }, hair_facial: { id: 6, color: { r: 99, g: 62, b: 38 } }, shirt: { id: 16, color: { r: 234, g: 79, b: 0 } }, pants: { id: 10, color: { r: 68, g: 27, b: 34 } }, skirt: { id: 0, color: { r: 255, g: 208, b: 21 } }, shoes: { id: 2, color: { r: 134, g: 134, b: 134 } }, hats: { id: 0, color: { r: 104, g: 255, b: 134 } }, glasses: { id: 0, color: { r: 255, g: 150, b: 0 } }, jewelry: { id: 0, color: { r: 255, g: 208, b: 21 } } }, { shape: { id: 0, color: { r: 225, g: 153, b: 107 } }, eyes: { id: 5, color: { r: 104, g: 255, b: 134 } }, nose: { id: 1, color: { r: 225, g: 153, b: 107 } }, lips: { id: 2, color: { r: 134, g: 29, b: 0 } }, hair_front: { id: 12, color: { r: 66, g: 50, b: 50 } }, hair_facial: { id: 0, color: { r: 66, g: 50, b: 50 } }, shirt: { id: 22, color: { r: 248, g: 243, b: 235 } }, pants: { id: 18, color: { r: 248, g: 243, b: 235 } }, skirt: { id: 2, color: { r: 248, g: 243, b: 235 } }, shoes: { id: 8, color: { r: 255, g: 111, b: 147 } }, hats: { id: 0, color: { r: 157, g: 24, b: 254 } }, glasses: { id: 2, color: { r: 199, g: 121, b: 255 } }, jewelry: { id: 0, color: { r: 68, g: 27, b: 34 } } }, { shape: { id: 2, color: { r: 202, g: 139, b: 101 } }, eyes: { id: 4, color: { r: 34, g: 145, b: 231 } }, nose: { id: 5, color: { r: 202, g: 139, b: 101 } }, lips: { id: 1, color: { r: 26, g: 22, b: 22 } }, hair_front: { id: 3, color: { r: 66, g: 50, b: 50 } }, hair_facial: { id: 0, color: { r: 189, g: 84, b: 53 } }, shirt: { id: 4, color: { r: 199, g: 19, b: 0 } }, pants: { id: 3, color: { r: 255, g: 150, b: 0 } }, skirt: { id: 0, color: { r: 5, g: 227, b: 31 } }, shoes: { id: 1, color: { r: 134, g: 29, b: 0 } }, hats: { id: 0, color: { r: 0, g: 128, b: 15 } }, glasses: { id: 0, color: { r: 137, g: 82, b: 47 } }, jewelry: { id: 0, color: { r: 255, g: 208, b: 21 } } }, { shape: { id: 0, color: { r: 255, g: 214, b: 187 } }, eyes: { id: 2, color: { r: 137, g: 82, b: 47 } }, nose: { id: 0, color: { r: 255, g: 214, b: 187 } }, lips: { id: 0, color: { r: 168, g: 249, b: 84 } }, hair_front: { id: 18, color: { r: 248, g: 243, b: 235 } }, hair_facial: { id: 0, color: { r: 126, g: 37, b: 209 } }, shirt: { id: 25, color: { r: 255, g: 111, b: 147 } }, pants: { id: 29, color: { r: 255, g: 227, b: 123 } }, skirt: { id: 0, color: { r: 199, g: 19, b: 0 } }, shoes: { id: 9, color: { r: 255, g: 0, b: 102 } }, hats: { id: 0, color: { r: 34, g: 145, b: 231 } }, glasses: { id: 0, color: { r: 0, g: 41, b: 215 } }, jewelry: { id: 0, color: { r: 255, g: 208, b: 21 } } }, { shape: { id: 2, color: { r: 255, g: 207, b: 167 } }, eyes: { id: 4, color: { r: 26, g: 22, b: 22 } }, nose: { id: 0, color: { r: 255, g: 214, b: 187 } }, lips: { id: 0, color: { r: 251, g: 142, b: 55 } }, hair_front: { id: 41, color: { r: 136, g: 96, b: 71 } }, hair_facial: { id: 5, color: { r: 189, g: 84, b: 53 } }, shirt: { id: 9, color: { r: 134, g: 29, b: 0 } }, pants: { id: 0, color: { r: 34, g: 145, b: 231 } }, skirt: { id: 0, color: { r: 199, g: 19, b: 0 } }, shoes: { id: 1, color: { r: 234, g: 79, b: 0 } }, hats: { id: 0, color: { r: 255, g: 179, b: 132 } }, glasses: { id: 0, color: { r: 234, g: 79, b: 0 } }, jewelry: { id: 0, color: { r: 26, g: 22, b: 22 } } }, { shape: { id: 0, color: { r: 145, g: 100, b: 81 } }, eyes: { id: 7, color: { r: 199, g: 121, b: 255 } }, nose: { id: 5, color: { r: 255, g: 214, b: 187 } }, lips: { id: 2, color: { r: 134, g: 29, b: 0 } }, hair_front: { id: 9, color: { r: 189, g: 84, b: 53 } }, hair_facial: { id: 0, color: { r: 245, g: 206, b: 53 } }, shirt: { id: 11, color: { r: 104, g: 255, b: 134 } }, pants: { id: 2, color: { r: 65, g: 207, b: 255 } }, skirt: { id: 0, color: { r: 134, g: 29, b: 0 } }, shoes: { id: 7, color: { r: 248, g: 243, b: 235 } }, hats: { id: 0, color: { r: 65, g: 207, b: 255 } }, glasses: { id: 0, color: { r: 234, g: 79, b: 0 } }, jewelry: { id: 0, color: { r: 137, g: 82, b: 47 } } }, { shape: { id: 0, color: { r: 104, g: 72, b: 61 } }, eyes: { id: 0, color: { r: 134, g: 134, b: 134 } }, nose: { id: 5, color: { r: 179, g: 126, b: 100 } }, lips: { id: 0, color: { r: 26, g: 22, b: 22 } }, hair_front: { id: 25, color: { r: 248, g: 225, b: 143 } }, hair_facial: { id: 0, color: { r: 66, g: 50, b: 50 } }, shirt: { id: 12, color: { r: 103, g: 0, b: 206 } }, pants: { id: 8, color: { r: 26, g: 22, b: 22 } }, skirt: { id: 0, color: { r: 0, g: 41, b: 215 } }, shoes: { id: 7, color: { r: 248, g: 243, b: 235 } }, hats: { id: 0, color: { r: 134, g: 29, b: 0 } }, glasses: { id: 0, color: { r: 134, g: 29, b: 0 } }, jewelry: { id: 3, color: { r: 255, g: 208, b: 21 } } }, { shape: { id: 0, color: { r: 255, g: 207, b: 167 } }, eyes: { id: 4, color: { r: 0, g: 41, b: 215 } }, nose: { id: 5, color: { r: 255, g: 207, b: 167 } }, lips: { id: 0, color: { r: 199, g: 19, b: 0 } }, hair_front: { id: 6, color: { r: 99, g: 62, b: 38 } }, hair_facial: { id: 0, color: { r: 235, g: 88, b: 44 } }, shirt: { id: 8, color: { r: 26, g: 22, b: 22 } }, pants: { id: 9, color: { r: 134, g: 29, b: 0 } }, skirt: { id: 0, color: { r: 0, g: 128, b: 15 } }, shoes: { id: 4, color: { r: 26, g: 22, b: 22 } }, hats: { id: 0, color: { r: 234, g: 79, b: 0 } }, glasses: { id: 3, color: { r: 68, g: 27, b: 34 } }, jewelry: { id: 0, color: { r: 255, g: 111, b: 147 } } }], q = "acceptedTOS", Z = "enterName1", Q = "openCharacter1", $ = "chooseCharacter1", ee = "confirmCharacter1", te = "exploreSub", se = "exploreMain", ie = "viewSave1", ae = "enterName2", ne = "openCharacter2", oe = "chooseCharacter2", re = "randomiseCharacter", he = "confirmCharacter2", ce = "startGame", le = "startScenario", de = "finishScenario", ue = "backToHome", ge = "swap", me = { NAME_INPUT_PLACEHOLDER: "NAME_INPUT_PLACEHOLDER", ACCEPT_BUTTON: "ACCEPT_BUTTON", CONFIRM_BUTTON: "CONFIRM_BUTTON", START_BUTTON: "START_BUTTON", RESET_BUTTON: "RESET_BUTTON", RANDOM_BUTTON: "RANDOM_BUTTON", BACK_BUTTON: "BACK_BUTTON", HOME_BUTTON: "HOME_BUTTON", SHARE_BUTTON: "SHARE_BUTTON", REWATCH_BUTTON: "REWATCH_BUTTON", SHARE_BUTTON_DIALOG: "SHARE_BUTTON_DIALOG", TOS_MESSAGE: "TOS_MESSAGE", TOS: "TOS", PP: "PP", SLOT_CUSTOM: "SLOT_CUSTOM", NOTIFICATION_TITLE: "NOTIFICATION_TITLE", NOTIFICATION_TEXT_01: "NOTIFICATION_TEXT_01", NOTIFICATION_BUTTON: "NOTIFICATION_BUTTON", NOTIFICATION_BUTTON_PLAY: "NOTIFICATION_BUTTON_PLAY", DOWNLOAD_APP: "DOWNLOAD_APP", NEWMATCH_BUTTON: "NEWMATCH_BUTTON", LOADING: "LOADING", LINK_COPY: "LINK_COPY", LANGUAGE: "LANGUAGE", SETTINGS: "SETTINGS", CREDITS: "CREDITS", DIALOG_FUNNY_LN_01: "DIALOG_FUNNY_LN_01", DIALOG_FUNNY_LN_02: "DIALOG_FUNNY_LN_02", DIALOG_FUNNY_LN_03: "DIALOG_FUNNY_LN_03", DIALOG_FUNNY_LN_04: "DIALOG_FUNNY_LN_04", DIALOG_FUNNY_LN_05: "DIALOG_FUNNY_LN_05", DIALOG_FUNNY_LN_06: "DIALOG_FUNNY_LN_06", DIALOG_FUNNY_LN_07: "DIALOG_FUNNY_LN_07", DIALOG_FUNNY_LN_08: "DIALOG_FUNNY_LN_08", DIALOG_FUNNY_BB_01: "DIALOG_FUNNY_BB_01", DIALOG_FUNNY_BB_02: "DIALOG_FUNNY_BB_02", DIALOG_FUNNY_BB_03: "DIALOG_FUNNY_BB_03", DIALOG_FUNNY_BB_04: "DIALOG_FUNNY_BB_04", DIALOG_FUNNY_BB_05: "DIALOG_FUNNY_BB_05", DIALOG_FUNNY_BB_06: "DIALOG_FUNNY_BB_06", DIALOG_FUNNY_DG_01: "DIALOG_FUNNY_DG_01", DIALOG_FUNNY_DG_02: "DIALOG_FUNNY_DG_02", DIALOG_FUNNY_DG_03: "DIALOG_FUNNY_DG_03", DIALOG_FUNNY_DG_04: "DIALOG_FUNNY_DG_04", DIALOG_FUNNY_DG_05: "DIALOG_FUNNY_DG_05", DIALOG_FUNNY_DG_06: "DIALOG_FUNNY_DG_06", DIALOG_FUNNY_MC_01: "DIALOG_FUNNY_MC_01", DIALOG_FUNNY_MC_02: "DIALOG_FUNNY_MC_02", DIALOG_FUNNY_MC_03: "DIALOG_FUNNY_MC_03", DIALOG_FUNNY_MC_04: "DIALOG_FUNNY_MC_04", DIALOG_FUNNY_MC_05: "DIALOG_FUNNY_MC_05", DIALOG_FUNNY_MC_06: "DIALOG_FUNNY_MC_06", DIALOG_FUNNY_MC_07: "DIALOG_FUNNY_MC_07", DIALOG_FUNNY_DO6_01: "DIALOG_FUNNY_DO6_01", DIALOG_FUNNY_DO6_02: "DIALOG_FUNNY_DO6_02", DIALOG_FUNNY_DO6_03: "DIALOG_FUNNY_DO6_03", DIALOG_FUNNY_DO6_04: "DIALOG_FUNNY_DO6_04", DIALOG_FUNNY_DO6_05: "DIALOG_FUNNY_DO6_05", DIALOG_FUNNY_01: "DIALOG_FUNNY_01", DIALOG_FUNNY_02: "DIALOG_FUNNY_02", DIALOG_FUNNY_03: "DIALOG_FUNNY_03", DIALOG_FUNNY_04: "DIALOG_FUNNY_04", DIALOG_FUNNY_05: "DIALOG_FUNNY_05", DIALOG_FUNNY_06: "DIALOG_FUNNY_06", DIALOG_FUNNY_07: "DIALOG_FUNNY_07", DIALOG_FUNNY_08: "DIALOG_FUNNY_08", DIALOG_FUNNY_09: "DIALOG_FUNNY_09", DIALOG_FUNNY_10: "DIALOG_FUNNY_10", DIALOG_FUNNY_11: "DIALOG_FUNNY_11", DIALOG_FUNNY_12: "DIALOG_FUNNY_12", DIALOG_FUNNY_13: "DIALOG_FUNNY_13", DIALOG_FUNNY_14: "DIALOG_FUNNY_14", DIALOG_FUNNY_15: "DIALOG_FUNNY_15", DIALOG_FUNNY_16: "DIALOG_FUNNY_16", DIALOG_FUNNY_17: "DIALOG_FUNNY_17", DIALOG_FUNNY_18: "DIALOG_FUNNY_18", DIALOG_FUNNY_19: "DIALOG_FUNNY_19", DIALOG_FUNNY_20: "DIALOG_FUNNY_20", DIALOG_FUNNY_21: "DIALOG_FUNNY_21", DIALOG_FUNNY_22: "DIALOG_FUNNY_22", DIALOG_FUNNY_23: "DIALOG_FUNNY_23", DIALOG_FUNNY_24: "DIALOG_FUNNY_24", DIALOG_FUNNY_25: "DIALOG_FUNNY_25", DIALOG_FUNNY_26: "DIALOG_FUNNY_26", DIALOG_FUNNY_27: "DIALOG_FUNNY_27", DIALOG_FUNNY_28: "DIALOG_FUNNY_28", DIALOG_FUNNY_29: "DIALOG_FUNNY_29", DIALOG_FUNNY_30: "DIALOG_FUNNY_30", DIALOG_FUNNY_31: "DIALOG_FUNNY_31", DIALOG_FUNNY_32: "DIALOG_FUNNY_32", DIALOG_FUNNY_33: "DIALOG_FUNNY_33", DIALOG_FUNNY_34: "DIALOG_FUNNY_34", DIALOG_FUNNY_35: "DIALOG_FUNNY_35", DIALOG_FUNNY_36: "DIALOG_FUNNY_36", DIALOG_FUNNY_37: "DIALOG_FUNNY_37", DIALOG_FUNNY_38: "DIALOG_FUNNY_38", DIALOG_FUNNY_39: "DIALOG_FUNNY_39", DIALOG_FUNNY_40: "DIALOG_FUNNY_40", DIALOG_FUNNY_41: "DIALOG_FUNNY_41", DIALOG_FUNNY_42: "DIALOG_FUNNY_42", DIALOG_FUNNY_43: "DIALOG_FUNNY_43", DIALOG_FUNNY_44: "DIALOG_FUNNY_44" }; const pe = { characterSlot: { fontFamily: "grandstander", color: E.white.hash, fontSize: "24px", stroke: E.character_slot_name.hash, strokeThickness: 5, wordWrap: { width: 80, advanced: !0 }, align: "center" }, button_sub_big: { fontFamily: "grandstander", fontSize: "18px", align: "center", wordWrap: { advanced: !0, width: 100 } }, button_sub_small: { fontFamily: "grandstander", fontSize: "14px", align: "center" }, inputText: { fontFamily: "grandstander", fontSize: "42px", align: "center" }, nameLabel: { fontFamily: "grandstander", fontStyle: "bold", fontSize: "14px" }, button: { fontFamily: "grandstander", fontStyle: "bold", fontSize: "20px", align: "center" }, button_small: { fontFamily: "grandstander", fontStyle: "bold", fontSize: "14px", align: "center" }, button_big: { fontFamily: "grandstander", color: E.black.hash, fontSize: "64px", align: "center", stroke: E.overlay_black.hash, strokeThickness: 5 }, sharelink: { fontFamily: "grandstander", fontStyle: "bold", fontSize: "14px", align: "center", color: E.overlay_black.hex }, share_bubble: { fontFamily: "grandstander", fontStyle: "bold", fontSize: "14px", align: "center", color: E.button_pink_default.hash, wordWrap: { width: 80, advanced: !0 } }, title: { fontFamily: "grandstander", fontSize: "64px", fontWeight: 600, align: "center" }, small_light: { color: "#FFFFFF", fontFamily: "grandstander", fontSize: "16px", align: "center" }, normal: { color: "#000000", fontFamily: "grandstander", fontSize: "16px", align: "center", wordWrap: { advanced: !0, width: 270 } }, normal_highlight: { color: "#0000EE", stroke: "#0000EE", strokeThickness: 1, fontFamily: "grandstander", fontSize: "16px", align: "center" }, result: { fontFamily: "grandstander", fontStyle: "bold" }, character_button: { fontFamily: "grandstander", fontSize: "20px", align: "center" }, START_BUTTON: { fontFamily: "grandstander", fontSize: "22px", align: "center", fontStyle: "bold", wordWrap: { advanced: !0, width: 90 } }, NOTIFICATION_TITLE: { fontFamily: "grandstander", fontSize: "48px", fontWeight: 600, align: "center" }, notification_text: { fontFamily: "grandstander", color: E.overlay_black.hash, fontSize: "40px", wordWrap: { width: 620, advanced: !0 }, align: "center" }, notification_button: { fontFamily: "grandstander", color: E.white.hash, fontSize: "36px", wordWrap: { width: 400, advanced: !0 }, align: "center" }, download_button: { fontFamily: "grandstander", color: E.download.hash, fontStyle: "bold", fontSize: "14px", wordWrap: { width: 80, advanced: !0 } }, notification_bubble: { fontFamily: "grandstander", color: E.white.hash, fontSize: "42px", align: "center" }, version_text: { fontStyle: "bold", color: "#024481", fontFamily: "grandstander", fontSize: "12px", align: "center" }, dialog: { fontFamily: "grandstander", color: E.input_field_main_text.hash, fontStyle: "bold", fontSize: "90px", align: "center", wordWrap: { width: 500, advanced: !0 } }, tos_button: { fontFamily: "grandstander", fontSize: "28px", fontWeight: 600, fontStyle: "bold", align: "center" }, funnyTextDialog: { fontFamily: "grandstander", color: E.dialog_funny.hash, fontStyle: "bold", fontSize: "18px", align: "center", wordWrap: { width: 400, advanced: !0 } } }; class be extends Phaser.GameObjects.Container { constructor(e, t, s) { super(e, t, s), this.previousColor = new Phaser.Display.Color, this.currentColor = new Phaser.Display.Color, this.defaultTint = { r: 255, g: 255, b: 255 }, this.pressedTint = { r: 200, g: 200, b: 200 }, this.alpha = 1, this.down = !1, this.callback = null, this.context = null } setDefaultTint(e) { return this.defaultTint = { r: e.r, g: e.g, b: e.b }, this.pressedTint = { r: e.r - 50, g: e.g - 50, b: e.b - 50 }, this } removeInteractive() { this.button.removeInteractive() } createImage(e, t, s) { var i = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : 1; e = new Phaser.GameObjects.Image(this.scene, 4 < arguments.length && void 0 !== arguments[4] ? arguments[4] : 0, 5 < arguments.length && void 0 !== arguments[5] ? arguments[5] : 0, e, t); return this.lastCreateImage = e, this.assignClickEvents(e), e.setScale(i), this.add(e), s && (this.button = e, this.button.setTint(Phaser.Display.Color.GetColor(this.defaultTint.r, this.defaultTint.g, this.defaultTint.b)), this.button.alpha = this.alpha), this } createToggleImage(e, t, s, i) { return this.toggleKeys = t, this.toggledImage = new Phaser.GameObjects.Image(this.scene, 0, 0, e, this.toggleKeys[0]), this.assignClickEvents(this.toggledImage), this.toggledImage.setScale(i), this.add(this.toggledImage), this } toggleImage(e) { this.toggleKeys && (e ? this.toggledImage.setFrame(this.toggleKeys[1]) : this.toggledImage.setFrame(this.toggleKeys[0])) } createText(e, t, s, i) { return this.text = new Phaser.GameObjects.Text(this.scene, e, t, s, i).setOrigin(.5, .5).setAlign("center"), this.add(this.text), this } setText(e) { this.text && this.text.setText() } createTextBackground(e, t) { return this.textBackground = new Phaser.GameObjects.Graphics(this.scene, e, t), this.updateBackgroundSize(), this.add(this.textBackground), this.sendToBack(this.textBackground), this } updateBackgroundSize() { var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : this.text.displayWidth + 20, t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : 18, s = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : 30; this.textBackground.clear(), this.textBackground.fillStyle(E.button_text_background.hex, 1), this.textBackground.fillRoundedRect(.5 * -e, s - .5 * t, e, t, 8) } createHitbox(e, t) { this.hitbox = new Phaser.GameObjects.Rectangle(this.scene, 0, 0, e, t, void 0, 0), this.add(this.hitbox) } useHitbox() { this.assignClickEvents(this.hitbox) } createGradient(e, t) { this.gradientBackground = new Phaser.GameObjects.Image(this.scene, 0, 0, e, t), this.add(this.gradientBackground), this.sendToBack(this.gradientBackground) } createIcon(e, t, s, i) { return this.icon = new Phaser.GameObjects.Image(this.scene, e, t, "ui", s).setOrigin(.5).setScale(i), this.add(this.icon), this } addGraphic(e, t) { return this.add(e), t && (this.button = e), this } addGameObject(e) { return this.add(e), this } setButtonSize(e, t) { this.button.input.hitArea.setTo(0, 0, e, t), this.button.setScale(e / this.button.width, t / this.button.height) } setCallback(e, t) { return this.callback = e, this.context = t, this } removeCallback() { this.callback = null, this.context = null } assignClickEvents(e) { return e.setInteractive().on("pointerdown", this.onDown, this).on("pointerup", this.onUp, this).on("pointerout", this.onOut, this), this } onDown() { this.down = !0, this.previousColor.setTo(this.defaultTint.r, this.defaultTint.g, this.defaultTint.b), this.currentColor.setTo(this.pressedTint.r, this.pressedTint.g, this.pressedTint.b), this.scene.tweens.addCounter({ from: 0, to: 1, duration: be.DURATION, onUpdate(e) { e = e.getValue(); var t = Math.floor(this.previousColor.r + e * (this.currentColor.r - this.previousColor.r)), s = Math.floor(this.previousColor.g + e * (this.currentColor.g - this.previousColor.g)); e = Math.floor(this.previousColor.b + e * (this.currentColor.b - this.previousColor.b)); this.button.setTint && this.button.setTint(Phaser.Display.Color.GetColor(t, s, e)) }, onUpdateScope: this }) } onUp() { this.down && (this.onOut(), "function" == typeof this.callback) && this.callback.call(this.context) } onOut() { this.down && (this.down = !1, this.previousColor.setTo(this.pressedTint.r, this.pressedTint.g, this.pressedTint.b), this.currentColor.setTo(this.defaultTint.r, this.defaultTint.g, this.defaultTint.b), this.scene.tweens.addCounter({ from: 0, to: 1, duration: be.DURATION, onUpdate(e) { e = e.getValue(); var t = Math.floor(this.previousColor.r + e * (this.currentColor.r - this.previousColor.r)), s = Math.floor(this.previousColor.g + e * (this.currentColor.g - this.previousColor.g)); e = Math.floor(this.previousColor.b + e * (this.currentColor.b - this.previousColor.b)); this.button.setTint && this.button.setTint(Phaser.Display.Color.GetColor(t, s, e)) }, onUpdateScope: this })) } } be.DURATION = 100; class ye extends be { constructor(e, t, s, i) { super(e, t, s), this.createButton(), this.setCallback(this.confirm, this), this.setDepth(i) } createButton() { this.defaultTint = { r: E.overlay_black.r, g: E.overlay_black.g, b: E.overlay_black.b }, this.pressedTint = { r: E.white.r, g: E.white.g, b: E.white.b }, this.createImage("ui", "rounded-rectangle", !0), this.createBackground(115, 35, 5), this.button.alpha = .1, this.createText(me.skip_button), this.setScale(r.instance.gameScale.y) } createBackground(e, t, s) { this.background = new Phaser.GameObjects.Graphics(this.scene), this.background.lineStyle(2, 16777215, 1).strokeRoundedRect(-e / 2, -t / 2, e, t, s), this.background.displayWidth = e, this.background.displayHeight = t, this.add(this.background) } createText(e) { this.text = new Phaser.GameObjects.Text(this.scene, 0, 0, e, (void 0).small_light).setOrigin(.5), this.add(this.text) } confirm() { o.instance.playSound("main-audio", "okaybutton", this.scene), He.instance.skipTutorial(), x.instance.sendGAEvent(x.GA_EVENTS.DESIGN, "button-press:skipTutorial"), this.destroy(!0) } } const Se = 0, _e = 2, fe = 3, we = 4, Ce = 5, ve = 6, Te = 7, ke = 8, xe = 12, De = 20, Oe = 22; class Ae extends Phaser.GameObjects.Container { constructor(e, t, s) { super(e, t, s), this.create(), this.tweenHeart(), r.instance.emitter.on("resize", this.onResize, this) } create() { this.dialogBackground = new Phaser.GameObjects.Image(this.scene, 0, 0, "ui", "dialog window").setScale(1), this.arrow = new Phaser.GameObjects.Image(this.scene, 0, this.dialogHeight / 2, "ui", "dialog-arrow").setOrigin(.5, 0).setScale(.4), this.heart = new Phaser.GameObjects.Image(this.scene, 0, 0, "ui", "heart-small").setTint(E.input_field_main_text.hex).setPosition(this.dialogBackground.displayWidth / 2 * .7, this.dialogHeight / 2 * .6).setScale(.4), this.text = new Phaser.GameObjects.Text(this.scene, 0, -10, "", pe.dialog).setOrigin(.5), this.add([this.dialogBackground, this.arrow, this.heart, this.text]), this.setAlignment(-1), this.toggleWindow(!1) } toggleWindow(e) { this.setVisible(e) } setText(e) { this.text && this.text.setText(e) } tweenHeart() { var e = this.heart.scaleX; this.scene.tweens.add({ targets: this.heart, scaleX: { from: +e, to: .8 * e }, scaleY: { from: +e, to: .8 * e }, duration: 600, ease: Phaser.Math.Easing.Sine.InOut, yoyo: !0, loop: -1 }) } setAlignment(e) { this.arrow.setPosition(this.dialogBackground.displayWidth / 2 * .5 * e, this.arrow.y) } toggleArrow(e) { this.arrow.setVisible(e) } tweenWindow(e) { this.onResize(r.instance.gameSize, r.instance.gameScale); var t = this.scaleY; this.hoverTween && this.hoverTween.stop(), this.scene.tweens.add({ targets: this, onStart: () => { this.toggleWindow(!0), this.setScale(0) }, scale: { from: 0, to: +t, duration: 450 }, x: { from: e.x - .8 * this.dialogBackground.displayWidth, to: e.x, duration: 450 }, y: { from: e.y + this.dialogBackground.displayHeight, to: e.y, duration: 600, ease: Phaser.Math.Easing.Back.Out }, ease: Phaser.Math.Easing.Sine.Out }), this.hoverWindow(600) } hoverWindow(e) { var t = { x: this.dialogWindow.x, y: this.dialogWindow.y }; this.hoverTween && this.hoverTween.stop(), this.hoverTween = this.scene.tweens.add({ targets: this.dialogWindow, startDelay: e, y: { to: t.y - .2 * this.dialogBackground.displayHeight, from: t.y, ease: Phaser.Math.Easing.Sine.InOut }, duration: 1200, loop: -1, yoyo: !0 }) } onResize(e, t) { this.setScale(t.y), this.setPosition(this.basePosition.x, this.basePosition.y) } get basePosition() { return Ie.instance.basePosition } } class Ie extends n { constructor() { super(), this.emitter = new Phaser.Events.EventEmitter } init(e) { this.scene = e, this.maxTextSize = 90, this.currentLine = 0, this.setLines() } createDialog() { this.dialogWindow = new Ae(this.scene, 0, 0).setDepth(Oe), this.scene.add.existing(this.dialogWindow), this.setText(this.lines[this.currentLine]), this.dialogWindow.onResize(r.instance.gameSize, r.instance.gameScale) } nextLine() { this.mainName ? (this.setLines(), this.currentLine++, this.currentLine >= this.lines.length || (2 === this.currentLine ? this.dialogWindow.toggleArrow(!1) : this.dialogWindow.toggleArrow(!0), this.setText(this.lines[this.currentLine]), this.tweenWindow(this.basePosition))) : window.setTimeout(() => { this.nextLine() }, 1) } setLines() { this.lines = ["Hey there! Let's create the perfect match!\nWhat is your name?", `Ah, Right. ${this.mainName} it is! And what do you look like?`, "Here is where you can pick a character.\nYou can even edit them!", "Beautifull !\nLet's see if this person also thinks so...", `How does ${this.subName} look like?`], this.positions = [this.centerPosition, this.centerPosition, this.bottomPosition, this.centerPosition, this.centerPosition] } get mainName() { if (this.scene) return Vt.instance.screens.nameInputScreen.form.getValue() } get subName() { if (this.scene) return Vt.instance.screens.nameInputScreen.formTwo.getValue() } updateNameText() { this.setLines(), this.setText(this.lines[this.currentLine]) } setText(e) { this.dialogWindow.setText(e) } get dialogHeight() { return this.dialogBackground.displayHeight - 34 * this.dialogBackground.scaleY } get dialogTextHeight() { return .6 * this.dialogHeight } get basePosition() { return this.positions[this.currentLine] } get centerPosition() { return { x: 180 * r.instance.gameScale.y, y: .58 * r.instance.height } } get bottomPosition() { return { x: .5 * r.instance.width, y: .88 * r.instance.height } } } const Ne = "nameInputScreen", Ee = "previewScreen", Pe = "customisationScreen", Be = "TOSScreen", Le = "NotificationScreen", Ge = "settingsScreen", Fe = "languageScreen"; class Re { constructor(e, t) { this.id = e, this.emitter = new Phaser.Events.EventEmitter, this.nextStepID = t, this.tasks = [], this.isComplete = !1, this.parentStep = void 0, this.subStepOf = void 0, this.handPosition = Phaser.Math.Vector2.ZERO } get scene() { return He.instance.scene } start() { } finish() { } addTask(e) { this.tasks.push(e) } tasksComplete() { return 0 === this.tasks.length || this.completedTaskAmount() === this.tasks.length } checkTasksComplete() { this.tasksComplete() && He.instance.nextStep() } complete() { this.isComplete = !0, this.parentStep ? (this.parentStep.checkTasksComplete(), this.finish()) : He.instance.nextStep() } completedTaskAmount() { return this.tasks.filter(e => 1 == e.isComplete).length } } class Ve extends Re { constructor(e, t) { super(e, t) } start() { super.start(), window.tt ? Vt.instance.openScreen(Le) : Vt.instance.openScreen(Be), window.setTimeout(() => { Vt.instance.screens.nameInputScreen.deactivateElements() }, 100) } finish() { super.finish(), He.instance.skipButton && He.instance.skipButton.setVisible(!0) } } class Me extends Re { constructor(e, t) { super(e, t), this.subStepOf = de } start() { super.start(), this.scene.homeButton.toggleHighlight(!0); var e = this.scene.homeButton.getWorldTransformMatrix(), t = r.instance.gameScale.y; this.handPosition = new Phaser.Math.Vector2(e.tx + .3 * this.scene.homeButton.button.displayWidth * t, e.ty - .35 * this.scene.homeButton.button.displayHeight * t), He.instance.animateHand(this.handPosition), He.instance.hand.setVisible(!0) } finish() { super.finish(), this.scene.homeButton.toggleHighlight(!1) } } class Ue extends Re { constructor(e, t) { super(e, t), this.subStepOf = le } start() { super.start() } finish() { super.finish() } } class ze extends Re { constructor(e, t) { super(e, t) } start() { super.start() } finish() { super.finish() } } class je extends Re { constructor(e, t) { super(e, t), this.subStepOf = ce } start() { super.start() } finish() { super.finish() } } class He extends n { constructor() { super(), this.emitter = new Phaser.Events.EventEmitter, this.steps = {}, this.currentStep = null, this.markedForNextScene = !0, this.firstStep = q, this.lastStep = ue, this.completedSteps = [], this.skippedTutorial = !1, window.tm = this } init(e) { this.scene = e, O.instance.emitter.on("localUserDataLoaded", () => { this.skippedTutorial || (this.markedForNextScene = !0) }), this.createSteps(), this.initStartingStep(), this.recentTimeStamp = this.getTimeStamp() } set scene(e) { this._scene = e, this.hand && (this.hand.destroy(), delete this.hand, console.log("DELETED HAND")) } get scene() { return this._scene } createSteps() { x.instance.hasFeature("TOS") && this.addStep(new Ve(q, ce)), this.addStep(new ze(ce, le)), this.addStep(new je(le, de)), this.addStep(new Ue(de, ue)), this.addStep(new Me(ue)) } addStep(e) { this.steps[e.id] = e } initStartingStep() { O.instance.getData("skippedTutorial"); var e = O.instance.getData("completedTutorialSteps"); this.skippedTutorial || e && 0 !== e.length || this.setStep(this.firstStep) } checkTutorialNeeded(e) { if (!this.hasTutorialFinished() && this.markedForNextScene && this.currentStep && !O.instance.getData("skippedTutorial")) { this.scene = e, r.instance.emitter.on("resize", this.onResize, this), this.createVisuals(), this.currentStep.id === this.firstStep && this.updateCompletedSteps(), this.markedForNextScene = !1; try { this.currentStep.start() } catch (e) { this.skippedTutorial || (this.markedForNextScene = !0) } } } skipTutorial() { this.skippedHere = !0, this.skippedTutorial = !0, this.markedForNextScene = !1, O.instance.setData({ skippedTutorial: !0 }), Ie.instance.currentLine = Ie.instance.lines.length, this.currentStep.skippedHere = !0; try { Object.values(this.steps).forEach(e => { 0 < e.tasks.length ? e.tasks.forEach(t => { this.finishStep(e.id, t.category) }) : this.finishStep(e.id) }) } catch (e) { console.error(e) } this.scene.nameInputScreen && this.scene.nameInputScreen.visible && (this.scene.nameInputScreen.setPlaceholdersVisible(), this.scene.nameInputScreen.enableScreen()), this.scene.nameInputScreen && !this.scene.nameInputScreen.visible && (this.scene.startButtonTweens(), window.setTimeout(() => { Ie.instance.toggleWindow(!1), this.scene.nameInputScreen.setPlaceholdersVisible() }, 2)), this.scene.characterSelectScreen.enableBackButton() } animateHand(e) { var t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : 1; this.hand || this.createHand(), this.hand.setPosition(e.x, e.y).setVisible(!0).setScale(Math.abs(this.hand.scaleX) * t, this.hand.scaleY), this.totalDuration = 400, this.isIn = !1, this.handTweenPosition = this.scene.add.tween({ targets: this.hand, y: { from: this.hand.y - 20, to: this.hand.y }, duration: this.totalDuration, repeatDelay: 10, ease: Phaser.Math.Easing.Sine.InOut, yoyo: !0, repeat: 1, loop: -1, loopDelay: 300 }), this.handTweenAngle = this.scene.add.tween({ targets: this.hand, angle: { from: 0, to: -40 * t }, duration: this.totalDuration, ease: Phaser.Math.Easing.Sine.InOut, repeatDelay: 10, yoyo: !0, repeat: 1, loop: -1, loopDelay: 300 }) } stopHand() { this.handTweenAngle && this.handTweenPosition && (this.handTweenAngle.stop(), this.handTweenPosition.stop(), this.hand.setVisible(!1)) } continueHand() { this.handTweenAngle && this.handTweenPosition && (this.handTweenAngle.play(), this.handTweenPosition.play(), this.hand.setVisible(!0)) } setHandVisible(e) { this.hand && this.hand.setVisible(e) } hasTutorialFinished() { this.latestStep === this.lastStep && (this.currentStep = void 0, this.skipButton) && this.skipButton.setVisible(!1) } updateCompletedSteps() { this.savedSteps = O.instance.getData("completedTutorialSteps"), this.completedSteps = this.savedSteps || [], 0 !== this.completedSteps.length && (this.latestStep = this.completedSteps[this.completedSteps.length - 1], this.latestStep && this.latestStep.id && (this.latestStep = this.latestStep.id), this.currentStep.finish(), this.latestStep ? this.setStep(this.getMainStep(this.steps[this.latestStep].nextStepID)) : this.setStep(q)) } getMainStep(e) { var t; return e ? (t = this.steps[e]).subStepOf ? (this.savedSteps.pop(), this.getMainStep(t.subStepOf)) : e : this.latestStep } setStep(e) { this.currentStep = this.steps[e] } nextStep() { try { this.currentStep ? this.currentStep.tasksComplete() || !0 !== this.skippedTutorial ? (this.currentStep.finish(), this.skippedTutorial ? this.skippedHere && (this.skippedHere = !1, this.addCompletedStep(void 0, !0)) : this.addCompletedStep(), O.instance.setData({ completedTutorialSteps: this.completedSteps }), x.instance.sendGAEvent(x.GA_EVENTS.DESIGN, "tutorial:stepStarted:" + this.currentStep.id), this.currentStep.nextStepID && this.steps[this.currentStep.nextStepID] ? (this.currentStep = this.steps[this.currentStep.nextStepID], this.currentStep.start()) : this.finishTutorial()) : this.currentStep.tasks[this.currentStep.completedTaskAmount()].complete(!0) : console.warn("no current step, can't continue") } catch (e) { console.warn("error occured in tutorial", e), this.skippedTutorial || (this.markedForNextScene = !0) } } addCompletedStep() { var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : this.currentStep, t = { id: e.id, duration: this.getDurationSincePrevious(), skippedTutorial: this.skippedTutorial, succes: !0 }; this.skippedTutorial && (t.succes = !1), x.instance.sendGAEvent(x.GA_EVENTS.DESIGN, "tutorial:stepCompleted:" + e.id), this.completedSteps.push(t) } finishStep(e, t) { if (this.currentStep && this.currentStep.id === e) { let s = this.currentStep; t ? (e = this.currentStep.tasks.find(e => e.id === t)) && (s = e).complete() : s.complete() } } finishTutorial() { } getTimeStamp() { return Phaser.Math.RoundTo(window.performance.now(), 0) } getDurationSincePrevious() { var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : this.recentTimeStamp, t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : this.getTimeStamp(); e = Phaser.Math.RoundTo(t - e, 0); return this.recentTimeStamp = t, e } createVisuals() { this.createHand(), Ie.instance.createDialog() } createHand() { console.log("addingHand"), this.hand = new Phaser.GameObjects.Image(this.scene, 0, 0, "ui", "tutorial-hand").setOrigin(.15, .2).setAngle(0).setPosition(100, 100).setVisible(!1).setScale(r.instance.gameScale.y), this.scene.add.existing(this.hand), this.hand.setDepth(Oe) } createSkipButton() { this.skipButton = new ye(this.scene, 0, 0, De), this.scene.add.existing(this.skipButton), this.skipButton.setVisible(!1).setDepth(De).setScale(0), this.setSkipButtonPositon("bottomCenter") } onResize(e, t) { this.hand && this.hand.setScale(t.y), this.resizeSkipButton(t) } resizeSkipButton(e) { if (this.skipButton && Vt.instance.screenBorder) { var t = 10 * e.y, s = (this.skipButton.setScale(e.y), this.skipButton.background.displayWidth / 2 * this.skipButton.scaleX), i = this.skipButton.background.displayHeight / 2 * this.skipButton.scaleY; switch (this.skipButton.buttonPosition) { case "bottomCenter": this.skipButton.setVisible(!0).setPosition(Vt.instance.screenBorder.getWorldTransformMatrix().tx, r.instance.height - i - t); break; case "bottomLeft": this.skipButton.setVisible(!0).setPosition(Vt.instance.screenBorder.getWorldTransformMatrix().tx - Vt.instance.screenBorder.displayWidth / 2 + s + t, r.instance.height - i - t); break; case "leftCenter": this.skipButton.setVisible(!1).setPosition(Vt.instance.screenBorder.getWorldTransformMatrix().tx - Vt.instance.screenBorder.displayWidth / 2 + s + t, this.scene.shadow.getWorldTransformMatrix().ty - i - t); break; default: console.error(this.skipButton.buttonPosition, " no case") } } } setSkipButtonPositon(e) { r.instance.gameScale, this.skipButton.buttonPosition = e } setSkipButtonDepth(e) { this.skipButton.setDepth(e) } } class Ye extends n { constructor() { super(), this.swapped = !1 } retrieveCharactersData() { this.characterCollection = { defaultCharacters: J, customCharactersA: this.retrieveDataset("customCharactersA"), customCharactersB: this.retrieveDataset("customCharactersB") } } init(e) { this.scene = e, this.retrieveCharactersData() } saveCustomCharacter(e, t) { if (!this.checkCustomListFull(t)) return this.characterCollection[t].push(e), console.log(t), O.instance.setData({ [t]: this.characterCollection[t] }), this.characterCollection[t] } updateCustomCharacter(e, t) { var s = this.findInList(this.selectedCharacter, this.characterCollection[t]); return !!this.characterCollection[t][s] && (this.characterCollection[t].splice(s, 1, e), "customCharactersA" === t ? O.instance.setData({ customCharactersA: this.characterCollection[t] }) : O.instance.setData({ customCharactersB: this.characterCollection[t] }), !0) } setOriginalCharacter(e) { this.originalCharacterData = { ...e } } setSelectedCharacter(e) { this.selectedCharacter = { ...e } } retrieveDataset(e) { return O.instance.getData(e) || [] } getCharacterFromDataset(e, t) { try { return this.characterCollection[e][t] } catch (e) { return this.characterCollection.defaultCharacters[0] } } getListFromDataset(e) { return this.characterCollection[e] } checkCustomListFull(e) { return this.characterCollection[e].length >= Ye.MAX_FAVOURITES } findInList(e, t) { return t.findIndex(t => this.compareObjects(t, e)) } compareObjects(e, t) { let s = !0; return Object.values(e).forEach((e, i) => { 0 < Object.values(e).length ? this.compareObjects(e, Object.values(t)[i]) || (s = !1) : e !== Object.values(t)[i] && (s = !1) }), s } } Ye.MAX_FAVOURITES = 6; var We = [{ name: "burning-building", id: 0, folder: "bb", scale: .4, offset: { x: 0, y: 0 }, meterOffset: { x: -32, y: 80 }, meterEndOffset: { x: -32, y: -830 }, meter: { beginAnim: "bb_meter_begin" }, soundFolder: "bb", sounds: ["general", "bb"], beginAnimationName: "bb_begin", spineObjects: [{ key: "scenario_6_background", json: "bb_background.json", atlas: "bb_background.atlas", type: "background" }, { key: "scenario_6_main_character", json: "character_1.json", atlas: "character_1.atlas", type: "mainCharacter" }, { key: "scenario_6_secondary_character", json: "character_1.json", atlas: "character_1.atlas", type: "secondaryCharacter" }, { key: "scenario_6_foreground", json: "bb_foreground.json", atlas: "bb_foreground.atlas", type: "background" }], outcomes: [{ min: 0, max: 25, key: "bb_end_1", type: "bad", loopKey: "bb_end_1_loop" }, { min: 25, max: 50, key: "bb_end_1", type: "bad", loopKey: "bb_end_1_loop" }, { min: 50, max: 75, key: "bb_end_4", type: "good", loopKey: "bb_end_4_loop" }, { min: 75, max: 100, key: "bb_end_4", type: "good", loopKey: "bb_end_4_loop" }], background: { topLeft: 4774112, topRight: 4774112, bottomLeft: 4044525, bottomRight: 4044525 } }, { name: "lightning", id: 1, folder: "ln", scale: .4, offset: { x: 0, y: 0 }, soundFolder: "", sounds: ["general", "ln"], meterOffset: { x: 0, y: 0 }, meterEndOffset: { x: 0, y: 0 }, meter: { beginAnim: "ln_meter_begin" }, beginAnimationName: "ln_begin", spineObjects: [{ key: "scenario_2_background_1", json: "ln_background.json", atlas: "ln_background.atlas", type: "background" }, { key: "scenario_2_main_character", json: "character_1.json", atlas: "character_1.atlas", type: "mainCharacter" }, { key: "scenario_2_secondary_character", json: "character_1.json", atlas: "character_1.atlas", type: "secondaryCharacter" }, { key: "scenario_2_foreground_2", json: "ln_foreground.json", atlas: "ln_foreground.atlas", type: "background" }], outcomes: [{ min: 0, max: 25, key: "ln_end_1", type: "bad", loopKey: "ln_end_1_loop" }, { min: 25, max: 50, key: "ln_end_1", type: "bad", loopKey: "ln_end_1_loop" }, { min: 50, max: 75, key: "ln_end_4", type: "good", loopKey: "ln_end_4_loop" }, { min: 75, max: 100, key: "ln_end_4", type: "good", loopKey: "ln_end_4_loop" }], background: { topLeft: 4774112, topRight: 4774112, bottomLeft: 4044525, bottomRight: 4044525 } }, { name: "dogs", id: 2, folder: "dg", scale: .4, offset: { x: 0, y: 0 }, soundFolder: "", sounds: ["general", "dg"], meter: { beginAnim: "dg_meter_begin" }, meterOffset: { x: 0, y: 0 }, meterEndOffset: { x: 0, y: 0 }, beginAnimationName: "dg_begin", spineObjects: [{ key: "scenario_3_background", json: "dg_background.json", atlas: "dg_background.atlas", type: "background" }, { key: "scenario_3_main_character", json: "character_1.json", atlas: "character_1.atlas", type: "mainCharacter" }, { key: "scenario_3_secondary_character", json: "character_1.json", atlas: "character_1.atlas", type: "secondaryCharacter" }, { key: "scenario_3_dog_1", json: "dog_1.json", atlas: "dog_1.atlas", type: "background" }, { key: "scenario_3_dog_2", json: "dog_2.json", atlas: "dog_2.atlas", type: "background" }, { key: "scenario_3_foreground", json: "dg_foreground.json", atlas: "dg_foreground.atlas", type: "background" }], outcomes: [{ min: 0, max: 25, key: "dg_end_1", type: "bad", loopKey: "dg_end_1_loop" }, { min: 25, max: 50, key: "dg_end_1", type: "bad", loopKey: "dg_end_1_loop" }, { min: 50, max: 75, key: "dg_end_4", type: "good", loopKey: "dg_end_4_loop" }, { min: 75, max: 100, key: "dg_end_4", type: "good", loopKey: "dg_end_4_loop" }], background: { topLeft: 4774112, topRight: 4774112, bottomLeft: 4044525, bottomRight: 4044525 } }, { name: "double-oh-six", id: 3, folder: "d06", scale: .4, offset: { x: 0, y: 0 }, soundFolder: "", sounds: ["general", "d06"], meter: { beginAnim: "d06_meter_begin" }, meterOffset: { x: 0, y: 0 }, meterEndOffset: { x: 0, y: 0 }, beginAnimationName: "d06_begin", spineObjects: [{ key: "scenario_4_background", json: "./d06_background.json", atlas: "./d06_background.atlas", type: "background" }, { key: "scenario_4_main_character", json: "./character_1.json", atlas: "./character_1.atlas", type: "mainCharacter" }, { key: "scenario_4_secondary_character", json: "./character_1.json", atlas: "./character_1.atlas", type: "secondaryCharacter" }, { key: "scenario_4_foreground", json: "./d06_foreground.json", atlas: "./d06_foreground.atlas", type: "background" }], outcomes: [{ min: 0, max: 25, key: "d06_end_1", type: "bad", loopKey: "d06_end_1_loop" }, { min: 25, max: 50, key: "d06_end_1", type: "bad", loopKey: "d06_end_1_loop" }, { min: 50, max: 75, key: "d06_end_4", type: "good", loopKey: "d06_end_4_loop" }, { min: 75, max: 100, key: "d06_end_4", type: "good", loopKey: "d06_end_4_loop" }], background: { topLeft: 4774112, topRight: 4774112, bottomLeft: 4044525, bottomRight: 4044525 } }, { name: "mountain-climber", id: 4, folder: "mc", scale: .4, offset: { x: 0, y: 0 }, soundFolder: "", sounds: ["general", "mc"], meter: { beginAnim: "mc_meter_begin" }, meterOffset: { x: 0, y: 0 }, meterEndOffset: { x: 0, y: 0 }, beginAnimationName: "mc_begin", spineObjects: [{ key: "scenario_5_background", json: "./mc_background.json", atlas: "./mc_background.atlas", type: "background" }, { key: "scenario_5_main_character", json: "./character_1.json", atlas: "./character_1.atlas", type: "mainCharacter" }, { key: "scenario_5_secondary_character", json: "./character_1.json", atlas: "./character_1.atlas", type: "secondaryCharacter" }, { key: "scenario_5_foreground", json: "./mc_foreground.json", atlas: "./mc_foreground.atlas", type: "background" }], outcomes: [{ min: 0, max: 25, key: "mc_end_1", type: "bad", loopKey: "mc_end_1_loop" }, { min: 25, max: 50, key: "mc_end_1", type: "bad", loopKey: "mc_end_1_loop" }, { min: 50, max: 75, key: "mc_end_4", type: "good", loopKey: "mc_end_4_loop" }, { min: 75, max: 100, key: "mc_end_4", type: "good", loopKey: "mc_end_4_loop" }], background: { topLeft: 4774112, topRight: 4774112, bottomLeft: 4044525, bottomRight: 4044525 } }]; class Ke extends be { constructor(e, t, s) { super(e, t, s), this.createButton(), this.createText(), r.instance.emitter.on("resize", this.onResize, this) } createButton() { this.surroundingImage = new Phaser.GameObjects.Image(this.scene, 0, 0, "ui", "fx-heart-outline"), this.surroundingImage.setTint(E.input_field_main_text.hex),this.add(this.surroundingImage),this.createImage("ui","bg-heart-small",!0)}createText(){this.text=new Phaser.GameObjects.Text(this.scene,0,-10,"?",pe.START_BUTTON).setTint("0xFFFFFF").setOrigin(.5,.5),this.add(this.text)}activateButton(){this.button.setFrame("bg-heart-big"),this.surroundingImage.setVisible(!0),this.setCallback(this.startScenario,this),this.text.text=me.START_BUTTON,this.text.setPosition(0,-10),He.instance.currentStep===ce&&He.instance.setHandVisible(!0),this.startTweens()}deactivateButton(){this.button.setFrame("bg-heart-small"),this.surroundingImage.setVisible(!1),this.text.setScale(1),this.text.setPosition(0,-5),this.removeCallback(),this.text.text="?",this.heartgrow&&(this.heartgrow.stop(),this.heartgrow=void 0),this.heartbeat&&(this.heartbeat.stop(),this.heartbeat=void 0),He.instance.currentStep===ce&&He.instance.setHandVisible(!1)}startTweens(){this.heartgrow||(this.heartgrow=this.scene.tweens.addCounter({from:1,to:0,duration:1e3,onUpdate(e){e=e.getValue(),this.surroundingImage.alpha=e,this.surroundingImage.setScale(1.3-.6*e)},onUpdateScope:this,loop:-1})),this.heartbeat||(this.heartbeat=this.scene.tweens.addCounter({from:0,to:2*Math.PI,duration:1e3,onUpdate(e){e=e.getValue(),this.button.setScale(.95+.05*Math.cos(e-Math.PI)),this.text.setScale(.95+.05*Math.cos(e-Math.PI))},onUpdateScope:this,loop:-1}))}async startScenario(){try{var{form:e,formTwo:t,mainCarousel:s,secondaryCarousel:i}=this.parentContainer;if(!e.isValid()||!t.isValid())return;He.instance.finishStep(ce),N.instance.updatePlaythrough(ce),O.instance.setData({mainCharacter:s.getCurrentData(),secondaryCharacter:i.getCurrentData()}),Mt.instance.setPlayerData(!0,s.getCurrentData().options),Mt.instance.setPlayerData(!1,i.getCurrentData().options),x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"button-press:startScenario"),this.checkIfPresets(),this.checkCustomisationItems()}catch(e){console.error(e)}this.removeInteractive(),o.instance.playSound("main-audio","okaybutton",this.scene),this.parentContainer.disableElements();let a=null;try{for(;(a=We[Math.floor(Math.random()*We.length)]).id===this.scene.previousScenarioID;);}catch(e){a=We[0]}await x.instance.levelStart(a.name),this.scene.fadeOut(a.id)}checkCustomisationItems(){const e=Mt.instance.mainCharacterData.options,t=Mt.instance.secondaryCharacterData.options;var s=Ye.instance.characterCollection.customCharactersA.map(e=>JSON.stringify(e)),i=Ye.instance.characterCollection.customCharactersB.map(e=>JSON.stringify(e));s.includes(JSON.stringify(e))&&Object.keys(e).forEach(t=>{var s=e[t].id;x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,`itemUsed:${t}:`+s)}),i.includes(JSON.stringify(t))&&Object.keys(t).forEach(e=>{var s=t[e].id;x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,`itemUsed:${e}:`+s)})}checkIfPresets(){var e=Mt.instance.checkIsPreset(!0),t=Mt.instance.checkIsPreset(!1);let s="bothCreated";e&&t?s="bothPreset":(e&&!t||!e&&t)&&(s="oneOfEach"),x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"charactersUsed:"+s)}onResize(e,t){this.setPosition(0,40*t.y),this.setScale(t.y)}}class Xe extends be{constructor(e,t,s){super(e,t,s),this.createButton(),this.setCallback(this.swapCharacters,this),r.instance.emitter.on("resize",this.onResize,this)}createButton(){this.defaultTint={r:E.button_pink_default.r,g:E.button_pink_default.g,b:E.button_pink_default.b},this.pressedTint={r:E.button_pink_pressed.r,g:E.button_pink_pressed.g,b:E.button_pink_pressed.b},this.buttonStroke=new Phaser.GameObjects.Image(this.scene,0,4,"ui","button-round-stroke"),this.add(this.buttonStroke),this.createImage("ui","button-round-fill",!0),this.swapIcon=new Phaser.GameObjects.Image(this.scene,0,0,"ui","icon-swap"),this.add(this.swapIcon)}deactivateButton(){this.removeCallback(),this.alpha=.3}activateButton(){this.setCallback(this.swapCharacters,this),this.alpha=1}swapCharacters(){this.parentContainer.form.checkBadWords()&&this.parentContainer.formTwo.checkBadWords()&&(o.instance.playSound("main-audio","randombutton",this.scene),this.button.disableInteractive(),this.rotateButton(),N.instance.updatePlaythrough(ge),x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"button-press:swap"),Vt.instance.screens.nameInputScreen.onSwap())}rotateButton(){this.scene.tweens.addCounter({to:"-=540",onUpdate(e){e=e.getValue(),this.swapIcon.angle=e},onUpdateScope:this,duration:500,ease:Phaser.Math.Easing.Sine.InOut})}onResize(e,t){this.setScale(t.y),this.setPosition(120*t.y,40*t.y)}}class Je extends Phaser.GameObjects.Sprite{constructor(e,t){super(e,0,0,"ui","logo-long"),this.scene=e,this.pressCounter=0,this.setOrigin(.5,-.5),this.setInteractive(),this.setDepth(t),this.createEventListeners(),r.instance.emitter.on("resize",this.onResize,this),this.setVisible(x.instance.hasFeature("logo"))}createEventListeners(){this.on("pointerup",()=>{this.onLogoClick()})}show(){this.setVisible(!0),this.savedScale=this.scaleY,this.setScale(0,0),this.scene.tweens.add({targets:this,duration:500,scale:{from:0,to:this.savedScale},ease:Phaser.Math.Easing.Back.Out})}onResize(e,t){this.setScale(t.y),this.setPosition(0,-e.height/2+20*t.y)}onLogoClick(){x.instance.hasFeature("logoLink")&&navigator&&(this.link="https://lovetester.com/",window.navigator.share({title:"Lovetester.com",text:"",url:this.link}).then(e=>{e&&(0<e.length?console.warn("Shared successfully with activity"):console.warn("Share was aborted"))}).catch(e=>{console.error("Share failed:",e)}))}}t=s(178);var qe=s.n(t),Ze=(t=s(132),s.n(t)),Qe=(t=s(179),s.n(t)),$e=(t=s(180),s.n(t));class et extends Phaser.GameObjects.Container{constructor(e){var t=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};super(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0),this.content=[],this.options={...this.defaultOptions,...t},this.setEvents(),this.createPanel(),this.panel.layout()}get defaultOptions(){return{scrollMode:0,isFixWidth:!0,x:0,y:20,width:380,height:640,mouseWheelScroller:{focus:!0,speed:.85},space:{left:16,right:0,top:30,bottom:0,panel:10,header:10,footer:10},thumbConfig:{x:0,y:0,width:16,height:200,rounding:8,color:E.slider.hex},gridSpace:{left:0,right:0,top:0,bottom:0,item:5,line:5},scroller:{backDeceleration:1e3,pointerOutRelease:!0,dragRate:1/r.instance.dpr}}}get slider(){var{x:e,y:t,width:s,height:i,rounding:a,color:n}=this.options.thumbConfig;return this.track=new Ze.a(this.scene,e,t,s,i,a,E.white.hex),this.thumb=new Ze.a(this.scene,e,t,s,i,a,n),{track:this.track,thumb:this.thumb,hideUnscrollableSlider:!0,adaptThumbSize:!0}}setEvents(){r.instance.emitter.on("resize",this.onResize,this),this.on("destroy",this.onDestroy,this)}onResize(){}onDestroy(){}toggleSlider(e){this.track.setVisible(e),this.thumb.setVisible(e)}createPanel(){this.panel=new qe.a(this.scene,{...this.options,panel:{child:this.createGrid(),mask:{mask:!0,padding:1}},slider:this.slider}),this.add(this.panel),this.setDepth(1e24)}setInteractivity(){var e=this.panel.getElement("scroller"),t=this.panel.getElement("mouseWheelScroller");e.off("dragend"),e.off("dragstart"),t.off("scroll"),this.panel.addedEvents||(this.panel.addedEvents=!0,this.panel.setDepth(1e24).setChildrenInteractive().addListener("child.click",e=>{e.select()}).addListener("scroll",e=>{this.parentContainer.onScroll(e)})),e.on("dragend",e=>{this.parentContainer.onScrollEnd(e)}),e.on("dragstart",e=>{this.parentContainer.onScrollStart(e)}),t.on("scroll",e=>{this.parentContainer.onMouseWheelScrollEnd(e)}),this.panel.layout()}createGrid(){var e=this.options.gridSpace;return this.sizer=this.options.isFixWidth?this.sizer=new Qe.a(this.scene,{space:e}):new $e.a(this.scene,{space:e}),this.add(this.sizer),this.sizer}addItems(e,t){if(e&&e.length)for(let i=0;i<e.length;i++){var s=e[i];s.name=this.content.length,this.content.splice(t,0,s),this.addAt(s,t),this.sizer.add(s,{expand:!0,index:t}),s.setVisible(!0)}}}class tt extends n{playEvent(e){e=e.data.name.split(":"),o.instance.playSound(this.atlasKey,e[1])}setAtlasKey(e){this.atlasKey=e}}class st extends Phaser.GameObjects.Container{constructor(e,t,s){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;super(e,0,0),this.createShadow(s),this.createSpine(t),null!=i&&this.play(i,!0),this.gender=null,this.isBald=!1,this.dance=null,this.bodySlots=[{slot:"head",attachment:"head-1"},{slot:"head",attachment:"head-2"},{slot:"head",attachment:"head-3"},{slot:"head",attachment:"head-4"},{slot:"head",attachment:"head-5"},{slot:"head",attachment:"head-6"},{slot:"hair-facial-back",attachment:"stubble-1"},{slot:"hair-facial-back",attachment:"stubble-2"},{slot:"hair-facial-back",attachment:"stubble-3"},{slot:"hair-facial-back",attachment:"stubble-4"},{slot:"hair-facial-back",attachment:"stubble-5"},{slot:"hair-facial-back",attachment:"stubble-6"},{slot:"body"},{slot:"r-arm-upper"},{slot:"r-arm-lower"},{slot:"l-arm-upper"},{slot:"l-arm-lower"},{slot:"r-arm-hand",attachment:"hand-back-chill"},{slot:"r-arm-hand",attachment:"hand-back-closed"},{slot:"r-arm-hand",attachment:"hand-back-open"},{slot:"r-arm-hand",attachment:"hand-back-peace"},{slot:"r-arm-hand",attachment:"hand-back-rockstar"},{slot:"r-arm-hand",attachment:"hand-front-chill"},{slot:"r-arm-hand",attachment:"hand-front-closed"},{slot:"r-arm-hand",attachment:"hand-front-closed-2"},{slot:"r-arm-hand",attachment:"hand-front-open"},{slot:"r-arm-hand",attachment:"hand-front-peace"},{slot:"r-arm-hand",attachment:"hand-front-rockstar"},{slot:"l-arm-hand",attachment:"hand-back-chill"},{slot:"l-arm-hand",attachment:"hand-back-closed"},{slot:"l-arm-hand",attachment:"hand-back-open"},{slot:"l-arm-hand",attachment:"hand-back-peace"},{slot:"l-arm-hand",attachment:"hand-back-rockstar"},{slot:"l-arm-hand",attachment:"hand-front-chill"},{slot:"l-arm-hand",attachment:"hand-front-closed"},{slot:"l-arm-hand",attachment:"hand-front-closed-2"},{slot:"l-arm-hand",attachment:"hand-front-open"},{slot:"l-arm-hand",attachment:"hand-front-peace"},{slot:"l-arm-hand",attachment:"hand-front-rockstar"},{slot:"r-leg-upper"},{slot:"r-leg-lower"},{slot:"r-leg-foot"},{slot:"l-leg-upper"},{slot:"l-leg-lower"},{slot:"l-leg-foot"},{slot:"eyelid-animate",attachment:"eyelid-female-closed"},{slot:"eyelid-animate",attachment:"eyelid-female-med"},{slot:"eyelid-animate",attachment:"eyelid-female-short"},{slot:"eyelid-animate",attachment:"eyelid-male-closed"},{slot:"eyelid-animate",attachment:"eyelid-male-med"},{slot:"eyelid-animate",attachment:"eyelid-male-short"},{slot:"eyelid-med",attachment:"eyelid-female-med"},{slot:"eyelid-med",attachment:"eyelid-male-med"},{slot:"eyelid-short",attachment:"eyelid-female-short"},{slot:"eyelid-short",attachment:"eyelid-male-short"},{slot:"eyelid-closed",attachment:"eyelid-female-closed"},{slot:"eyelid-closed",attachment:"eyelid-male-closed"},{slot:"nose"}],this.selectedAttachments={},this.createPlaceholder()}createShadow(e){e&&(this.graphics=this.scene.make.graphics(),this.graphics.fillStyle(0,.1),this.graphics.fillEllipse(0,0,380,70),this.add(this.graphics))}get state(){return this.character.state}createSpine(e){this.character=this.scene.add.spine(0,0,e),this.character.key=e,this.animationList=this.character.getAnimationList(),this.character.on("event",this.onEvent,this),this.character.setSkinByName("Puppet"),this.nameBone=this.character.findBone("name"),this.add(this.character)}createPlaceholder(){this.characterPlaceholder=new Phaser.GameObjects.Image(this.scene,0,-350,"ui","bg-character-empty").setOrigin(.42,1).setScale(2).setAlpha(.4).setVisible(!1),this.add(this.characterPlaceholder)}toggleCharacter(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.character.setVisible(e),this.characterPlaceholder.setVisible(!e)}createMask(){this.shape=new Phaser.GameObjects.Graphics(this.scene),this.mask=this.shape.createGeometryMask(),this.setMask(this.mask)}updateMask(){var e;this.mask&&(e=this.getWorldTransformMatrix(),this.maskSize=200*e.scaleY,this.maskX=e.tx,this.maskY=e.ty-750*e.scaleY,this.shape.clear().arc(0,0,this.maskSize,0,2*Math.PI).fillPath(),this.shape.setPosition(this.maskX,this.maskY))}onEvent(e,t){var s;if(t.data.name.includes("sfx"))tt.instance.playEvent(t);else switch(t.data.name.includes("SetLayer")&&(s=t.data.name[t.data.name.length-1],this.character.parentContainer.moveTo(this.character,s)),t.data.name){case"EyeDefault":this.character.setAttachment("eyes",this.selectedAttachments.eyes.attachment);break;case"MouthDefault":this.character.setAttachment("mouth",this.selectedAttachments.mouth.attachment)}}getCharacter(){return this.character}startNextDance(e){this.character.setMix(this.character.getCurrentAnimation().name,e,.2),this.character.setAnimation(0,e,!0)}setSkinColor(e){this.skinColor=e,this.bodySlots.forEach(t=>{if(!t.slot.includes("brow")){this.setSelectedAttachment(t,e);try{let s=t.attachment||this.character.findSlot(t.slot).attachment.name.split("/").pop();((s=s.includes("arm-1")||s.includes("leg-1")?s.replace("1","upper"):s).includes("arm-2")||s.includes("leg-2"))&&(s=s.replace("2","lower")),this.character.getAttachmentByName(t.slot,s).color.set(e.gl[0],e.gl[1],e.gl[2],e.gl[3])}catch(e){console.error(e)}}})}setAttachment(e,t,s,i){if("no-hair-facial"===e.slot&&(e.id=0),"nose"!==e.slot||(t=this.skinColor)||i)if(Array.isArray(e))e.forEach(e=>this.setAttachment(e,t,s));else{"costume-accessories-hat"!==e.slot&&"costume-accessories-hat-back"!==e.slot||!e.attachment||(this.isBald&&!e.attachment.includes(st.BALD_KEY)?e.attachment=e.attachment.replace("-","-bald-"):!this.isBald&&e.attachment.includes(st.BALD_KEY)&&(e.attachment=e.attachment.replace(st.BALD_KEY,""))),"eyes"===e.slot&&(e.attachment.includes("female")?this.gender="female":this.gender="male"),this.setSelectedAttachment(e,e.color||t);try{this.character.setAttachment(e.slot,e.attachment)}catch(i){e.slot}this.setAttachmentColor(e.slot,e.color||t,s)}else setTimeout(()=>{this.setAttachment(e,t,s,!0)})}setAttachments(e){e&&Object.keys(e).forEach(t=>{var s=e[t];this.setAttachment({slot:t,attachment:s.attachment},s.color)})}setAttachmentColor(e,t,s){let i=t;s&&e.includes(s.key)&&(i=s.color),this.selectedAttachments[e]&&this.setSelectedAttachment({slot:e,attachment:this.selectedAttachments[e].attachment},t);try{var a;this.selectedAttachments[e].attachment&&(a=this.character.getAttachmentByName(e,this.selectedAttachments[e].attachment))&&a.color.set(i.gl[0],i.gl[1],i.gl[2],i.gl[3])}catch(e){console.error(e)}}setSelectedAttachment(e,t){this.selectedAttachments[e.slot]||(this.selectedAttachments[e.slot]={}),this.selectedAttachments[e.slot].attachment=e.attachment,this.selectedAttachments[e.slot].color=t}play(e,t){return this.character.play(e,t)}addAnimation(e,t,s){return this.animationList.includes(t),this.character.addAnimation(e,t,s)}playEndingAnimation(e,t){return this.character.setMix(e,this.dance,.2),e=this.character.setAnimation(1,e,!1),this.character.addAnimation(1,this.dance,!0,t),e}checkBald(){var e=this.isBald;this.isBald=!this.selectedAttachments["hair-top"].attachment||["11","12","16","17","23","24","25","26","27","29","30","31","32","33","34","39","40","41","42"].includes(this.selectedAttachments["hair-top"].attachment.slice(5,8)),e!==this.isBald&&this.updateHeadwear()}checkShape(){var e,t,s,i=this.selectedAttachments.head;i&&(e=this.selectedAttachments["hair-facial"]?this.selectedAttachments["hair-facial"].attachment:null,s=this.selectedAttachments["hair-facial-back"]?this.selectedAttachments["hair-facial-back"].attachment:null,t=this.selectedAttachments["no-hair-facial"],s&&!e&&(s=i.attachment.slice(5,6),this.setAttachment({slot:"hair-facial-back",attachment:"stubble-"+s,color:i.color})),t)&&t.attachment&&this.setAttachment({slot:"hair-facial-back",attachment:null,color:i.color})}updateHeadwear(){this.selectedAttachments["costume-accessories-hat"]&&(this.setAttachment({slot:"costume-accessories-hat",attachment:this.selectedAttachments["costume-accessories-hat"].attachment},this.selectedAttachments["costume-accessories-hat"].color),this.setAttachment({slot:"costume-accessories-hat-back",attachment:this.selectedAttachments["costume-accessories-hat-back"].attachment},this.selectedAttachments["costume-accessories-hat-back"].color))}onResize(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this.setScale(st.SCALE*e),this.setPosition(t,s)}}st.BALD_KEY="-bald",st.SCALE=.25,st.HEIGHT_MULTIPLIER=.44;class it extends Phaser.GameObjects.Container{constructor(e,t,s){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:-1;super(e,t,s),this.alignment=i,this.radius=14,this.buttonSpacing=10,this.characterScale=.16,this.characterYPos=74,this.width=84.8,this.height=179.2,this.popDuration=400,this.id=0,this.create(),this.states={customInactive:"customInactive",customActive:"customActive",presetInactive:"presetInactive",presetActive:"customActive"}}create(){this.slotContainer=new Phaser.GameObjects.Container(this.scene,0,0),this.add(this.slotContainer),this.createBackground()}toggleCustom(e){this.isCustom=e,!this._characterPlaceholder&&!0!==e||this.characterPlaceholder.setVisible(e),this._text&&this.text.setVisible(!1),e?(this._character&&this.character.options&&this.characterPlaceholder.setVisible(!1),this.renderTexture&&(this.renderTexture.destroy(),delete this.renderTexture),this.tweenColor(this.background,[E.character_slot_background_top.hex,E.character_slot_background_bot.hex],[E.character_SLOT_CUSTOM_background_top.hex,E.character_SLOT_CUSTOM_background_bot.hex])):(this._editButton&&this.editButton.setVisible(!1),this.tweenColor(this.background,[E.character_SLOT_CUSTOM_background_top.hex,E.character_SLOT_CUSTOM_background_bot.hex],[E.character_slot_background_top.hex,E.character_slot_background_bot.hex]))}show(){this.setVisible(!0)}hide(){this.setVisible(!1)}createBackground(){this.outline=new Phaser.GameObjects.Image(this.scene,0,0,"ui","characterslot_background_outline"),this.background=new Phaser.GameObjects.Image(this.scene,0,0,"ui","characterslot_background"),this.background.setScale(.8).setName("background"),this.outline.setScale(.8).setPosition(0,4).setName("outline"),this.slotContainer.add([this.outline,this.background])}get characterPlaceholder(){return this._characterPlaceholder||(this._characterPlaceholder=new Phaser.GameObjects.Image(this.scene,4,0,"ui","bg-character-empty").setScale(1.2).setName("placeholder"),this.slotContainer.add(this.characterPlaceholder)),this._characterPlaceholder}get text(){return this._text||(this._text=new Phaser.GameObjects.Text(this.scene,0,0,me.SLOT_CUSTOM,pe.characterSlot).setOrigin(.5).setName("text"),this.slotContainer.add([this._text])),this._text}get editButton(){return this._editButton||(this._editButton=new Phaser.GameObjects.Image(this.scene,34,80,"ui","button-new").setScale(0).setOrigin(.5).setName("editButton"),this.slotContainer.add([this.editButton])),this._editButton}get character(){return this._character||(this._character=this.scene.characterPool.pop().setName("character").setVisible(!0),this.updateSpine(),this.alignCharacter(),this.playAnimation("home_idle",!0),this.createMixes(),this.slotContainer.add(this._character)),this._character}recycleCharacter(){this.character&&(this.scene.characterPool.recycle(this.character),this.character.setVisible(!1),this.slotContainer.remove(this.character),delete this._character)}createMixes(){this.character.character.setMix("home_idle","interactions/wave",.2),this.character.character.setMix("interactions/wave","home_idle",.2)}setCharacterData(e){e&&(this.data={options:{...e}},this.togglePlaceHolder(!1))}togglePlaceHolder(e){!this._characterPlaceholder&&!0!==e||this.characterPlaceholder.setVisible(e),!this._text&&!0!==e||this.text.setVisible(e)}toggleSpineCharacter(e){this.setEditButton()}updateAlignment(e){this.alignment=e,this.alignCharacter()}alignCharacter(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.alignment,t=(this.character.scale!==this.characterScale&&this.character.setScale(this.characterScale),4*e);this.character.x===t&&this.character.y===this.characterYPos||this.character.setPosition(t,this.characterYPos),this.character.character.scaleX===e&&1===this.character.character.scaleY||this.character.character.setScale(e,1)}playAnimation(e,t){this.character.play(e,t)}addAnimation(e,t){this.character.addAnimation(0,e,t)}select(){var e,t,s;this.currentState===this.states.presetActive&&this.isCustom?(({previewScreen:t,customisationScreen:e}=Vt.instance.screens),({mainCharacter:t,secondaryCharacter:s}=t),t=this.isMain?t:s,this.character.visible?(Mt.instance.setCharacterCustomisation(t,this.data,this.isMain),Ye.instance.setSelectedCharacter(this.data.options)):(e.categoryBar.setCategory("hair"),Mt.instance.setCharacter(t),s=Mt.instance.randomizeCharacter(),Ye.instance.setSelectedCharacter(s)),this.openCustomisationScreen()):this.currentState===this.states.presetActive&&!this.isCustom||this.moveToMe()}get isMain(){return"main"===this.parentContainer.parentContainer.name}openCustomisationScreen(){Vt.instance.screens.previewScreen.toggleActiveCharacter(this.isMain),Vt.instance.swapScreens([Ne],[Ee,Pe])}openPreviewScreen(){Vt.instance.screens.previewScreen.toggleActiveCharacter(this.isMain),Vt.instance.swapScreens([Ne],[Ee])}createRenderTexture(e){this.isCustom||(this.useSpineRender?this.generateImage():(this.renderTexture||(this.renderTexture=new Phaser.GameObjects.Image(this.scene,0,0,"defaultCharacters",""+e),this.slotContainer.add(this.renderTexture)),this.renderTexture.setFrame(""+e)))}generateImage(){const e={renderTexture:!0};this.list[0].list.forEach(t=>{e[t.name]=t.visible,t.setVisible(!1)});var{width:t,height:s}=r.instance.gameSize;this.renderTexture=new Phaser.GameObjects.RenderTexture(this.scene,-t/2,-s/2,t,s),this.slotContainer.add(this.renderTexture),this.renderTexture.setOrigin(.5).draw(this,t/2,s/2).setDepth(1e21).setName("renderTexture").setPosition(0,0).snapshot(e=>{document.body.append(e)}),this.list[0].list.forEach(t=>{t.setVisible(e[t.name])})}moveToMe(){this.parentContainer.parentContainer.setActiveSlot(this.id),this.parentContainer.parentContainer.stopFocus(),this.parentContainer.parentContainer.focusOnSelection()}setState(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.states.presetInactive;if(this.currentState!==e)switch(this.currentState=e){case this.states.presetInactive:this.onPresetInactive();break;case this.states.presetActive:this.onPresetActive();break;case this.states.customInactive:this.onCustomInactive();break;case this.states.customActive:this.onCustomActive()}}onPresetInactive(){this.toggleSpineCharacter(),this.popInTween0&&(this.popInTween0.stop(),delete this.popInTween0),this.outline.setScale(.7),this.isCustom&&this.onCustomInactive()}popSlotIn(){this.data?(this.renderTexture&&this.renderTexture.setVisible(!0),this._character&&(this.character.setVisible(!1),this.recycleCharacter())):(this.characterPlaceholder.setVisible(!0),this.characterPlaceholder.setScale(1))}popSlotOut(){this.renderTexture&&this.renderTexture.setVisible(!0),this._character&&(this.character.setVisible(!1),this.recycleCharacter())}onPresetActive(){this.tweenPopIn(this.outline,.8),this.focusSlot(),this.isCustom?this.onCustomActive():(this.playAnimation("interactions/wave",!1),this.addAnimation("home_idle",!0))}onCustomInactive(){this.popInTween2&&(this.popInTween2.stop(),delete this.popInTween2),this.popInTween3&&(this.popInTween3.stop(),delete this.popInTween3),this.slotContainer.bringToTop(this._editButton),this.editButton.setScale(0),this.editButton.setVisible(!1),this.text.setScale(0),this.tweenObjectScale("placeholder",this.characterPlaceholder,0,1.4,1.2,Phaser.Math.Easing.Back.Out)}updateSpine(){this.data&&this._character&&Mt.setCharacterOptions(this._character,this.data.options)}setEditButton(){this.isCustom&&this._character&&this._character.visible?this.editButton.setFrame("button-edit"):this.editButton.setFrame("button-new")}onCustomActive(){this.text.setVisible(!1),this.slotContainer.bringToTop(this.editButton),this.editButton.setVisible(!0),this.character.setVisible(!1),window.setTimeout(()=>{this.character.visible||this.text.setVisible(!0),this.tweenPopIn(this.text,.9,2),this.tweenPopIn(this.editButton,.9,3),this.tweenObjectScale("placeholder",this.characterPlaceholder,0,1.2,1.4,Phaser.Math.Easing.Back.Out)},2)}forceDeselect(){this.selected=!1}deselect(){this.toggleSelected()}focusSlot(){this.parentContainer.bringToTop(this)}unfocusSlot(){this.parentContainer.sendToBack(this)}tweenObjectScale(e,t,s,i,a,n){let o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:()=>{},r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:()=>{};var h=8<arguments.length&&void 0!==arguments[8]?arguments[8]:this.popDuration;!this[""+e+s]&&t&&(this[""+e+s]=this.scene.tweens.add({onStart:()=>{t.setScale(i),o()},targets:t,scale:{from:i,to:a*this.scaleY},delay:100*s,duration:h,ease:n,onComplete:()=>{r(),delete this[""+e+s]}}))}tweenObjectPosition(e,t,s,i,a,n){let o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:()=>{},r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:()=>{};!this[""+e+s]&&t&&(this[""+e+s]=this.scene.tweens.add({onStart:()=>{o()},targets:t,y:{from:i,to:a},delay:100*s,duration:this.popDuration,ease:n,onComplete:()=>{r(),delete this[""+e+s]}}))}tweenAlpha(e,t,s,i,a,n){let o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:()=>{},r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:()=>{};!this[""+e+s]&&t&&(this[""+e+s]=this.scene.tweens.add({onStart:()=>{t.setVisible(!0),t.setAlpha(i),o()},targets:t,alpha:{from:i,to:a},delay:100*s,duration:this.popDuration,ease:n,onComplete:()=>{r(),delete this[""+e+s]}}))}tweenPopIn(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;let s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!this["popInTween"+s]&&e&&(this["popInTween"+s]=this.scene.tweens.add({onStart:()=>{e.setScale(0)},targets:e,scale:{from:0,to:t},delay:100*s,duration:this.popDuration,ease:Phaser.Math.Easing.Back.Out,onComplete:()=>{delete this["popInTween"+s]}}))}tweenPopOut(e,t){let s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:()=>{};this["popOutTween"+t]||(this["popOutTween"+t]=this.scene.tweens.add({onStart:()=>{e.setVisible(!0),e.setScale(1)},targets:e,scale:{from:+this.scaleY,to:0},delay:100*t,duration:this.popDuration,ease:Phaser.Math.Easing.Back.In,onComplete:()=>{s(),delete this["popOutTween"+t]}}))}tweenColor(e,t,s){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:()=>{};e.tintFill=!0;const a=Phaser.Display.Color.ValueToColor(t[0]),n=Phaser.Display.Color.ValueToColor(t[1]),o=Phaser.Display.Color.ValueToColor(s[0]),r=Phaser.Display.Color.ValueToColor(s[1]);this.scene.tweens.addCounter({from:0,to:1,targets:e,duration:this.popDuration,onUpdate:t=>{t=t.getValue();var s=Phaser.Math.Linear(a.r,o.r,t),i=Phaser.Math.Linear(a.g,o.g,t),h=Phaser.Math.Linear(a.b,o.b,t),c=Phaser.Math.Linear(n.r,r.r,t),l=Phaser.Math.Linear(n.g,r.g,t);t=Phaser.Math.Linear(n.b,r.b,t),s=Phaser.Display.Color.GetColor(s,i,h),i=Phaser.Display.Color.GetColor(c,l,t);e.setTintFill(s,s,i,i)},onComplete:i})}}class at{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:6;this.scene=e,this.pool=[],this.totalCreated=0,this.defaultAmount=t}pop(){return 0===this.pool.length&&this.createDefault(),this.pool.pop()}recycle(e){this.pool.push(e)}push(e){this.totalCreated++,this.pool.push(e)}createDefault(){}}class nt extends at{constructor(e){super(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1),this.createDefault()}createDefault(){for(let e=0;e<this.defaultAmount;e++)this.push(new it(this.scene,0,0,1));super.createDefault()}}class ot extends Phaser.GameObjects.Container{constructor(e,t,s,i,a){super(e,t,s),this.name=i,this.objectPool=a,this.slotDisplayWidth=110,this.useCulling=!0,this.dataKey="main"===i?"customCharactersA":"customCharactersB","customCharactersA"===this.dataKey&&Ye.instance.swapped?this.dataKey="customCharactersB":"customCharactersB"===this.dataKey&&Ye.instance.swapped&&(this.dataKey="customCharactersA"),r.instance.emitter.on("resize",this.onResize,this),this.setCullingSettings(),this.create()}setCullingSettings(){this.defaultWidth=75,this.cullingSizeRange={maxLeft:-100,maxRight:100,left:-120,right:120,min:.6,max:1};var e=this.defaultWidth/120;this.inBetweenScale=this.cullingSizeRange.max-(this.cullingSizeRange.max-this.cullingSizeRange.min)*e*e}create(){Ye.instance.retrieveCharactersData(),this.getCustomData(),this.createScrollView(),this.createDefaultSlots(),this.fillSlotsData(),this.updatePanel(),this.scrollView.toggleSlider(!1)}createScrollView(){this.scrollView=new et(this.scene,0,0,{scrollMode:1,isFixWidth:!1,x:0,y:20,width:r.MAXIMUM_WIDTH,height:0,mouseWheelScroller:{focus:!0,speed:.1},space:{left:0,right:0,top:0,bottom:0,panel:0,header:0,footer:0},gridSpace:{left:150,right:150,top:0,bottom:0,item:5,line:5,align:"center"},thumbConfig:{x:0,y:0,width:16,height:16,rounding:8,color:E.slider.hex}}),this.add(this.scrollView)}createCustomSlot(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=this.addSlot(e);return t.toggleCustom(!0),t.id=e,t}createDefaultSlots(){this.defaultData=this.getSlotData("defaultCharacters");var e=this.defaultData.length-(this.scrollView.content.length-this.customSlots);for(let t=0;t<=Math.abs(e)-1;t++)e<0&&this.recycleSlot(),0<e&&this.addSlot(t)}getSlotData(e){let t=[];return Ye.instance.characterCollection[e]?t=Ye.instance.characterCollection[e]:(t=StorageManager.instance.getData(e),Array.isArray(t)||(t=[])),t}getOrdedSlotData(e){return e.sort((e,t)=>null===e?1:null===t?-1:0)}getCustomData(){return this.customData=this.getOrdedSlotData([...this.getSlotData(this.dataKey)]),this.customSlots=this.customData.length,this.customData}get isLess(){return this.customSlots<3}getSlot(e){return this.scrollView.content[e]}fillSlotsData(){this.getCustomData(),this.countID=0,"main"===this.name?(this.fillCustomData(),this.countID<3&&this.countID++,this.fillDefaultData()):(this.fillDefaultData(),this.fillCustomData())}fillDefaultData(){for(let t=0;t<this.defaultData.length;t++,this.countID++){let s=this.scrollView.content[this.countID];var e=this.defaultData[t];(s=s||this.addSlot(this.countID)).toggleCustom(!1),this.setSlot(s,t,e),s.id=this.countID}}fillCustomData(){for(let t=0;t<this.customData.length&&t<3;t++,this.countID++){let s=this.scrollView.content[this.countID];var e=this.customData[t];(s=s||this.addSlot(this.countID)).toggleCustom(!0),this.setSlot(s,this.countID,e),s.id=this.countID}var t=this.customData.length;if(this.customData.length<3){if(t===this.previousLength)return;this.createCustomSlot(this.countID,!1)}this.previousLength=t}getCurrentData(){var e=this.scrollView.content[this.activeSlot];return e?(e.isCustom&&!1===e.character.visible&&(e.data=null),e.data):null}updatePanel(){this.scrollView.setInteractivity(),this.scrollView.panel.layout()}updateSpine(){for(let e=0;e<this.scrollView.content.length;e++)this.scrollView.content[e].updateSpine()}addSlot(e){var t=this.objectPool.pop();return this.scrollView.addItems([t],e),t.setVisible(!0),t.i=e,t}setSlot(e,t,s){e.slotData=s,e.setCharacterData(s),e.createRenderTexture(t)}recycleSlot(){let e;(e="main"===this.name?this.scrollView.content.pop():this.scrollView.content.shift()).background.clearTint(),this.scrollView.remove(e),this.scrollView.sizer.remove(e),e.setVisible(!1),e.data=void 0,this.objectPool.push(e)}onScroll(){this.checkCullingUneven?this.checkCullingUneven=!1:(this.checkCullingUneven=!0,this.checkCulling())}onScrollEnd(){this.stopFocus(),this.checkScrollEnd()}onMouseWheelScrollEnd(e){this.stopFocus(),this.setActiveSlot(Phaser.Math.Clamp(this.activeSlot+(0<e?1:-1),0,this.scrollView.content.length-1)),this.focusOnSelection()}onScrollStart(){this.stopFocus()}stopFocus(){this.focusTween&&(this.focusTween.stop(),delete this.focusTween)}checkScrollEnd(){window.setTimeout(()=>{var e=this.scrollView.panel.getElement("scroller")._value;this.previousValue===e?this.focusOnSelection():(this.previousValue=e,this.checkScrollEnd())},150)}checkCulling(){var e=this.cullingSizeRange;for(let i=0;i<this.scrollView.content.length;i++){var t=this.scrollView.content[i],s=t.x;this.setSlotState(s,t,i),this.resizeSlot(s,t,e),this.cullEdges(s,t,e)}try{this.scrollView.panel.layout()}catch(e){}}setSlotState(e,t,s){-39<e&&e<39?(t.setState(t.states.presetActive),this.setActiveSlot(t.id)):t.setState(t.states.presetInActive)}setActiveSlot(e){this.ignoreSetActiveSlot?setTimeout(()=>{this.ignoreSetActiveSlot=!1}):this.activeSlot=e}resizeSlot(e,t,s){var i=s.max-s.min;let a=s.max;e&&0!==e&&(e=Phaser.Math.Clamp(e,s.left,s.right),e=Math.abs(e)/s.right,a=s.max-i*e*e),t.slotContainer.setScale(a),s=75*a,t.width=s}cullEdges(e,t,s){this.useCulling&&(e>s.maxLeft&&e<s.maxRight?t.states.presetActive?(t.renderTexture&&t.renderTexture.setVisible(!1),t.data&&(t.toggleSpineCharacter(!0),t.character.setVisible(!0))):t.popSlotIn():(t.popSlotOut(),t.unfocusSlot(),t.isCustom&&t.data&&(t.toggleSpineCharacter(!0),t.character.setVisible(!0))))}focusOnSelection(e){var t=this.activeSlot,s=this.scrollView.content.length-1;let i=t/s||0;var a=Math.max(this.cullingSizeRange.min*(s-2),0)+this.inBetweenScale*Math.min(s,2);i=1.01*((i=0!==t&&t!==s?(Math.max(this.cullingSizeRange.min*(t-1),0)+(0<t?this.inBetweenScale:0))/a:i)-.5)+.5,this.tweenToFocus(i,e),this.parentContainer&&this.parentContainer.checkMatchReady()}tweenToFocus(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:600;t<=0?(this.ignoreSetActiveSlot=!0,this.scrollView.panel.setT(e),this.focusOnSelection(),this.activeSlot<0&&(this.activeSlot=3),this.scrollView.content[this.activeSlot].focusSlot()):this.focusTween=this.scene.tweens.addCounter({from:this.scrollView.panel.t,to:e,duration:t,ease:Phaser.Math.Easing.Circular.Out,onUpdate:e=>{this.scrollView.panel.setT(e.getValue())}})}onResize(e,t){this.scrollView.panel._scrollFactorX=1/r.instance.dpr,this.scrollView.panel._scrollFactorY=1/r.instance.dpr,e=e.width/t.y*.8,this.scrollView.panel.setMinSize(e,0),this.scrollView.sizer.space.left=e/2-42.4,this.scrollView.sizer.space.right=e/2-42.4,this.scrollView.panel.layout()}}class rt extends Phaser.GameObjects.Container{constructor(e,t,s,i,a,n){super(e,t,s),this.name=a,this.opacity=.9,this.hasUnderlay=n,this.originalDepth=i,this.origin={x:.5,y:.5},this.closingTime=0,this.create(),this.setEvents(),this.setDepth(i),this.on("destroy",this.onDestroy,this)}setEvents(){r.instance.emitter.on("resize",this.onResize,this)}removeEvents(){r.instance.emitter.off("resize")}create(){this.hasUnderlay&&(this.createUnderlay(),this.setUnderlay(this.opacity))}createUnderlay(){this.underlay=new Phaser.GameObjects.Rectangle(this.scene,0,0,100,100,E.overlay_black.hex,this.opacity),this.underlay.setInteractive({draggable:!0}),this.add(this.underlay)}setUnderlay(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.opacity,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r.instance.gameSize,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:r.instance.gameScale,i=r.instance.dpr;this.underlay.setDisplaySize(t.width/s.y*i*2,t.height/s.y*i*2),this.underlay.alpha=e}toggleVisibility(){this.visible?this.close():this.open()}open(){this.setVisible(!0),this.onOpen()}close(){this.setVisible(!1),this.onClose()}hardClose(){this.setVisible(!1)}async onOpen(){}async onClose(){}onBackgroundSelect(){}onResize(e,t){this.originalScale=t.y,this.setPosition(e.width*this.origin.x,e.height*this.origin.y),this.underlay&&this.setUnderlay(void 0,e,t)}onDestroy(){this.removeEvents()}}class ht extends Phaser.GameObjects.Graphics{constructor(e,t,s,i){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1;super(e,t.x,t.y),this.topLeftColor=s.topLeft,this.topRightColor=s.topRight,this.bottomLeftColor=s.bottomLeft,this.bottomRightColor=s.bottomRight,this.heightMultiplier=a,this.setDepth(i),r.instance.emitter.on("resize",this.onResize,this),this.on("destroy",this.onDestroy,this)}onDestroy(){r.instance.emitter.off("resize",this.onResize,this)}onResize(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:r.instance.gameSize,t=(this.clear(),this.fillGradientStyle(this.topLeftColor,this.topRightColor,this.bottomLeftColor,this.bottomRightColor,1),e).width;this.height=e.height*this.heightMultiplier,this.fillRect(-t/2,-this.height/2,t,this.height/2),this.fillGradientStyle(this.bottomLeftColor,this.bottomRightColor,this.bottomLeftColor,this.bottomRightColor,1),this.fillRect(-t/2,0,t,this.height/2)}}class ct extends n{constructor(){super(),this.key="settings",this.settings=O.instance.getData(this.key),this.validateData(),o.instance.musicVolume=this.settings.music,o.instance.sfxVolume=this.settings.sfx,o.instance.updateAllVolumes()}validateData(){let e,t;Object.keys(D.settings).forEach(s=>{e=typeof this.settings[s],t=typeof D.settings[s],e!=t&&(this.settings[s]=D.settings[s])})}get music(){return this.settings.music}set music(e){e!==this.settings.music&&(this.settings.music=e,o.instance.musicVolume=this.settings.music,o.instance.updateAllVolumes(),this.save())}get sfx(){return this.settings.sfx}set sfx(e){e!==this.settings.sfx&&(this.settings.sfx=e,o.instance.sfxVolume=this.settings.sfx,o.instance.updateAllVolumes(),this.save())}get language(){return this.settings.language}set language(e){e!==this.settings.language&&(this.settings.language=e,this.save())}saveSettings(){this.language=lt.instance.language,this.music=o.instance.musicVolume,this.sfx=o.instance.sfxVolume}save(){O.instance.setData({[this.key]:this.settings})}}class lt extends n{constructor(){super(),this.languages=["en","nl","de","es","pt","tr","ru"],[this.defaultLanguage]=this.languages,this.language=null,this.languageIndex=-1,this.emitter=new Phaser.Events.EventEmitter}init(){let e=ct.instance.language;try{this.languageSupported(e)||([e]=x.instance.getLocale().split("-"),this.languageSupported(e)?x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"language:supported:"+e):(x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"language:unsupported:"+e),e=this.defaultLanguage))}catch(t){console.error(t),e=this.defaultLanguage}this.setLanguage(e,!1)}setScene(e){return this.function&&this.scene.i18n.off("languageChanged",this.function),this.scene=e,this.function=this.onLanguageChanged.bind(this),this.scene.i18n.on("languageChanged",this.function),this}onLanguageChanged(){this.scene.i18n.recursiveUpdateText(this.scene)}languageSupported(e){return-1!==this.languages.indexOf(e)}async setLanguage(e,t){var s=this.languages.indexOf(e);s!==this.currentIndex&&-1!==s&&(this.languageIndex=s,this.language=this.languages[this.languageIndex],await this._changeLanguage(e,t))}async _changeLanguage(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];try{this.loading=!0,await this.scene.i18n.changeLanguage(e),this.emitter.emit("languageChanged"),this.loading=!1,t&&(ct.instance.language=this.language)}catch(e){console.error(e)}}get(e,t){return this.scene.i18n.t(e,t)}inject(){lt.inject(this.scene)}static inject(e){Object.getPrototypeOf(e.i18n).recursiveUpdateText=function(e){const t=this;if(e instanceof Phaser.GameObjects.Text||e instanceof Phaser.GameObjects.BitmapText||e instanceof Phaser.GameObjects.DynamicBitmapText)e.setText(e._i18nKey);else if(e instanceof Phaser.GameObjects.Container)e.list.forEach(e=>{t.recursiveUpdateText(e)});else if(e instanceof Phaser.GameObjects.DisplayList)e.list.forEach(e=>{t.recursiveUpdateText(e)});else if(e.children&&0<e.children.length)for(let i=0;i<e.children.length;i++){var s=e.children[i]||(e.children.list?e.children.list[i]:null);s&&t.recursiveUpdateText(s)}}}}class dt extends be{constructor(e,t){super(e),this.androidLink="https://play.google.com/store/apps/details?id=com.famobi.lovetesterstories",this.iOSLink="https://apps.apple.com/app/love-tester-stories/id6449258373",this.isHorizontal=t,this.setState(),this.link=null,this.linkOrigin=null,this.os=this.scene.sys.game.device.os,this.os.android||this.os.windows?(this.link=this.androidLink,this.linkOrigin="android"):this.os.iOS||this.os.macOS?(this.link=this.iOSLink,this.linkOrigin="ios"):(console.warn("Link not found",this.os),this.linkOrigin="android",this.link=this.androidLink),this.createButton(),this.setVisible(!1),this.setCallback(this.openStore,this),lt.instance.emitter.on("languageChanged",this.updateText,this),this.updateText(),r.instance.emitter.on("resize",this.onResize,this),this.on("destroy",this.onDestroy,this)}onDestroy(){lt.instance.emitter.off("languageChanged",this.updateText,this)}setState(){this.isHorizontal?(this.frame="ui-app-background-end-screen",this.logoScale=35/54,this.logoX=-60,this.logoY=-3,this.textX=20,this.textY=-4):(this.frame="ui-app-background-home-screen",this.logoScale=1,this.logoX=0,this.logoY=-22,this.textX=0,this.textY=28)}createButton(){this.createImage("ui",this.frame,!0),this.createText(this.textX,this.textY,me.DOWNLOAD_APP,pe.download_button),this.isHorizontal&&this.text.setWordWrapWidth(120),this.createImage("ui","logo-lovetester",!1,this.logoScale,this.logoX,this.logoY),this.text.originalFontSize=this.text.style.fontSize}updateText(){this.text.setFontSize(parseInt(this.text.originalFontSize,10)),this.isHorizontal?this.fitHeight(this.text,this.button.displayHeight):this.fitHeight(this.text,40)}fitHeight(e,t){for(;e.displayHeight>t;){var s=parseInt(e.style.fontSize,10)-1;e.setFontSize(s)}}openStore(){console.log(this.linkOrigin),_.instance.trackDesign("button-press:openAppstore:"+this.linkOrigin),window.open(this.link)}onResize(e,t){this.setScale(t.y),this.checkTween(t.y),this.setPosition(e.width/2,.875*e.height)}show(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;x.instance.hasFeature("downloadApp")&&((this.os.iOS||this.os.macOS)&&this.setVisible(!1),this.tween&&(this.tween.remove(),delete this.tween),this.setVisible(!0),e=this.scale,this.setScale(0,0),this.delay=t,this.tween=this.scene.tweens.add({targets:this,duration:500,delay:t,scale:{from:0,to:e},ease:Phaser.Math.Easing.Back.Out,onComplete:this.onComplete,onCompleteScope:this}))}checkTween(){var e;this.tween&&(this.tween.remove(),e=this.scale,this.setScale(0,0),this.tween=this.scene.tweens.add({targets:this,duration:500,delay:this.delay,scale:{from:0,to:e},ease:Phaser.Math.Easing.Back.Out,onComplete:this.onComplete,onCompleteScope:this}))}onComplete(){delete this.tween}}class ut extends be{constructor(e,t,s){super(e,t,s),this.createButton(),this.setCallback(this.openSettingsScreen,this),r.instance.emitter.on("resize",this.onResize,this)}createButton(){this.defaultTint=Phaser.Display.Color.IntegerToRGB(E.button_blue_default.hex),this.pressedTint=Phaser.Display.Color.IntegerToRGB(E.button_blue_pressed.hex),this.createImage("ui","button-round-stroke",!1,.75,0,2.5),this.createImage("ui","button-round-fill",!0,.75),this.createImage("ui","icon-setting",!1,1)}openSettingsScreen(){o.instance.playSound("main-audio","randombutton",this.scene),Vt.instance.openScreen(Ge)}onResize(e,t){this.setScale(t.y),this.setPosition(164*t.y,-345*t.y)}}class gt extends be{constructor(e,t,s){super(e,t,s),this.createButton(),this.setCallback(this.openLocalizationScreen,this),r.instance.emitter.on("resize",this.onResize,this),lt.instance.emitter.on("languageChanged",this.changeIcon,this),this.on("destroy",this.onDestroy,this)}onDestroy(){lt.instance.emitter.off("languageChanged",this.changeIcon,this)}createButton(){this.createImage("ui","button-round-stroke",!1,.745,0,3),this.createImage("ui","button-round-fill",!0,.75),this.createImage("ui","icon-"+lt.instance.language,!1,.52),this.icon=this.lastCreateImage}openLocalizationScreen(){o.instance.playSound("main-audio","randombutton",this.scene),Vt.instance.openScreen(Fe)}changeIcon(){this.file="icon-"+lt.instance.language,this.icon.setFrame(this.file)}onResize(e,t){this.setScale(t.y),this.setPosition(-164*t.y,-345*t.y)}}class mt extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s),this.initialize(),this.on("destroy",this.onDestroy,this)}onDestroy(){r.instance.emitter.off("resize",this.onResize,this)}initialize(){this.link=x.instance.getBrandingButtonImage(),!this.link||this.link.includes("transparen")?this.setVisible(!1):(this.loadImage(),this.subscribeEvents())}loadImage(){this.scene.load.on("filecomplete",this.showImage,this),this.scene.load.image("brandingButton",this.link),this.scene.load.start()}showImage(){this.image=new Phaser.GameObjects.Image(this.scene,0,0,"brandingButton"),this.image.setScale(.25),this.image.setInteractive(),this.image.on("pointerup",this.onClick,this),this.add(this.image)}onClick(){x.instance.openBrandingLink()}subscribeEvents(){}onResize(e,t){this.setScale(t.y)}}class pt extends rt{constructor(e,t,s,i){super(e,t,s,i,Ne),this.refocus=!0}createEventListeners(){this.on("destroy",this.destroy,this),Mt.instance.emitter.on("swapNames",this.swapFormValues,this),Mt.instance.emitter.on("setMainCharacterName",this.form.saveValue,this.form),Mt.instance.emitter.on("setSecondaryCharacterName",this.formTwo.saveValue,this.formTwo),Mt.instance.emitter.on("updateText",this.checkMatchReady,this)}create(){super.create(),this.createBackground(),this.createLogo(),this.characterSlotObjectPool=new nt(this.scene,52),this.createCharacterSelectCarousels(),this.createForms(),this.createStartButton(),this.createSwapButton(),this.createAppButton(),this.createNotificationButton(),this.checkMatchReady(),this.createEventListeners(),this.createSettingsButton(),this.createLocalizationButton()}createCharacterSelectCarousels(){this.mainCarousel=new ot(this.scene,0,0,"main",this.characterSlotObjectPool).setDepth(ke),this.secondaryCarousel=new ot(this.scene,0,0,"secondary",this.characterSlotObjectPool).setDepth(ke),this.add([this.mainCarousel,this.secondaryCarousel])}updateCarousels(e){e=e?this.mainCarousel:this.secondaryCarousel,this.updateCarousel(e)}updateCarousel(e){e.fillSlotsData(),e.updatePanel(),e.checkCulling(),e.updateSpine(),(e=e.customData.length)!==this.previousLength&&(this.previousLength=e)}createBackground(){this.background=new ht(this.scene,{x:0,y:0},{topLeft:E.background_top.hex,topRight:E.background_top.hex,bottomLeft:E.background_bot.hex,bottomRight:E.background_bot.hex},Se,1),this.add(this.background);var{width:e,height:t}=r.instance.gameSize;this.tiledSprite=new Phaser.GameObjects.TileSprite(this.scene,0,0,e,t,"ui","heart-tile").setTint(16777215).setAlpha(.1),this.addAt(this.tiledSprite,1),this.resizeTiledBackground()}createLogo(){this.logo=new Je(this.scene,_e),this.logo.setDepth(_e),this.add(this.logo)}createForms(){this.form=new zt(this.scene,0,0,200,50,"mainCharacterInput").activateElement().setDepth(Te).setFirstCharacterActive(),this.form.name="main",this.formTwo=new zt(this.scene,0,0,200,50,"secondaryCharacterInput").activateElement().setDepth(ke).setSecondCharacterActive(),this.formTwo.name="secondary",this.add([this.form,this.formTwo])}createStartButton(){this.startButton=new Ke(this.scene,0,0),this.startButton.setDepth(xe),this.add(this.startButton)}createSettingsButton(){this.settingsButton=new ut(this.scene,0,0),this.settingsButton.setDepth(xe),this.add(this.settingsButton)}createLocalizationButton(){this.localizationButton=new gt(this.scene,0,0),this.localizationButton.setDepth(xe),this.add(this.localizationButton)}createSwapButton(){this.swapButton=new Xe(this.scene,0,0).setDepth(fe),this.add(this.swapButton)}createNotificationButton(){window.tt&&(this.notificationButton=new be(this.scene).createImage("ui","icon-anouncement",!0,2).setCallback(()=>{Vt.instance.openScreen(Le)},this).setDepth(fe),this.add(this.notificationButton),this.createNotificationTween())}createNotificationTween(){this.notificationTween&&this.notificationTween.stop(),this.notificationButton.setAngle(0);var e=r.instance.gameScale.y;this.notificationTween=this.scene.tweens.add({targets:this.notificationButton,scale:{to:"+=0.2",from:.6*e*1},angle:-10,yoyo:!0,repeat:-1,duration:200,repeatDelay:1e3,ease:Phaser.Math.Easing.Back.Out})}createAppButton(){window.tt||window.cordova||(this.appButton=new dt(this.scene,!1),this.appButton.show(1e3),this.add(this.appButton))}swapFormValues(){var e=this.form.inputText.text,t=this.formTwo.inputText.text;this.form.setValue(t),this.formTwo.setValue(e)}checkMatchReady(){this.checkSwapButtonAvailable(),""===this.form.element.value||""===this.formTwo.element.value||null===this.mainCarousel.getCurrentData()||null===this.secondaryCarousel.getCurrentData()?this.startButton.deactivateButton():this.startButton.activateButton()}checkSwapButtonAvailable(){this.swapButton.activateButton()}onSwap(){try{var e=this.mainCarousel.getCurrentData(),t=this.secondaryCarousel.getCurrentData(),s=(this.mainCarousel.dataKey="customCharactersA"===this.mainCarousel.dataKey?"customCharactersB":"customCharactersA",this.secondaryCarousel.dataKey="customCharactersB"===this.mainCarousel.dataKey?"customCharactersA":"customCharactersB",this.mainCarousel.customData.length),i=this.secondaryCarousel.customData.length;let o,r=s-i;r<0?(o=this.secondaryCarousel,i<3&&--r):0<r&&(o=this.mainCarousel,s<3)&&(r+=1);for(let e=0;e<Math.abs(r);e++)o.recycleSlot();this.updateCarousels(!0),this.updateCarousels(!1);var a=[...this.mainCarousel.customData,...this.mainCarousel.defaultData].map(e=>JSON.stringify(e)),n=[...this.secondaryCarousel.defaultData,...this.secondaryCarousel.customData].map(e=>JSON.stringify(e));let h=this.mainCarousel.customData.length,c=n.length;t&&t.options&&(h=a.indexOf(JSON.stringify(t.options))),e&&e.options&&(c=n.indexOf(JSON.stringify(e.options))),this.mainCarousel.customData.length<3&&h>this.mainCarousel.customData.length&&(h+=1),this.mainCarousel.setActiveSlot(h),this.secondaryCarousel.setActiveSlot(c),this.mainCarousel.focusOnSelection(),this.secondaryCarousel.focusOnSelection(),this.tweenSwapOut(),this.checkMatchReady(),Ye.instance.swapped=!Ye.instance.swapped}catch(e){console.error(e)}}tweenSwapOut(){this.form.popTween(250),this.formTwo.popTween(250),this.scene.tweens.addCounter({from:0,to:window.innerWidth/2*r.instance.dpr,duration:250,onUpdateScope:this,onComplete:()=>{Mt.instance.swapCharacters(),this.tweenSwapIn()},ease:Phaser.Math.Easing.Sine.In})}tweenSwapIn(){this.scene.tweens.addCounter({from:window.innerWidth/2*r.instance.dpr,to:0,duration:250,onUpdateScope:this,ease:Phaser.Math.Easing.Sine.Out,onComplete:this.swapButton.button.setInteractive,onCompleteScope:this.swapButton.button})}onOpen(){super.onOpen(),this.activateElements(),this.refocus&&(this.updateNames(),this.mainCarousel.checkCulling(),this.secondaryCarousel.checkCulling(),this.focusMaincarousel(0),this.focusSecondarycarousel(0),this.checkMatchReady())}updateNames(){var e=O.instance.getData("mainCharacter"),t=O.instance.getData("secondaryCharacter");e.name&&this.form.setValue(e.name),t.name&&this.formTwo.setValue(t.name)}focusMaincarousel(e){var t=Mt.instance.mainCharacterData,{customData:s,defaultData:i}=(this.mainCarousel.getCustomData(),this.mainCarousel),i=[...s,...i];let a=2;(a=0<Object.keys(t).length?Ye.instance.findInList(t.options,i):a)>=s.length&&s.length<3&&a++,this.mainCarousel.setActiveSlot(a),this.mainCarousel.focusOnSelection(e)}focusSecondarycarousel(e){var t,s=Mt.instance.secondaryCharacterData,{customData:i,defaultData:t}=(this.secondaryCarousel.getCustomData(),this.secondaryCarousel);let a=(t=[...t,...i]).length-3;if(0<Object.keys(s).length){if(!s||!s.options)return;a=Ye.instance.findInList(s.options,t)}this.secondaryCarousel.setActiveSlot(a),this.secondaryCarousel.focusOnSelection(e)}onClose(){this.deactivateElements(),super.onClose()}moveTiledBackground(){this.tiledSprite&&(this.tiledSprite.tilePositionX-=.15,this.tiledSprite.tilePositionY+=.21)}onResize(e,t){super.onResize(e,t),this.background.onResize(e),this.resizeTiledBackground(e),this.resizeForms(e,t),this.resizeCarousels(e,t),this.notificationButton&&(this.notificationTween.stop(),this.notificationButton.setScale(.6*t.y),this.notificationButton.setPosition(-140*t.y,40*t.y),this.createNotificationTween()),this.appButton&&this.appButton.setPosition(-140*t.y,40*t.y)}resizeTiledBackground(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:r.instance.gameSize;this.tiledSprite&&(this.tiledSprite.setSize(e.width,e.height),this.tiledSprite.setScale(r.instance.dpr))}resizeButtons(e,t){this.swapButton.onResize({width:this.getScreenWidth(e.width),height:e.height},t)}resizeForms(e,t){this.form.setPosition(0,-54*t.y).setScale(t.y),this.formTwo.setPosition(0,146*t.y).setScale(t.y),this.form.setTextScale(t.y,t.y),this.formTwo.setTextScale(t.y,t.y)}resizeCarousels(e,t){this.mainCarousel.setY(-220*t.y).setScale(t.y),this.secondaryCarousel.setScale(t.y).setY(270*t.y).setScale(t.y)}enableElements(){this.form.enableElement(),this.formTwo.enableElement()}toggleForms(e){this.form.setVisible(e),this.formTwo.setVisible(e)}deactivateElements(){this.form.deactivateElement(),this.formTwo.deactivateElement()}activateElements(){this.form.activateElement(),this.formTwo.activateElement()}disableElements(){this.form.disableElement(),this.formTwo.disableElement()}destroy(){Mt.instance.emitter.off("swapNames",this.swapFormValues,this),Mt.instance.emitter.off("swapCharacters",this.updateCharacters,this),Mt.instance.emitter.off("setMainCharacterName",this.form.saveValue,this.form),Mt.instance.emitter.off("setSecondaryCharacterName",this.formTwo.saveValue,this.formTwo),Mt.instance.emitter.off("updateText",this.checkMatchReady,this)}getScreenWidth(e){return e>pt.MAXIMUM_WIDTH*r.instance.dpr?pt.MAXIMUM_WIDTH*r.instance.dpr:e}}pt.MAXIMUM_WIDTH=390;class bt extends be{constructor(e,t,s,i){super(e,t,s),this.setDepth(i),this.createButton(),this.setCallback(this.goBack,this),r.instance.emitter.on("resize",this.onResize,this)}createButton(){this.createGradient("ui","button-gradient-big"),this.createImage("ui","icon-back",!0),this.createText(0,32,me.BACK_BUTTON,pe.button_sub_big)}goBack(){Vt.instance.screens.nameInputScreen.refocus=!1,Vt.instance.swapScreens([Pe,Ee],[Ne]),x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"button-press:back")}onResize(e,t){this.setScale(t),r.instance.isScreenBigger()?(this.setPosition(-165*t,0),this.gradientBackground.setPosition(0,0)):(this.setPosition(-150*t,0),this.gradientBackground.setPosition(-10*t,0))}}class yt extends be{constructor(e,t,s,i){super(e,t,s),this.createHighlight(),this.createButton(),this.createText(0,35,me.CONFIRM_BUTTON,pe.button_sub_big),this.setCallback(this.confirm,this),this.setDepth(i)}createHighlight(){this.highlight=new Phaser.GameObjects.Image(this.scene,0,0,"ui","round-button-medium").setScale(1.2).setTint(E.tutorial_highlight.hex).setAlpha(0,0,1,1).setVisible(!1),this.add(this.highlight)}createButton(){this.createGradient("ui","button-gradient-big"),this.createImage("ui","button-confirm",!0)}confirm(){o.instance.playSound("main-audio","okaybutton",this.scene),x.instance.sendGAEvent(x.GA_EVENTS,"button-press:confirmCharacter");var e=Vt.instance.screens.nameInputScreen,t=Mt.instance.getPlayerData(),s=this.parentContainer.isMain,i=(s?e.mainCarousel:e.secondaryCarousel).dataKey,a=Ye.instance.updateCustomCharacter(t,i);s?Mt.instance.mainCharacterData.options=t:Mt.instance.secondaryCharacterData.options=t,a||Ye.instance.saveCustomCharacter(t,i),e.updateCarousels(s),Vt.instance.swapScreens([Pe,Ee],[Ne])}completeTutorialSteps(){He.instance.finishStep(ee),He.instance.finishStep(he),He.instance.finishStep($),He.instance.finishStep(oe);var e=He.instance.currentStep;null!=e&&e.id&&e.id===ce&&(He.instance.hand.setVisible(!0),He.instance.setSkipButtonPositon("bottomCenter"))}onResize(e,t){this.setScale(t),r.instance.isScreenBigger()?(this.setPosition(165*t,0),this.gradientBackground.setPosition(0,0)):(this.setPosition(150*t,0),this.gradientBackground.setPosition(10*t,0))}toggleHighlight(e){this.highlight.setVisible(e),e?this.highlightTween=this.scene.tweens.add({targets:this.highlight,scaleX:{from:1,to:1.6},scaleY:{from:1,to:1.6},alpha:{from:1,to:0,duration:1e3},duration:500,ease:Phaser.Math.Easing.Sine.Out,loop:-1}):this.highlightTween.stop()}}class St extends be{constructor(e,t,s,i){super(e,t,s),this.setDepth(i),this.createHighlight(),this.createButton(),this.setCallback(this.onRandom,this),lt.instance.emitter.on("languageChanged",this.updateLabelSize,this),this.on("destroy",this.onDestroy,this)}onDestroy(){lt.instance.emitter.off("languageChanged",this.updateLabelSize,this)}createButton(){this.defaultTint={r:E.button_pink_default.r,g:E.button_pink_default.g,b:E.button_pink_default.b},this.pressedTint={r:E.button_fade_pressed.r,g:E.button_fade_pressed.g,b:E.button_fade_pressed.b},this.createImage("ui","button-gradient-small",!0),this.createImage("ui","icon-random",!1,.7),this.createText(0,30,me.RANDOM_BUTTON,pe.button_sub_small),this.createTextBackground(0,30)}updateLabelSize(){this.updateBackgroundSize()}createHighlight(){this.highlight=new Phaser.GameObjects.Image(this.scene,0,0,"ui","round-button-small").setScale(1.2).setTint(E.tutorial_highlight.hex).setAlpha(0,0,1,1).setVisible(!1),this.add(this.highlight)}onRandom(){var{mainCharacter:e,secondaryCharacter:t}=this.parentContainer,e=e.visible?e:t;Mt.instance.setCharacter(e),Mt.instance.randomizeCharacter(),A.instance.logCustomEvent("character_randomised"),o.instance.playSound("main-audio","randombutton",this.scene),N.instance.performAction("select_random",Mt.instance.getPlayerData(),!0),He.instance.finishStep(re),x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"button-press:randomiseCharacter")}onResize(e,t){this.setScale(t,t).setPosition(120*t,this.parentContainer.background.height/2-70*t)}toggleHighlight(e){this.highlight.setVisible(e),e?this.highlightTween=this.scene.tweens.add({targets:this.highlight,scaleX:{from:1,to:1.6},scaleY:{from:1,to:1.6},alpha:{from:1,to:0,duration:1e3},duration:500,ease:Phaser.Math.Easing.Sine.Out,loop:-1}):this.highlightTween.stop()}}class _t extends be{constructor(e,t,s,i){super(e,t,s),this.setDepth(i),this.createButton(),this.setCallback(this.onReset,this),lt.instance.emitter.on("languageChanged",this.updateLabelSize,this),this.on("destroy",this.onDestroy,this)}onDestroy(){lt.instance.emitter.off("languageChanged",this.updateLabelSize,this)}createButton(){this.defaultTint={r:E.button_pink_default.r,g:E.button_pink_default.g,b:E.button_pink_default.b},this.pressedTint={r:E.button_fade_pressed.r,g:E.button_fade_pressed.g,b:E.button_fade_pressed.b},this.createImage("ui","button-gradient-small",!0),this.createImage("ui","icon-restart",!1,.55),this.createText(0,30,me.RESET_BUTTON,pe.button_sub_small),this.createTextBackground(0,30)}updateLabelSize(){this.updateBackgroundSize()}onReset(){o.instance.playSound("main-audio","randombutton",this.scene),N.instance.performAction("select_reset",{},!0);var{mainCharacter:e,secondaryCharacter:t}=this.parentContainer,e=e.visible?e:t;Mt.instance.setCharacterCustomisation(e,{options:Ye.instance.selectedCharacter},this.scene.isMain),x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"button-press:resetCharacter")}onResize(e,t){this.setScale(t).setPosition(-120*t,this.parentContainer.background.height/2-70*t)}}class ft extends rt{constructor(e,t,s,i){super(e,t,s,i,Ee,!1)}setEvents(){super.setEvents()}create(){super.create(),this.createBackground(),this.createCharacters(Ce,we),this.createButtons(fe),this.createShadow(),this.hideEditButtons()}createButtons(e){this.confirmButton=new yt(this.scene,0,0,e),this.randomButton=new St(this.scene,0,0,e),this.resetButton=new _t(this.scene,0,0,e),this.backButton=new bt(this.scene,0,0,e),this.editButtons=[this.randomButton,this.backButton,this.resetButton,this.confirmButton],this.add(this.editButtons)}createCharacters(e,t){this.depthMainCharacter=e,this.depthsecondaryCharacter=t}get mainCharacter(){return this._mainCharacter||(this._mainCharacter=new st(this.scene,"puppet",!0,"home_idle").setDepth(this.depthMainCharacter),this.add(this._mainCharacter)),this._mainCharacter}get secondaryCharacter(){return this._secondaryCharacter||(this._secondaryCharacter=new st(this.scene,"puppet",!0,"home_idle").setDepth(this.depthsecondaryCharacter),this.add(this._secondaryCharacter),this.secondaryCharacter.character.setScale(-1,1),this.secondaryCharacter.setVisible(!0)),this._secondaryCharacter}createBackground(){this.background=new ht(this.scene,{x:0,y:0},{topLeft:E.background_top.hex,topRight:E.background_top.hex,bottomLeft:E.background_bot.hex,bottomRight:E.background_bot.hex},Se,1),this.add(this.background)}createShadow(){this.shadow=new Phaser.GameObjects.Image(this.scene,0,0,"ui","shadow-character-creator"),this.shadow.setOrigin(.5,1),this.add(this.shadow)}async onOpen(){super.onOpen(),this.ignoreResize||this.resize(1,.5,500,this.startButtonTweens)}async onClose(){super.onClose(),this.hideEditButtons(),this.resize(.5,1,200,()=>{})}resize(e,t,s){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:this.startButtonTweens;this.scene.tweens.addCounter({from:e,to:t,duration:s,onUpdate(e){e=e.getValue();var t=r.instance.height/2,s=r.instance.width/2;this.origin.y=e/2,this.background.heightMultiplier=e,this.onResize(r.instance.gameSize,r.instance.gameScale),this.setPosition(s,t*e)},ease:Phaser.Math.Easing.Sine.InOut,onComplete:i,onUpdateScope:this,onCompleteScope:this})}startButtonTweens(){this.hideEditButtons(),this.tweenButtonSizes(this.resetButton,0),this.tweenButtonSizes(this.randomButton,3),this.tweenButtonSizes(this.backButton,0),this.tweenButtonSizes(this.confirmButton,1)}hideEditButtons(){this.editButtons.forEach(e=>e.setVisible(!1))}tweenButtonSizes(e,t){var s;e.visible||(s=r.instance.gameScale.y,this.scene.tweens.add({onStart:()=>{e.setVisible(!0),e.setScale(0)},targets:e,scale:{from:0,to:+s},delay:100*t,duration:400,ease:Phaser.Math.Easing.Back.InOut}))}get isMain(){return this.mainCharacter.visible}toggleActiveCharacter(e){this.mainCharacter.setVisible(e),this.secondaryCharacter.setVisible(!e)}setSelectedCharacterData(e,t,s){Mt.instance.setCharacterCustomisation(this[e],s,t)}onResize(e,t){super.onResize(e,t),this.background.onResize(e),this.resizeCharacters(e,t.y),this.resizeButtons(e,t.y),this.resizeShadow(e,t.y)}resizeCharacters(e,t){var s=2.8*this.background.heightMultiplier;this._mainCharacter&&this.mainCharacter.onResize(t*s,0,110*t*s),this._secondaryCharacter&&this.secondaryCharacter.onResize(t*s,0,110*t*s)}resizeButtons(e,t){this.confirmButton.onResize(e,t),this.randomButton.onResize(e,t),this.resetButton.onResize(e,t),this.backButton.onResize(e,t)}resizeShadow(e,t){this.shadow.setDisplaySize(e.width*t,100),this.shadow.setPosition(0,this.background.y+this.background.height/2)}}class wt extends Phaser.GameObjects.Container{constructor(e,t,s,i,a,n){super(e,t,s),this.key=i,this.subKey=n,this._data=a,this.createIcon(),this.emitter=new Phaser.Events.EventEmitter}createIcon(){this.icon=new Phaser.GameObjects.Image(this.scene,0,0,this._data.icon.key,this._data.icon.frame),this.notification=new Phaser.GameObjects.Image(this.scene,1,-45,"ui","tutorial-hand").setScale(.6).setAngle(-130).setVisible(!1),this._data.icon.offset&&(this.iconOffset=this._data.icon.offset),this.add(this.notification),this.add(this.icon),this.icon.setInteractive(),this.icon.input.hitArea.setTo((this.icon.width-wt.HIT_AREA.width)/2,(this.icon.height-wt.HIT_AREA.height)/2,wt.HIT_AREA.width,wt.HIT_AREA.height),this.icon.on("pointerdown",this.onInputDown,this),this.deselect()}toggleNotficationIcon(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.notification.setVisible(e),e?this.notificationTween=this.scene.tweens.add({targets:this.notification,y:{from:this.notification.y,to:this.notification.y-20},loop:-1,yoyo:!0,duration:500,delay:t,loopDelay:500-t,ease:Phaser.Math.Easing.Bounce.In}):this.notificationTween.stop()}onInputDown(){this.emitter.emit("pressed",this.key,this.subKey,this._data),o.instance.playSound("main-audio","categorybutton",this.scene),He.instance.finishStep(te,this.subKey),He.instance.finishStep(se,this.key),"character"===this.key&&He.instance.finishStep(ie)}sameCategory(e){return this.key===e}sameSubCategory(e){return this.subKey===e}select(){this.icon.setAlpha(1),this.subKey?this.icon.setTint(E.secondary_bar_icon_selected.hex):this.icon.setTint(E.main_bar_icon_selected.hex)}deselect(){this.icon.setAlpha(.5),this.subKey?this.icon.setTint(E.secondary_bar_icon.hex):this.icon.setTint(E.main_bar_icon.hex)}}wt.HIT_AREA={width:68,height:52};class Ct extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s),this.categoryIcons=[],this.subCategoryIcons=[],this.iconWidth=70,this.subIconsWidth=70,this.subIconsOffset=-25,this.icons={},this.subIcons={},this.createBar(),this.createIcons(),this.createSubBar(),this.createSubIcons(),this.setCategoryPosition(),this.setSubCategoryPosition(),this.selectedCategory=null,this.selectedSubCategory=null,this.selectionRectangle.x=this.icons.skin.x,r.instance.emitter.on("resize",this.onResize,this),this.on("destroy",this.onDestroy,this)}onDestroy(){r.instance.emitter.off("resize",this.onResize,this)}onResize(e,t){this.bar.setDisplaySize(e.width/t.y,this.bar.height),this.subBar.setDisplaySize(e.width/t.y,this.bar.height)}setCategory(e){this.category=e,this.setSubCategory(e,this.getFirstSubCategory());var t=X[e].subcategories[this.subCategory];this.selectedCategory=e,Mt.instance.emitter.emit("changeCategory",this.selectedCategory,this.subCategory,t),this.setSelectState(),this.moveSelectionRectangle(),this.moveSubSelectionRectangle()}getFirstSubCategory(){return this.category||(this.category="skin"),Object.keys(X[this.category].subcategories)[0]}setSubCategory(e,t){var s;this.subCategory!==t&&(this.subCategory=t,s=X[this.category].subcategories[this.subCategory])&&(this.selectedSubCategory=t,Mt.instance.emitter.emit("changeSubCategory",this.selectedCategory,this.selectedSubCategory,s),this.setSubSelectState(),this.moveSubSelectionRectangle())}moveSelectionRectangle(){this.scene.tweens.add({targets:this.selectionRectangle,duration:200,ease:Phaser.Math.Easing.Back.InOut,x:this.icons[this.category].x})}moveSubSelectionRectangle(){var e=Object.keys(X[this.category].subcategories);this.subCategory&&e.includes(this.subCategory)||(this.subCategory=e[0]),this.scene.tweens.add({targets:this.subSelectionRectangle,duration:200,ease:Phaser.Math.Easing.Back.InOut,x:this.subIcons[this.category][this.subCategory].x})}setSelectState(){this.categoryIcons.forEach(e=>{e.sameCategory(this.selectedCategory)?e.select():e.deselect()})}setSubSelectState(){this.subCategoryIcons.forEach(e=>{e.sameSubCategory(this.selectedSubCategory)?e.select():e.deselect()})}createBar(){this.bar=new Phaser.GameObjects.Rectangle(this.scene,0,0,375,44,E.category_main_bar.hex),this.selectionRectangle=new Phaser.GameObjects.Graphics(this.scene).fillStyle(E.category_main_selected.hex,1).fillRoundedRect(-34,-26,68,52,14),this.add(this.bar),this.add(this.selectionRectangle),this.mainBarItems=[this.bar,this.selectionRectangle]}toggleMainBarVisibility(e){this.mainBarItems.forEach(t=>t.setVisible(e)),this.categoryIcons.forEach(t=>t.setVisible(e));var t,s=this.scene.shadow;e?(t=this.bar.getWorldTransformMatrix(),s.setPosition(t.tx,.475*r.instance.height)):(t=this.subBar.getWorldTransformMatrix(),s.setPosition(t.tx,t.ty-this.subBar.displayHeight/2))}createSubBar(){this.subBar=new Phaser.GameObjects.Rectangle(this.scene,0,this.bar.displayHeight,375,44,E.category_sub_bar.hex),this.subSelectionRectangle=new Phaser.GameObjects.Graphics(this.scene).fillStyle(E.category_sub_selected.hex,1).fillRoundedRect(-34,this.subBar.y-26,68,52,14),this.add(this.subBar),this.add(this.subSelectionRectangle)}createIcons(){Object.keys(X).forEach(e=>{var t=X[e];this.createIcon(e,t)})}createSubIcons(){Object.keys(X).forEach(e=>{X[e].subcategories&&Object.keys(X[e].subcategories).forEach(t=>{var s=X[e].subcategories[t];this.createSubIcon(e,t,s)})})}createIcon(e,t){t=new wt(this.scene,0,0,e,t),this.add(t),t.emitter.on("pressed",e=>{this.setCategory(e),N.instance.performAction("select_main_category",e,!0)},this),this.icons[e]=t,this.subIcons[e]={},this.categoryIcons.push(t)}createSubIcon(e,t,s){s=new wt(this.scene,0,this.subBar.y,e,s,t),this.add(s),s.emitter.on("pressed",(e,t)=>{this.setSubCategory(e,t),N.instance.performAction("select_sub_category",t,!0)},this),this.subIcons[e][t]=s,this.subCategoryIcons.push(s)}setCategoryPosition(){const e=this.categoryIcons.length;this.categoryIcons.forEach((t,s)=>{t.setPosition((s-(e-1)/2)*this.iconWidth,this.bar.y)})}setSubCategoryPosition(){this.showSubCategoryIcons();var e=Object.values(this.subIcons[this.selectedCategory]);const t=e.length;e.forEach((e,s)=>{var i=e.iconOffset||Phaser.Math.Vector2.ZERO;e.setPosition((s-(t-1)/2)*this.subIconsWidth,this.subBar.y+i.y)})}showSubCategoryIcons(){this.selectedCategory||(this.selectedCategory="skin",this.showSubCategoryIcons()),Object.keys(this.subIcons).forEach(e=>{Object.keys(this.subIcons[e]).forEach(t=>{t=this.subIcons[e][t],this.selectedCategory===e?t.setVisible(!0):t.setVisible(!1)})})}}class vt extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s),this.previousColor=new Phaser.Display.Color,this.currentColor=new Phaser.Display.Color,this.selected=!1,this.create()}create(){this.createBackground(),this.createIcons(),this.deselect()}createBackground(){this.background=new Phaser.GameObjects.Image(this.scene,0,0,"ui","item-background").setTint(E.category_item_frame.hex),this.selectedBackground=new Phaser.GameObjects.Image(this.scene,0,0,"ui","item-background").setTint(E.category_item_selected.hex),this.add([this.background,this.selectedBackground]),this.width=this.background.displayWidth,this.height=this.background.displayHeight}createIcons(){this.backIcon=new Phaser.GameObjects.Image(this.scene,0,0),this.icon=new Phaser.GameObjects.Image(this.scene,0,0,"ui","icon-none"),this.checkMark=new Phaser.GameObjects.Image(this.scene,28,28,"ui","item-selected-checkmark").setScale(.75,.75),this.add([this.backIcon,this.icon,this.checkMark])}setOption(e,t){var s=(this.option=e).key||"ui",i=e.frame||"icon-none";"icon-none"===i&&this.icon.setTint(E.category_item_none.hex),this.icon.setTexture(s,i),e.bot_frame?(this.backIcon.setTexture(s,e.bot_frame),this.backIcon.setVisible(!0)):this.backIcon.setVisible(!1),this.icon.setScale(0,0),this.backIcon.setScale(0,0),this.isNone="icon-none"===i,this.iconScaleTween&&this.iconScaleTween.stop(),this.iconScaleTween=this.scene.tweens.add({targets:[this.icon,this.backIcon],scale:{from:0,to:"icon-none"===this.option.frame?1:1/2.2},duration:200,ease:Phaser.Math.Easing.Back.Out,delay:t%6*50})}isEven(e){return e%2==0}sameOption(e){return this.option===e}select(){this.selected||(N.instance.performAction("select_item",this.option.id,!0),x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,`itemSelect:${this.option.item_data.item_category}:`+this.option.id),o.instance.playSound("main-audio","pop",this.scene),Vt.instance.screens.customisationScreen.setSelectedOption(this),this.selectedBackground.visible=!0,this.checkMark.visible=!0,this.selected=!0,this.scene.tweens.add({targets:this.selectedBackground,alpha:{from:0,to:1},duration:200}),this.scene.tweens.add({targets:this.checkMark,scale:{from:0,to:.75},duration:200,ease:Phaser.Math.Easing.Back.Out}),Vt.instance.screens.customisationScreen.characterOptions.emitter.emit("changeOption",this.option))}forceDeselect(){this.selected=!1,this.selectedBackground.visible=!1,this.checkMark.visible=!1}deselect(){this.forceDeselect()}setColor(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.isNone?this.icon.setTint(E.category_item_none.hex):e&&(t?(this.icon.setTint(e._color),this.currentColor.setTo(e.r,e.g,e.b)):(this.previousColor.setTo(this.currentColor.r,this.currentColor.g,this.currentColor.b),this.currentColor.setTo(e.r,e.g,e.b),this.scene.tweens.addCounter({from:0,to:1,duration:200,onUpdate(e){e=e.getValue();var t=Math.floor(this.previousColor.r+e*(this.currentColor.r-this.previousColor.r)),s=Math.floor(this.previousColor.g+e*(this.currentColor.g-this.previousColor.g));e=Math.floor(this.previousColor.b+e*(this.currentColor.b-this.previousColor.b));this.icon.setTint(Phaser.Display.Color.GetColor(t,s,e))},onUpdateScope:this})))}}class Tt extends at{constructor(e){super(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:12),this.createDefault()}createDefault(){for(let e=0;e<this.defaultAmount;e++)this.push(new vt(this.scene,0,0));super.createDefault()}}class kt extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s),this.options=[],this.emitter=new Phaser.Events.EventEmitter,this.createObjectPool(),this.createScrollView(),this.currentOptions=void 0,r.instance.emitter.on("resize",this.onResize,this),this.on("destroy",this.onDestroy,this)}onDestroy(){r.instance.emitter.off("resize",this.onResize,this)}onResize(e,t){this.setScale(t.y)}createObjectPool(){this.objectPool=new Tt(this.scene)}createScrollView(){this.scrollView=new et(this.scene,0,0,{x:0,y:200,width:340,height:290,mouseWheelScroller:{focus:!1,speed:.85},scroller:{pointerOutRelease:!1,dragRate:1/r.instance.dpr},hideUnscrollableSlider:!0}),this.add(this.scrollView)}checkCulling(){for(let s=0;s<this.scrollView.content.length;s++){var e=this.scrollView.content[s],t=e.y;t>=30&&t<=410&&!e.visible?e&&e.setVisible(!0):(t<30||t>410)&&e.visible&&e&&e.setVisible(!1)}}setSelectedOption(e){this.selectedSlot&&this.selectedSlot.deselect(),this.selectedSlot=e,this.focusOnSelection()}unselectSelectedSlots(){this.selectedSlot&&(this.selectedSlot.forceDeselect(),this.selectedSlot=void 0)}setNewSlotData(e){this.slotData=e;var t,s=this.slotData.length-this.scrollView.content.length;for(let e=0;e<=Math.abs(s)-1;e++)s<0&&this.recycleSlot(),0<s&&(t=this.objectPool.pop(),this.scrollView.addItems([t]),t.setVisible(!0));this.fillOptionData(),this.scrollView.setInteractivity(),this.scrollView.panel.layout()}getOrdedSlotData(e){return e.sort((e,t)=>null===e?1:null===t?-1:0)}fillOptionData(){var e=this.scrollView.content;const t=this.getOrdedSlotData([...this.slotData].reverse());e.forEach((e,s)=>{this.setOption(e,s,t[s])})}setOption(e,t,s){e.setOption(s,t)}recycleSlot(){var e=this.scrollView.content.pop();this.scrollView.remove(e),this.scrollView.sizer.remove(e),e.setVisible(!1),this.objectPool.push(e)}focusOnSelection(){var e=[...this.scrollView.content].reverse().indexOf(this.selectedSlot);e=Math.floor(e/3)/(this.scrollView.content.length/3-1)||0;this.tweenToFocus(e)}tweenToFocus(e){this.focusTween=this.scene.tweens.addCounter({from:this.scrollView.panel.t,to:e,duration:1<arguments.length&&void 0!==arguments[1]?arguments[1]:600,ease:Phaser.Math.Easing.Circular.Out,onUpdate:e=>{this.scrollView.panel.setT(e.getValue())}})}onScroll(){this.checkCulling()}onScrollStart(){}onScrollEnd(){}onMouseWheelScrollEnd(){}changeOption(e){this.emitter.emit("changeOption",e)}setOptions(e,t,s,i,a){Array.isArray(t)&&(this.options=[...t],this.currentData=e,this.unselectSelectedSlots(),this.isSwitching=!0,this.setNewSlotData(t),this.scrollView.panel.scrollToTop(),this.scene.time.delayedCall(1,()=>{this.isSwitching=!1},void 0,this),this.setColor(i,a),this.checkCulling())}setColor(e,t){this.scrollView.content.forEach(s=>s.setColor(e,t))}}class xt extends Phaser.GameObjects.Container{constructor(e,t,s,i,a){super(e,t,s),this.colorList=i,this.previousColor=new Phaser.Display.Color,this.currentColor=new Phaser.Display.Color,this.onPointerDown=a||this.selectAndChange,this.createImage(),this.addEventListeners()}createImage(){this.notification=new Phaser.GameObjects.Image(this.scene,0,-45,"ui","tutorial-hand").setScale(.6).setAngle(-130).setVisible(!1),this.dotOutline=this.scene.add.circle(0,0,17,0),this.dot=this.scene.add.circle(0,0,16,16777215),this.add([this.dotOutline,this.dot,this.notification]),this.checkMark=new Phaser.GameObjects.Image(this.scene,0,0,"ui","colors-selected-checkmark"),this.add(this.checkMark),this.deselect(),this.dot.setInteractive({draggable:!0})}addEventListeners(){r.instance.emitter.on("dragStart",()=>{this.optionDrag=!1}),r.instance.emitter.on("dragEnd",()=>{this.optionDrag=!0}),this.dot.on("pointerup",this.onPointerDown,this),this.on("destroy",this.onDestroy,this)}setDrag(){this.dot.setInteractive({draggable:!0}),this.dot.on("dragstart",()=>{this.colorList.onDragStart(),this.optionDrag=!1}).on("drag",(e,t)=>{this.colorList.onDrag(e,t/r.instance.dpr)},this.colorList).on("dragend",this.colorList.onDragEnd,this.colorList)}toggleNotficationIcon(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.notification.setVisible(e),e?this.notificationTween=this.scene.tweens.add({targets:this.notification,y:{from:this.notification.y,to:this.notification.y-20},loop:-1,yoyo:!0,duration:500,delay:t,loopDelay:500-t,ease:Phaser.Math.Easing.Bounce.In}):this.notificationTween.stop()}selectAndChange(){this.colorList.dragOnly||this.optionDrag||(o.instance.playSound("main-audio","colorbutton"),this.colorList.changeColor(this.color),this.select(),N.instance.performAction("select_color",Phaser.Display.Color.ComponentToHex(this.color.color)))}setColor(e){this.setDrag(),this.color=e,this.deselect(),this.previousColor.setTo(this.currentColor.r,this.currentColor.g,this.currentColor.b),this.currentColor.setTo(e.r,e.g,e.b),this.scene.tweens.addCounter({from:0,to:1,duration:200,onUpdate(e){e=e.getValue();var t=Math.floor(this.previousColor.r+e*(this.currentColor.r-this.previousColor.r)),s=Math.floor(this.previousColor.g+e*(this.currentColor.g-this.previousColor.g));e=Math.floor(this.previousColor.b+e*(this.currentColor.b-this.previousColor.b));this.dot.setFillStyle(Phaser.Display.Color.GetColor(t,s,e))},onUpdateScope:this})}select(){this.checkMark.visible=!0,this.scene.tweens.add({targets:this.checkMark,duration:400,ease:Phaser.Math.Easing.Back.Out,scale:{from:0,to:1}})}deselect(){this.checkMark.visible=!1}onDestroy(){this.scene.emitter&&(r.instance.emitter.off("dragStart",()=>{this.optionDrag=!1}),r.instance.emitter.off("dragEnd",()=>{this.optionDrag=!0}),this.dot.off("pointerup",this.onPointerDown,this))}}class Dt extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s),this.colors=[],this.colorDots=[],this.objectPool=[],this.dotDistance=42,this.startX=t,this.clickThreshold=100,this.dragDistance=new Phaser.Geom.Point(0,0),this.emitter=new Phaser.Events.EventEmitter,this.createBackground()}createBackground(){this.background=new Phaser.GameObjects.Graphics(this.scene),this.add(this.background),this.updateBackground(200)}updateBackground(e){this.background.clear().fillStyle(E.color_picker_background.hex,1).fillRoundedRect(0,-28,e,56,0)}createColors(e,t){if(this.colors=e,this.selectedColor=t,this.removeColors(),!e||!t||e.length<2)this.checkIndicatorsVisible();else{var s=this.dotDistance*this.colors.length;this.updateBackground(s),this.screenIsBigger=this.screenWidth>s,e.forEach(e=>{this.createColorDot(e,t,0)}),this.checkIndicatorsVisible(),this.checkBounceMode()||this.checkOutOfBounds(500)}}createColorDot(e,t,s){let i=0;this.screenIsBigger&&(i=s/2),(s=this.getDotFromPool()).setPosition(i+this.dotDistance/2+this.dotDistance*(this.colorDots.length-1),0),s.setColor(e),s.setVisible(!0),this.add(s),e===t&&(s.select(),this.setActivePosition(s))}getDotFromPool(){var e=0<this.objectPool.length?this.objectPool.pop():new xt(this.scene,0,0,this);return this.colorDots.push(e),e}setIndicators(e,t){this.leftIndicator=e,this.rightIndicator=t}changeColor(e){this.deselectAll(),this.selectedColor=e,this.emitter.emit("changeColor",this.selectedColor)}onDragStart(){!this.colors||this.colors.length<2||(this.previousDragXPosition=this.x,this.dragOnly=!1,this.dragDistance.setTo(0,0))}onDrag(e,t,s){!this.colors||this.colors.length<2||(this.x=this.previousDragXPosition+t,this.checkIndicatorsVisible(),this.dragDistance.setTo(t,s))}onDragEnd(){!this.colors||this.colors.length<2||(this.dragDistance.x*this.dragDistance.x+this.dragDistance.y*this.dragDistance.y>this.clickThreshold&&(this.dragOnly=!0),this.checkOutOfBounds(400))}setStartPosition(){var e=r.instance.gameSize.width/r.instance.gameScale.y;this.setPosition(e/2-this.barWidth/2,this.y),this.checkOutOfBounds(200)}checkIndicatorsVisible(){this.leftIndicator.checkIfVisible(this.x,0,this.screenEnd,this.colors),this.rightIndicator.checkIfVisible(this.x,0,this.screenEnd,this.colors)}get barWidth(){return this.colorDots.length*this.dotDistance}get barCenterPosition(){return this.x+this.barWidth/2}get screenWidth(){return r.instance.gameSize.width/r.instance.gameScale.y}get screenEnd(){return this.screenWidth-this.barWidth}get isLeftOfCenter(){return this.barCenterPosition<this.screenWidth/2}get isRightOfCenter(){return this.barCenterPosition>this.screenWidth/2}get centerPosition(){return this.screenWidth/2-this.barWidth/2}checkOutOfBounds(e){this.updateBackground(this.barWidth),this.checkBounceMode()?(0<this.x&&this.playBounce(this.x,0,e),this.x<this.screenEnd&&this.playBounce(this.x,this.screenEnd,e)):(this.isLeftOfCenter&&this.playBounce(this.x,this.centerPosition,e),this.isRightOfCenter&&this.playBounce(this.x,this.centerPosition,e))}checkBounceMode(){return this.screenWidth<this.barWidth}playBounce(e,t,s){this.bounceTween=this.scene.tweens.add({targets:this,x:{from:e,to:t},duration:s||1e3,onUpdate:()=>{this.checkIndicatorsVisible()},ease:Phaser.Math.Easing.Quadratic.Out})}deselectAll(){this.colorDots.forEach(e=>e.deselect())}removeColors(){if(this.colorDots){for(let t=this.colorDots.length-1;0<=t;t--){var e=this.colorDots[t];e.visible=!1,this.remove(e),this.objectPool.push(e)}this.colorDots.length=0}}setActivePosition(e){var t=(e=this.x+e.x)>this.screenWidth;let s,i;e<0?(s=0-e,i=this.x+s+.5*this.dotDistance,this.tweenListPosition(i)):t&&(s=this.screenWidth-e,i=this.x+s-.5*this.dotDistance,this.tweenListPosition(i))}tweenListPosition(e){var t=Math.abs(e-this.x);this.listTween=this.scene.tweens.add({targets:this,x:{from:this.x,to:e},duration:t,onComplete:()=>{this.checkIndicatorsVisible(),this.checkOutOfBounds()},ease:Phaser.Math.Easing.Sine.Out})}onResize(){this.setStartPosition(),this.createColors(this.colors,this.selectedColor,r.instance.width),this.checkIndicatorsVisible()}}class Ot extends Phaser.GameObjects.Container{constructor(e,t,s,i){super(e,t,s),this.isLeft=i,this.create()}create(){this.createArrow(this.isLeft)}createArrow(e){this.arrow=new Phaser.GameObjects.Image(this.scene,0,0,"ui","scroll-indication"),e&&(this.arrow.setScale(-1,1),this.arrow.setOrigin(0,.5)),this.arrow.setOrigin(1,.5),this.add(this.arrow)}tweenVisible(e){this.visible!==e&&(e&&this.setVisible(e),this.visibleTween=this.scene.tweens.add({targets:this,alpha:{from:1-e,to:0+e},duration:200,ease:e?Phaser.Math.Easing.Cubic.In:Phaser.Math.Easing.Cubic.Out,onComplete:()=>{this.setVisible(e)},onCompleteScope:this}))}checkIfVisible(e,t,s,i){i=i&&2<i.length,this.isLeft&&e<=t-10&&i||!this.isLeft&&s+10<=e?this.tweenVisible(!0):this.tweenVisible(!1)}}class At extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s),this.create()}create(){this.createBackground(),this.createList(),this.createScrollIndicators(),this.checkIfDragable(),this.setStartPosition()}createBackground(){this.background=new Phaser.GameObjects.Rectangle(this.scene,0,0,r.instance.width/r.instance.dpr,At.SELECTOR_HEIGHT,E.color_picker_background.hex),this.background.setOrigin(0,1),this.add(this.background)}createList(){this.colorList=new Dt(this.scene,0,-At.SELECTOR_HEIGHT/2),this.add(this.colorList)}createScrollIndicators(){var e=-At.SELECTOR_HEIGHT/2;this.leftIndicator=new Ot(this.scene,0,e,!0),this.rightIndicator=new Ot(this.scene,this.colorList.screenWidth,e,!1),this.add([this.leftIndicator,this.rightIndicator]),this.colorList.setIndicators(this.leftIndicator,this.rightIndicator)}checkIfDragable(){this.colorList.screenIsBigger?this.background.removeInteractive():this.setBackgroundDragable()}setBackgroundDragable(){this.background.setInteractive({draggable:!0}).on("dragstart",this.colorList.onDragStart,this.colorList).on("drag",this.colorList.onDrag,this.colorList).on("dragend",this.colorList.onDragEnd,this.colorList)}setStartPosition(){this.colorList.setStartPosition()}setColors(e,t){this.colorList.createColors(e,t)}onResize(e,t){this.setPosition(-e.width/2,e.height/2),this.setScale(t.y),this.colorList.onResize(e),this.background.setOrigin(0,.5).setDisplaySize(e.width/t.y,At.SELECTOR_HEIGHT).setPosition(0,-At.SELECTOR_HEIGHT/2),this.rightIndicator.setPosition(this.colorList.screenWidth,-At.SELECTOR_HEIGHT/2)}}At.SELECTOR_HEIGHT=52;class It extends rt{constructor(e,t,s,i){super(e,t,s,i,Pe),this.scene=e,this.category=null,this.subcategory=null,this.origin.y=2,this.categoryKeys=Object.keys(X).filter(e=>X[e].customizable)}setEvents(){super.setEvents(),Mt.instance.emitter.on("setCategory",this.setCategory,this),this.on("destroy",this.onDestroy,this)}onDestroy(){r.instance.emitter.off("resize",this.onResize,this),Mt.instance.emitter.off("setCategory",this.setCategory,this),Mt.instance.emitter.off("changeCategory",this.setCategory,this),Mt.instance.emitter.off("changeSubCategory",this.setSubCategory,this),this.colorSelector.colorList.emitter.off("changeColor",this.onChangeColor,this),this.characterOptions.emitter.off("changeOption",this.onChangeOption,this)}async onOpen(){super.onOpen(),this.categoryBar.setCategory("skin"),this.resize(2,1,500,this.startButtonTweens)}onClose(){this.resize(1,2,100)}resize(e,t,s){this.scene.tweens.addCounter({from:e,to:t,duration:s,onUpdate(e){e=e.getValue();var t=r.instance.height/2,s=r.instance.width/2;this.origin.y=e/2,this.setPosition(s,t*e)},ease:Phaser.Math.Easing.Sine.InOut,onComplete:3<arguments.length&&void 0!==arguments[3]?arguments[3]:()=>{},onUpdateScope:this,onCompleteScope:this})}static fillSubCategoryToCategory(){It.SUBCATEGORY_TO_CATEGORY||(It.SUBCATEGORY_TO_CATEGORY={},this.categoryKeys||(this.categoryKeys=Object.keys(X).filter(e=>X[e].customizable)),this.categoryKeys.forEach(e=>{Object.keys(X[e].subcategories).forEach(t=>{It.SUBCATEGORY_TO_CATEGORY[t]=e})}))}create(){super.create(),this.createBackground(),this.createOptions(),this.createMenuContainer(ve),this.createBackdrop(),this.createCategoryBar(),this.createColorSelector(),It.fillSubCategoryToCategory(),this.colorSelector.setColors(P.skinColors,1)}createMenuContainer(e){this.menuContainer=new Phaser.GameObjects.Container(this.scene,0,0),this.add(this.menuContainer),this.menuContainer.setDepth(e)}createBackdrop(){this.backdrop=new Phaser.GameObjects.Rectangle(this.scene,0,0,9999,9999,E.category_window.hex,0),this.menuContainer.add(this.backdrop)}createBackground(){this.background=new Phaser.GameObjects.Rectangle(this.scene,0,0,375,300,E.category_window.hex).setOrigin(.5,0),this.add(this.background)}createCategoryBar(){this.categoryBar=new Ct(this.scene,0,0),Mt.instance.emitter.on("changeCategory",this.setCategory,this),Mt.instance.emitter.on("changeSubCategory",this.setSubCategory,this),this.menuContainer.add(this.categoryBar)}createColorSelector(){this.colorSelector=new At(this.scene,0,0),this.colorSelector.setDepth(5),this.colorSelector.colorList.emitter.on("changeColor",this.onChangeColor,this),this.add(this.colorSelector)}createOptions(){this.characterOptions=new kt(this.scene,0,0,this.background),this.characterOptions.emitter.on("changeOption",this.onChangeOption,this),this.add(this.characterOptions)}setCategory(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.categoryBar).category,t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.categoryBar).subCategory;let s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;this.category=e||this.categoryBar.category,this.subCategory=t||this.categoryBar.getFirstSubCategory(),s=s||X[this.category].subcategories[this.subCategory],this.categoryBar.setSubCategoryPosition(),this.categoryBar.moveSubSelectionRectangle(),this.setSubCategory(this.category,this.subCategory,s)}setSubCategory(e,t){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:X[e].subcategories[t];this.category=e,this.subcategory=t,this.characterOptions.setVisible(!0),e=Mt.instance.selectedOptions[this.subcategory];let i=Mt.instance.selectedColors[this.subcategory];"nose"===this.subcategory&&(i=Mt.instance.character.skinColor),this.colorSelector.setColors(s.colors,i),this.characterOptions.setOptions(t,s.options,e,i,!0),this.categoryBar.setSubCategory(this.category,this.subcategory),this.categoryBar.moveSubSelectionRectangle(),this.logListView(this.subcategory,s.options,i)}logListView(e,t,s){t&&(t=t.map(e=>(s&&(e.item_data.item_variant=this.rgbToHex(s.r,s.g,s.b)),e.item_data)),A.instance.logListView(e,e,t))}rgbToHex(e,t,s){return"#"+this.componentToHex(e)+this.componentToHex(t)+this.componentToHex(s)}componentToHex(e){return 1===(e=e.toString(16)).length?"0"+e:e}onResize(e,t){super.onResize(e,t),this.colorSelector.onResize(e,t),this.background.setDisplaySize(e.width,e.height),this.menuContainer.setScale(t.y),this.menuContainer.setPosition(0,0)}onChangeColor(e){Mt.instance.setColor(e,this.categoryBar.selectedCategory,this.subcategory),this.characterOptions.setColor(e)}onChangeOption(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Mt.instance.selectedColors[this.subcategory];let s=null;"shape"===this.subcategory&&(s={key:"brow",color:Mt.instance.selectedColors.hair}),Mt.instance.character.setAttachment(e.attachments,t,s),Mt.instance.selectedOptions[this.subcategory]=e,Mt.checkBald(this.subcategory,Mt.instance.character),Mt.checkShape(this.subcategory,Mt.instance.character),A.instance.logItemSelect(this.subcategory,this.subcategory,e.item_data.item_id)}setSelectedOption(e){this.characterOptions.setSelectedOption(e)}static findCategory(e){return It.SUBCATEGORY_TO_CATEGORY||It.fillSubCategoryToCategory(),It.SUBCATEGORY_TO_CATEGORY[e]}static findOption(e,t){var s=It.findCategory(e);return s?X[s].subcategories[e].options.find(e=>e.id===t):null}static findColor(e,t){var s=It.findCategory(e);if(!s)return t;let i=X[s].subcategories[e].colors.find(e=>e.r===t.r&&e.g===t.g&&e.b===t.b);return i||new Phaser.Display.Color(t.r,t.g,t.b)}}class Nt extends Phaser.GameObjects.Container{constructor(e,t,s,i,a){super(e,t,s),this.textKey=i,this.interpolation=a,this.popupDuration=400,this.removeDuration=1e3,this.create()}create(){this.background=new Phaser.GameObjects.Graphics(this.scene,0,0),this.text=new Phaser.GameObjects.Text(this.scene,0,0,this.notificationText,pe.notification_bubble).setOrigin(.5),this.text.setText(this.textKey,this.interpolation),this.add([this.background,this.text]),this.resizeBackground(),this.tweenNotification()}resizeBackground(){var{displayWidth:e,displayHeight:t}=this.text;this.background.fillStyle(E.option_grey_normal.hex,.8).fillRoundedRect(-(e+20)/2,-(t+16)/2,e+20,t+16,16)}tweenNotification(){this.scene.tweens.add({targets:this,duration:this.popupDuration,y:{from:this.y,to:"+=140"},ease:Phaser.Math.Easing.Back.Out,completeDelay:this.removeDuration,onComplete:()=>{this.destroy()}})}}class Et extends rt{constructor(e,t,s,i){super(e,t,s,i,Le,!0)}create(){super.create(),this.createWindow(),this.createText(),this.createButtons(),lt.instance.emitter.on("languageChanged",this.updateTextSizes,this),this.on("destroy",this.onDestroy,this)}onDestroy(){lt.instance.emitter.off("languageChanged",this.updateTextSizes,this)}onOpen(){super.onOpen(),this.scene.tweens.add({targets:this,scale:{from:0,to:+r.instance.gameScale.y/2},duration:400,ease:Phaser.Math.Easing.Back.Out}),Vt.instance.screens.nameInputScreen.deactivateElements()}onClose(){super.onClose(),He.instance.finishStep(q),N.instance.performAction("accepted_TOS",!0),O.instance.setData({acceptedTOS:!0}),Vt.instance.screens.nameInputScreen.activateElements()}onResize(e,t){this.underlay.setScale(10),super.onResize(e,t),this.setScale(t.y/2)}createWindow(){this.window=new Phaser.GameObjects.Sprite(this.scene,0,0,"ui","notification-background").setScale(2),this.title=new Phaser.GameObjects.Container(this.scene,0,-this.window.displayHeight/2),this.titleText=new Phaser.GameObjects.Text(this.scene,0,0,me.NOTIFICATION_TITLE,pe.NOTIFICATION_TITLE).setOrigin(.5,.5).setTint(E.character_slot_name.hex),this.titleText.originalFontSize=this.titleText.style.fontSize,this.titleFrame=new Phaser.GameObjects.Sprite(this.scene,0,0,"ui","bg-inputfield").setScale(1.8),this.title.add([this.titleFrame,this.titleText]),this.add([this.window,this.title])}createText(){this.message=new Phaser.GameObjects.Text(this.scene,0,-this.window.displayHeight/2*.8,me.NOTIFICATION_TEXT_01,pe.notification_text).setOrigin(.5,0).setTint(E.overlay_black.hex),this.message.originalFontSize=this.titleText.style.fontSize,this.add([this.message])}createButtons(){this.acceptButton=new be(this.scene,0,this.window.displayHeight/2*.76).setDefaultTint(Phaser.Display.Color.IntegerToRGB("0x00B68A")).createImage("ui","button-long-stroke",!1,2,0,8).createImage("ui","button-long-fill",!0,2).createText(0,-5,me.NOTIFICATION_BUTTON,pe.notification_button).setCallback(this.onButtonPress,this),this.acceptButton.text.originalFontSize=this.acceptButton.text.style.fontSize,this.closeButton=new be(this.scene,this.window.displayHeight/2,-this.window.displayHeight/2).setDefaultTint(Phaser.Display.Color.IntegerToRGB(E.button_color_blue.hex)).createImage("ui","button-round-stroke",!1,1.7,0,6).createImage("ui","button-round-fill",!0,1.7).createImage("ui","icon-close",!1,1.7).setCallback(()=>{Vt.instance.closeScreen(this.name)},this),this.add([this.acceptButton,this.closeButton])}async onButtonPress(){var e="https:\\\\lovetester.com";await this.copyToClipboard(e),this.showCopied(e)}showCopied(e){this.bubble=new Nt(this.scene,0,this.acceptButton.y,"LINK_COPY",{link:e}),this.add(this.bubble)}openShareLink(e){navigator,window.navigator.share({title:"Lovetester.com",text:"",url:e}).then(e=>{e&&(0<e.length?console.warn("Shared successfully with activity"):console.warn("Share was aborted"))}).catch(e=>{console.error("Share failed:",e)})}async copyToClipboard(e){if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e);else{var t=document.createElement("textarea");t.value=e,t.style.position="absolute",t.style.left="-999999px",document.body.prepend(t),t.select();try{document.execCommand("copy")}catch(e){console.error(e)}finally{t.remove()}}}updateTextSizes(){this.titleText.setFontSize(parseInt(this.titleText.originalFontSize,10)),this.message.setFontSize(parseInt(this.message.originalFontSize,10)),this.acceptButton.text.setFontSize(parseInt(this.acceptButton.text.originalFontSize,10)),this.fitWidth(this.titleText,this.titleFrame.displayWidth-67),this.fitHeight(this.message,this.window.displayHeight-210),this.fitHeight(this.acceptButton.text,this.acceptButton.button.displayHeight-40)}fitWidth(e,t){for(;e.displayWidth>t;){var s=parseInt(e.style.fontSize,10)-1;e.setFontSize(s)}}fitHeight(e,t){for(;e.displayHeight>t;){var s=parseInt(e.style.fontSize,10)-1;e.setFontSize(s)}}}class Pt extends rt{constructor(e,t,s,i){super(e,t,s,i,Be,!0)}create(){super.create(),this.createWindow(),this.createText(),this.createButtons(),this.updateTextSizes()}setEvents(){super.setEvents(),lt.instance.emitter.on("languageChanged",this.updateTextSizes,this),this.on("destroy",this.onDestroy,this)}onDestroy(){lt.instance.emitter.off("languageChanged",this.updateTextSizes,this)}onDestroy(){lt.instance.emitter.off("languageChanged",this.updateTextSizes,this),r.instance.emitter.off("resize",this.onResize,this)}onOpen(){super.onOpen(),Vt.instance.screens.nameInputScreen.deactivateElements()}onClose(){super.onClose(),He.instance.finishStep(q),N.instance.performAction("accepted_TOS",!0),O.instance.setData({acceptedTOS:!0}),Vt.instance.screens.nameInputScreen.activateElements()}onResize(e,t){super.onResize(e,t),this.setSize(e.width,e.height),this.setScale(t.y),this.resizeWindow(e,t)}createWindow(){this.windowWidth=300,this.windowHeight=200,this.window=new Phaser.GameObjects.Graphics(this.scene,0,0),this.maskGraphics=new Phaser.GameObjects.Graphics(this.scene).fillStyle(16777215),this.bitmapMask=new Phaser.Display.Masks.BitmapMask(this.scene,this.maskGraphics),this.window.clear().fillGradientStyle(E.background_top.hex,E.background_top.hex,E.background_bot.hex,E.background_bot.hex,1).fillRect(.5*-this.windowWidth,.5*-this.windowHeight,this.windowWidth,this.windowHeight),this.window.setMask(this.bitmapMask),this.add([this.window])}resizeWindow(e,t){var s=this.windowWidth,i=this.windowHeight;this.maskGraphics.clear().fillRoundedRect(this.x-.5*s*t.y,this.y-.5*i*t.y,s*t.y,i*t.y,15*t.y)}createText(){this.text=new Phaser.GameObjects.Text(this.scene,0,.5*-this.windowHeight+35,me.TOS_MESSAGE,pe.normal).setOrigin(.5,0),this.TOSText=new Phaser.GameObjects.Text(this.scene,0,-28,me.TOS,pe.normal_highlight).setText(me.TOS).setOrigin(.5,0),this.PPText=new Phaser.GameObjects.Text(this.scene,0,10,me.PP,pe.normal_highlight).setOrigin(.5,0),this.assignClickEvents(this.TOSText,()=>{this.openPage("https://famobi.com/terms-of-service/?locale=en")}),this.assignClickEvents(this.PPText,()=>{this.openPage("https://famobi.com/privacy/?locale=en")}),this.heartLeft=new Phaser.GameObjects.Image(this.scene,.5*-this.windowWidth,.5*this.windowHeight,"ui","bg-heart-big").setScale(.7).setAngle(-12.5),this.heartRight=new Phaser.GameObjects.Image(this.scene,.5*this.windowWidth,.5*this.windowHeight,"ui","bg-heart-big").setScale(.7).setAngle(12.5),this.add([this.heartLeft,this.heartRight,this.text,this.TOSText,this.PPText])}openPage(e){var t=window.innerWidth,s=window.innerHeight;this.window=this.scene.add.dom(0,0).createFromHTML(`\n                <div id="iframe-container">\n                    <a href='#'\n                        style="color: black;font-weight: bolder; position: absolute; left: 10px; top: 6px; display: block; background-color: #FFFFFF; border-radius:16px; margin:auto; padding:20px" \n                        onclick='this.parentNode.parentNode.removeChild(this.parentNode)'\n                    >\n                    Close\n                    </a>\n                    <iframe \n                        width=${.9*t} height=${.94*s} \n                        max-width= 2040 max-height=2040 src=${e} frameborder="0" allowfullscreen>\n                    </iframe>\n                </div >\n                `),this.window.setPosition(t/2,s/2)}assignClickEvents(e,t){e.setInteractive().on("pointerup",t,this)}createButtons(){this.acceptButton=new be(this.scene,0,.5*this.windowHeight).createImage("ui","button-long-stroke",!0,1,0,4).setDefaultTint(E.button_green).createImage("ui","button-long-fill",!0,1).setCallback(()=>{Vt.instance.closeScreen(this.name)},this).createText(0,0,me.ACCEPT_BUTTON,pe.tos_button).setScale(1),this.add(this.acceptButton)}updateTextSizes(){"tr"===lt.instance.language?(this.TOSText.y=this.text.y+18,this.PPText.y=this.text.y+56):(this.TOSText.y=-28,this.PPText.y=10)}}class Bt extends be{constructor(e,t,s,i){super(e,t,s),this.setDepth(i),this.musicVolume=ct.instance.music,this.pressedColourDark=Phaser.Display.Color.IntegerToRGB(E.option_grey_dark.hex),this.pressedColour=Phaser.Display.Color.IntegerToRGB(E.option_grey_normal.hex),this.defaultColorDark=Phaser.Display.Color.IntegerToRGB(E.button_confirmed_pressed.hex),this.defaultColor=Phaser.Display.Color.IntegerToRGB(E.button_confirmed_default.hex),this.pressedTint=Phaser.Display.Color.IntegerToRGB(E.button_confirmed_pressed.hex),this.defaultTint=Phaser.Display.Color.IntegerToRGB(E.button_confirmed_default.hex),this.createButton(),this.setCallback(this.toggleMusic,this)}createButton(){this.changeColor(),this.createImage("ui","icon-round-stroke",!1,1.1,0,5),this.createImage("ui","icon-round-fill",!0,1),this.createImage("ui","icon-music-unmuted",!1,1.1),this.icon=this.lastCreateImage,this.changeIcon()}changeColor(){this.musicVolume?(this.pressedTint=this.defaultColorDark,this.defaultTint=this.defaultColor):(this.pressedTint=this.pressedColourDark,this.defaultTint=this.pressedColour),this.currentColor.setTo(this.defaultTint.r,this.defaultTint.g,this.defaultTint.b)}changeIcon(){var e=this.musicVolume?"icon-music-unmuted":"icon-music-muted";this.icon.setFrame(e)}toggleMusic(){this.musicVolume=this.musicVolume?0:1,o.instance.playSound("main-audio","randombutton",this.scene),o.instance.musicVolume=this.musicVolume,o.instance.updateAllVolumes(),this.updateButton()}saveData(){ct.instance.music=this.musicVolume}updateButton(){this.changeColor(),this.changeIcon()}onResize(e,t){this.setScale(t,t).setPosition(120*t,this.parentContainer.background.height/2-70*t)}}class Lt extends be{constructor(e,t,s,i){super(e,t,s),this.setDepth(i),this.sfxVolume=ct.instance.sfx,this.pressedColourDark=Phaser.Display.Color.IntegerToRGB(E.option_grey_dark.hex),this.pressedColour=Phaser.Display.Color.IntegerToRGB(E.option_grey_normal.hex),this.defaultColorDark=Phaser.Display.Color.IntegerToRGB(E.button_confirmed_pressed.hex),this.defaultColor=Phaser.Display.Color.IntegerToRGB(E.button_confirmed_default.hex),this.pressedTint=Phaser.Display.Color.IntegerToRGB(E.button_confirmed_pressed.hex),this.defaultTint=Phaser.Display.Color.IntegerToRGB(E.button_confirmed_default.hex),this.createButton(),this.setCallback(this.toggleSfx,this)}createButton(){this.changeColor(),this.createImage("ui","icon-round-stroke",!1,1.1,0,5),this.createImage("ui","icon-round-fill",!0,1),this.createImage("ui","icon-unmuted",!1,1.1),this.icon=this.lastCreateImage,this.changeIcon()}toggleSfx(){this.sfxVolume=this.sfxVolume?0:1,o.instance.playSound("main-audio","randombutton",this.scene),o.instance.sfxVolume=this.sfxVolume,o.instance.updateAllVolumes(),this.updateButton()}updateButton(){this.changeColor(),this.changeIcon()}changeColor(){this.sfxVolume?(this.pressedTint=this.defaultColorDark,this.defaultTint=this.defaultColor):(this.pressedTint=this.pressedColourDark,this.defaultTint=this.pressedColour),this.currentColor.setTo(this.defaultTint.r,this.defaultTint.g,this.defaultTint.b)}changeIcon(){var e=this.sfxVolume?"icon-unmuted":"icon-muted";this.icon.setFrame(e)}onResize(e,t){this.setScale(t,t).setPosition(120*t,this.parentContainer.background.height/2-70*t)}}class Gt extends rt{constructor(e,t,s,i){super(e,t,s,i,Ge,!0),r.instance.emitter.on("resize",this.onResize,this)}setEvents(){super.setEvents(),this.on("destroy",this.onDestroy,this)}onDestroy(){r.instance.emitter.off("resize",this.onResize,this)}async onOpen(){super.onOpen(),Vt.instance.screens.nameInputScreen.deactivateElements()}onClose(){super.onClose(),Vt.instance.screens.nameInputScreen.activateElements()}create(){this.windowWidth=350,this.windowHeight=145,this.origin.y=.5,this.hasCredit=x.instance.hasFeature("credits"),this.hasVersion=x.instance.hasFeature("version"),this.hasCopyright=x.instance.hasFeature("copyright"),(this.hasCredit&&this.hasCopyright||this.hasVersion)&&(this.windowHeight+=20),super.create(),this.createBrandingButton(),this.createWindow(),this.createButtons(),this.createText(),this.add(this.brandingButton)}createWindow(){this.window=new Phaser.GameObjects.Graphics(this.scene,0,0),this.maskGraphics=new Phaser.GameObjects.Graphics(this.scene).fillStyle(16777215),this.bitmapMask=new Phaser.Display.Masks.BitmapMask(this.scene,this.maskGraphics),this.window.clear().fillGradientStyle(E.background_top.hex,E.background_top.hex,E.background_bot.hex,E.background_bot.hex,1).fillRect(.5*-this.windowWidth,0,this.windowWidth,this.windowHeight),this.window.setMask(this.bitmapMask),this.title=new Phaser.GameObjects.Container(this.scene,0,0),this.titleText=new Phaser.GameObjects.Text(this.scene,0,0,me.SETTINGS,pe.NOTIFICATION_TITLE).setOrigin(.5,.5).setTint(E.character_slot_name.hex).setScale(.6),this.titleText.originalFontSize=this.titleText.style.fontSize,this.titleFrame=new Phaser.GameObjects.Sprite(this.scene,0,0,"ui","bg-inputfield").setScale(.9),this.title.add([this.titleFrame,this.titleText]),this.add([this.window,this.title])}createText(){var e;this.hasCredit&&this.hasCopyright&&(this.creditText=new Phaser.GameObjects.Text(this.scene,0,this.hasBrandingButton?220:135,"",pe.version_text).setOrigin(.5,.5).setText(me.CREDITS,{0:"Famobi ©"}),this.add(this.creditText)),this.hasVersion&&(e=p.gameVersion.current,this.versionText=new Phaser.GameObjects.Text(this.scene,130,this.hasBrandingButton?220:135,e,pe.version_text).setOrigin(.5,.5),this.add(this.versionText))}createButtons(){this.musicButton=new Bt(this.scene,50,73),this.sfxButton=new Lt(this.scene,-50,73),this.closeButton=new be(this.scene,.465*this.windowWidth,0).setDefaultTint(Phaser.Display.Color.IntegerToRGB(E.button_blue_default.hex)).createImage("ui","button-round-stroke",!1,.88,0,4).createImage("ui","button-round-fill",!0,.9).createImage("ui","icon-close",!1,.9).setCallback(()=>{o.instance.playSound("main-audio","randombutton",this.scene),ct.instance.saveSettings(),Vt.instance.closeScreen(this.name)},this),this.add([this.musicButton,this.sfxButton,this.closeButton])}createBrandingButton(){this.brandingButton=new mt(this.scene,0,155,!1),this.hasBrandingButton=this.brandingButton.visible,this.hasBrandingButton&&(this.windowHeight+=70)}resizeWindow(e,t){var s=this.windowWidth,i=this.windowHeight;this.maskGraphics.clear().fillRoundedRect(this.x-.5*s*t.y,this.y,s*t.y,i*t.y,15*t.y)}onResize(e,t){super.onResize(e,t),this.setPosition(e.width*this.origin.x,e.height*this.origin.y-this.windowHeight/2),this.setSize(e.width,e.height),this.setScale(t.y),this.resizeWindow(e,t)}}class Ft extends be{constructor(e,t,s,i,a){super(e,t,s),this.setDepth(i),this.language=a,this.setCallback(this.onClick,this),this.createButton()}createButton(){this.createImage("ui","button-round-stroke",!1,1.37,0,5),this.createImage("ui","icon-"+this.language,!0,1.01),this.icon=this.lastCreateImage}onClick(){lt.instance.setLanguage(this.language),o.instance.playSound("main-audio","randombutton",this.scene)}onResize(e,t){this.setScale(t,t).setPosition(120*t,this.parentContainer.background.height/2-70*t)}}class Rt extends rt{constructor(e,t,s,i){super(e,t,s,i,Fe,!0),r.instance.emitter.on("resize",this.onResize,this),lt.instance.emitter.on("languageChanged",this.closeWindow,this),this.on("destroy",this.onDestroy,this)}onDestroy(){lt.instance.emitter.off("languageChanged",this.closeWindow,this)}setEvents(){super.setEvents(),this.on("destroy",this.onDestroy,this)}onDestroy(){r.instance.emitter.off("resize",this.onResize,this)}async onOpen(){super.onOpen(),Vt.instance.screens.nameInputScreen.deactivateElements()}onClose(){super.onClose(),Vt.instance.screens.nameInputScreen.activateElements()}create(){super.create(),this.createWindow(),this.createButtons()}createWindow(){this.windowWidth=350,this.windowHeight=200,this.window=new Phaser.GameObjects.Graphics(this.scene,0,0),this.maskGraphics=new Phaser.GameObjects.Graphics(this.scene).fillStyle(16777215),this.bitmapMask=new Phaser.Display.Masks.BitmapMask(this.scene,this.maskGraphics),this.window.clear().fillGradientStyle(E.background_top.hex,E.background_top.hex,E.background_bot.hex,E.background_bot.hex,1).fillRect(.5*-this.windowWidth,.5*-this.windowHeight,this.windowWidth,this.windowHeight),this.window.setMask(this.bitmapMask),this.title=new Phaser.GameObjects.Container(this.scene,0,.5*-this.windowHeight),this.titleText=new Phaser.GameObjects.Text(this.scene,0,0,me.LANGUAGE,pe.NOTIFICATION_TITLE).setOrigin(.5,.5).setTint(E.character_slot_name.hex).setScale(.6),this.titleText.originalFontSize=this.titleText.style.fontSize,this.titleFrame=new Phaser.GameObjects.Sprite(this.scene,0,0,"ui","bg-inputfield").setScale(.9),this.title.add([this.titleFrame,this.titleText]),this.add([this.window,this.title])}createButtons(){this.closeButton=new be(this.scene,.465*this.windowWidth,.5*-this.windowHeight).setDefaultTint(Phaser.Display.Color.IntegerToRGB(E.button_blue_default.hex)).createImage("ui","button-round-stroke",!1,.88,0,4).createImage("ui","button-round-fill",!0,.9).createImage("ui","icon-close",!1,.9).setCallback(()=>{o.instance.playSound("main-audio","randombutton",this.scene),Vt.instance.closeScreen(this.name)},this),this.enButton=new Ft(this.scene,-75,-35,Oe,"en"),this.esButton=new Ft(this.scene,0,-35,Oe,"es"),this.deButton=new Ft(this.scene,75,-35,Oe,"de"),this.ptButton=new Ft(this.scene,-112.5,45,Oe,"pt"),this.ruButton=new Ft(this.scene,-37.5,45,Oe,"ru"),this.trButton=new Ft(this.scene,37.5,45,Oe,"tr"),this.nlButton=new Ft(this.scene,112.5,45,Oe,"nl"),this.add([this.closeButton,this.nlButton,this.enButton,this.deButton,this.esButton,this.ptButton,this.trButton,this.ruButton])}closeWindow(){Vt.instance.closeScreen(this.name)}resizeWindow(e,t){var s=this.windowWidth,i=this.windowHeight;this.maskGraphics.clear().fillRoundedRect(this.x-.5*s*t.y,this.y-.5*i*t.y,s*t.y,i*t.y,15*t.y)}onResize(e,t){super.onResize(e,t),this.setSize(e.width,e.height),this.setScale(t.y),this.resizeWindow(e,t)}}class Vt extends n{constructor(){super(),this.emitter=new Phaser.Events.EventEmitter,window.sm=this}init(e){this.scene=e,r.instance.emitter.on("resize",this.onResize,this),this.inited||(this.createScreenBorders(),this.createOverlay(),this.createScreens())}onResize(e,t){this.overlay,this.overlay.setScale(10*t.y),this.screenBorder&&this.resizeScreenBorder()}getScreens(){return Object.values(this.screens)}createScreens(){var e=window.innerWidth/2,t=window.innerHeight/2;this.screens={TOSScreen:new Pt(this.scene,e,t,De),NotificationScreen:new Et(this.scene,e,t,De),nameInputScreen:new pt(this.scene,e,t,Te),previewScreen:new ft(this.scene,e,t,Se),customisationScreen:new It(this.scene,0,0,99999999),settingsScreen:new Gt(this.scene,0,0,De),languageScreen:new Rt(this.scene,0,0,De)},this.getScreens().forEach(e=>{this.scene.add.existing(e),e.close(!0)})}createOverlay(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:De;this.overlay=new Phaser.GameObjects.Rectangle(this.scene,window.innerWidth/2,window.innerHeight/2,window.innerWidth,window.innerHeight,E.overlay_black.hex,.4).setDepth(e).setInteractive().setVisible(!1),this.scene.add.existing(this.overlay)}createScreenBorders(){var{width:e,height:t}=r.instance;this.screenBorder=this.scene.add.image(e/2,t/2,"ui","item-background").setDisplaySize(390,2).setDepth(999999999999).setVisible(!1),this.scene.add.existing(this.screenBorder)}resizeScreenBorder(){this.screenBorder.x=r.instance.width/2,this.screenBorder.y=r.instance.height/2,this.screenBorder.setDisplaySize(r.instance.getScreenWidth(),2)}toggleFocus(e,t,s){this.overlay.setVisible(e),e&&(t===this?(t.add.existing(this.overlay),this.overlay.setPosition(window.innerWidth/2,window.innerHeight/2),this.overlay.setDepth(s)):(t.add(this.overlay),this.overlay.setPosition(0,0),this.overlay.setDepth(s),t.sort("depth")))}openScreen(e){this.screens[e].open()}closeScreen(e,t){t?this.screens[e].hardClose():this.screens[e].close()}async swapScreens(e,t){e.forEach(e=>this.closeScreen(e)),await this.wait(e[0].waitTime),t.forEach(e=>this.openScreen(e))}async wait(e){}closeAll(){let e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.getScreens().forEach(t=>{t.visible&&this.closeScreen(t.name,e)})}}Vt.MAXIMUM_WIDTH=390;class Mt extends n{constructor(){super(),this.initVariables(),window.cdm=this}initVariables(){this.emitter=new Phaser.Events.EventEmitter,this.resetBooleans(),this.mainCharacterData={},this.secondaryCharacterData={},this.version={},this.shownTutorial={},this.categoryKeys=Object.keys(X).filter(e=>X[e].customizable),this.selectedOptions={},this.selectedColors={}}init(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.scene=e,this.shouldRetrieveCharacterData=t}resetBooleans(){this.mainCharacterCreated=!1,this.secondaryCharacterCreated=!1}validateData(){return this.version=this.validateLocalData("version","gameVersion"),this.shownTutorial=this.validateLocalData("shownTutorial","gameVersion"),!!this.shouldRetrieveCharacterData&&(this.mainCharacterData=this.validateLocalData("mainCharacter","characterFormat"),this.secondaryCharacterData=this.validateLocalData("secondaryCharacter","characterFormat"),!0)}validateLocalData(e,t){try{var s=O.instance.getData(e);return"object"==typeof s&&this.validateVersion(t)?s:{name:"",options:{}}}catch(e){return console.error(e),{}}}validateVersion(e){try{var t=O.instance.getData("version");return"object"==typeof t&&t[e]===p[e].current}catch(e){return console.error(e),!1}}setPlayerData(e,t){e?this.mainCharacterData.options=t:this.secondaryCharacterData.options=t}getPlayerData(){const e={};return this.categoryKeys.forEach(t=>{Object.keys(X[t].subcategories).forEach(s=>{if(void 0===this.selectedOptions[s]){var i=X[t].subcategories[s],a=this.getRandomArrayValue(i.colors);i=this.getRandomArrayValue(i.options);if(!a||!i)return;this.selectedColors[s]=a,this.selectedOptions[s]=i}e[s]={id:this.selectedOptions[s].id,color:{r:this.selectedColors[s].r,g:this.selectedColors[s].g,b:this.selectedColors[s].b}}})}),e}setPlayerName(e,t){e?this.mainCharacterData.name=t:this.secondaryCharacterData.name=t,this.saveName(e)}saveName(e){var t,s=e?"mainCharacter":"secondaryCharacter";(e=(e?this.mainCharacterData:this.secondaryCharacterData).name)&&((t=O.instance.getData(s)||{}).name=e,O.instance.setData({[s]:t}))}saveCharacter(e){var t,s=e?"mainCharacter":"secondaryCharacter";(e=(e?this.mainCharacterData:this.secondaryCharacterData).options)&&((t=O.instance.getData(s)||{}).options=e,O.instance.setData({[s]:t}))}getRandomArrayValue(e){return e[Math.floor(Math.random()*e.length)]}setAttatchmentOptions(e,t,s){t&&s&&this.character&&(this.selectedColors[e]=s,this.selectedOptions[e]=t,Mt.checkSkinColor(e,this.character,s),this.character.setAttachment(t.attachments,s),Mt.checkBald(e,this.character),Mt.checkShape(e,this.character))}setBasicCharacter(){var e=this.categoryKeys;for(let o=0;o<e.length;o++){var t=e[o],s=X[t];if(!s.ignore){var i=Object.keys(s.subcategories);for(let e=0;e<i.length;e++){var a=i[e],n=s.subcategories[a];let t=this.getRandomArrayValue([n.colors[0]]),o=this.getRandomArrayValue(n.options);switch(a){case"shirt":o=n.options.find(e=>11===e.id),t={r:255,g:255,b:255};break;case"pants":o=n.options.find(e=>2===e.id),t={r:255,g:255,b:255};break;default:o=n.options.find(e=>0===e.id)}this.setAttatchmentOptions(a,o,t)}}}this.emitter.emit("setCategory")}setColor(e,t,s){switch(t){case"skin":switch(s){case"shape":this.character.setSkinColor(e);break;case"eyes":this.character.setAttachmentColor("iris",e);break;case"nose":break;case"lips":this.character.setAttachmentColor("mouth",e)}break;case"hair":switch(s){case"hair_front":this.character.setAttachmentColor("hair-top",e),this.character.setAttachmentColor("hair-middle",e),this.character.setAttachmentColor("hair-behind",e),this.character.setAttachmentColor("brow-l",e),this.character.setAttachmentColor("brow-r",e);break;case"hair_back":break;case"hair_facial":this.character.setAttachmentColor("hair-facial",e)}break;case"clothes":switch(s){case"shirt":this.character.setAttachmentColor("costume-body",e),this.character.setAttachmentColor("costume-body-back",e),this.character.setAttachmentColor("costume-l-arm-upper",e),this.character.setAttachmentColor("costume-l-arm-lower",e),this.character.setAttachmentColor("costume-r-arm-upper",e),this.character.setAttachmentColor("costume-r-arm-lower",e),this.character.setAttachmentColor("costume-dress",e);break;case"pants":this.character.setAttachmentColor("costume-pants",e),this.character.setAttachmentColor("costume-l-leg-upper",e),this.character.setAttachmentColor("costume-l-leg-lower",e),this.character.setAttachmentColor("costume-r-leg-upper",e),this.character.setAttachmentColor("costume-r-leg-lower",e);break;case"skirt":this.character.setAttachmentColor("costume-pants",e),this.character.setAttachmentColor("costume-skirt",e);break;case"shoes":this.character.setAttachmentColor("costume-l-foot-bot",e),this.character.setAttachmentColor("costume-r-foot-bot",e);break;default:this.onChangeColor(e,t,s="shirt")}break;case"accessories":switch(s){case"hats":this.character.setAttachmentColor("costume-accessories-hat",e),this.character.setAttachmentColor("costume-accessories-hat-back",e);break;case"glasses":this.character.setAttachmentColor("costume-accessories-glasses",e),this.character.setAttachmentColor("costume-accessories-glasses-back",e);break;case"jewelry":this.character.setAttachmentColor("costume-accessories-jewelry",e),this.character.setAttachmentColor("costume-accessories-jewelry-back",e);break;case"makeup":this.character.setAttachmentColor("costume-accessories-makeup",e),this.character.setAttachmentColor("costume-accessories-makeup-back",e)}}"nose"!==s&&this.saveColor(s,e)}saveColor(e,t){this.selectedColors[e]=t}cleanCharacterData(e,t,s){Object.keys(t).forEach(e=>{var s=t[e].id;It.findOption(e,s)||delete t[e]}),e.isDirty=!1,s?this.mainCharacterData.options=t:this.secondaryCharacterData.options=t,this.saveCharacter(s)}swapCharacters(){this.emitter.emit("swapNames");var e=this.mainCharacterData;this.mainCharacterData=this.secondaryCharacterData,this.secondaryCharacterData=e,this.emitter.emit("swapCharacters")}setCharacter(e){this.character=e}setCharacterCustomisation(e,t){if(this.setCharacter(e),this.hasData(t.options))try{this.setCharacterData(t.options)}catch(e){console.error(e),this.randomizeCharacter()}else this.setDefaultCharacter();return Vt.instance.screens.customisationScreen.setCategory(),this}hasData(e){let t=!1;if(e)try{return 0<Object.keys(e).length}catch(e){}return t}setDefaultCharacter(){this.setCharacterData(this.getDefaultCharacter())}getDefaultCharacter(e){return e?J[e]:this.getRandomArrayValue(J)}setCharacterData(e){Object.keys(e).forEach(t=>{var s=e[t].id,i=e[t].color;if(this.selectedOptions[t]=It.findOption(t,s),this.selectedColors[t]=It.findColor(t,i),!this.selectedColors[t]){if(!(s=It.findCategory(t)))return;i=X[s].subcategories[t],[this.selectedColors[t]]=i.colors}this.setAttatchmentOptions(t,this.selectedOptions[t],this.selectedColors[t])})}randomizeCharacter(){var e=this.categoryKeys,t=["skirt","glasses","jewelry","makeup","hats","hair_facial"];for(let r=0;r<e.length;r++){var s=e[r],i=X[s],a=Object.keys(i.subcategories);for(let e=0;e<a.length;e++){var n=a[e],o=i.subcategories[n];let s=this.getRandomArrayValue(o.colors),r=this.getRandomArrayValue(o.options);t.includes(n)&&.2<Math.random()&&(r=this.getRandomArrayValue([o.options[0]])),"shape"===n&&(o=o.colors.slice(0,8),s=this.getRandomArrayValue(o)),"nose"===n&&(s=this.selectedColors.shape),this.setAttatchmentOptions(n,r,s)}}return this.emitter.emit("setCategory"),this.getPlayerData()}static setCharacterOptions(e,t){var s=e.visible;e.setVisible(!1),t?Object.keys(t).forEach(s=>{var i=t[s].id,a=t[s].color;(i=It.findOption(s,i))?(a=It.findColor(s,a),e.setAttachment(i.attachments,a),Mt.checkSkinColor(s,e,a),Mt.checkBald(s,e),Mt.checkShape(s,e)):e.isDirty=!0}):Mt.setCharacterOptions(e,Mt.instance.getDefaultCharacter()),e.setVisible(s)}checkIsPreset(e){var t=e?this.mainCharacterData:this.secondaryCharacterData;for(let e=0;e<J.length;e++){var s=J[e];if(this.isSameObject(s,t.options))return!0}return!1}isSameObject(e,t){return JSON.stringify(e)===JSON.stringify(t)}static checkSkinColor(e,t,s){"shape"===e&&t.setSkinColor(s)}static checkBald(e,t){"hair_front"===e&&t.checkBald()}static checkShape(e,t){"shape"!==e&&"hair_facial"!==e||t.checkShape()}}Mt.characterOptionCategories=["shape","eyes","nose","lips","hair_front","hair_facial","shirt","pants","skirt","shoes","hats","glasses","jewelry"];class Ut extends n{get adTimeScale(){return this._adTimeScale}set adTimeScale(e){this._adTimeScale=e,this.checkState()}get focusTimeScale(){return this._focusTimeScale}set focusTimeScale(e){this._focusTimeScale=e,this.checkState()}get gameTimeScale(){return this._gameTimeScale}set gameTimeScale(e){this._gameTimeScale=e,this.checkState()}get timeScale(){return this._timeScale}set timeScale(e){this._timeScale=e}init(e){this.setScene(e),this._adTimeScale=1,this._focusTimeScale=1,this._gameTimeScale=1,this._timeScale=1,this._inputFocus=0,this.checkState(),x.instance.onPauseRequested(this.onPauseRequested,this),x.instance.onResumeRequested(this.onResumeRequested,this)}setScene(e){this.scene&&(e.game.events.off(Phaser.Core.Events.FOCUS,this.onFocus,this),e.game.events.off(Phaser.Core.Events.BLUR,this.onBlur,this),e.game.events.off(Phaser.Core.Events.HIDDEN,this.onBlur,this),e.game.events.off(Phaser.Core.Events.VISIBLE,this.onFocus,this)),(this.scene=e).game.events.on(Phaser.Core.Events.FOCUS,this.onFocus,this),e.game.events.on(Phaser.Core.Events.BLUR,this.onBlur,this),e.game.events.on(Phaser.Core.Events.HIDDEN,this.onBlur,this),e.game.events.on(Phaser.Core.Events.VISIBLE,this.onFocus,this)}onPauseRequested(){this.adTimeScale=0}onResumeRequested(){this.adTimeScale=1}onBlur(){this.focusTimeScale=0<this._inputFocus?1:0}onFocus(){this.focusTimeScale=1}pause(){o.instance.pause(),this.scene.scene.pause()}resume(){o.instance.resume(),this.scene.scene.resume()}checkState(){this.timeScale=this.adTimeScale*this.focusTimeScale*this.gameTimeScale,0<this.timeScale?this.resume():this.pause()}inputFocus(){this._inputFocus++}inputBlur(){this._inputFocus--}}class zt extends Phaser.GameObjects.Container{constructor(e,t,s,i,a,n){super(e,t,s),this.elementWidth=i,this.elementHeight=a,this.checkMethods=[this.checkBadWords],this.badWordRegex=[],this.maxWidth=200,this.maxLetters=15,this.isMain="secondaryCharacterInput"!==n,this.elementName=n,this.setElement(this.elementName),this.blurred=!0,this.createBadWordsList(),this.createInputField(),this.setColors(),this.on("destroy",this.onDestroy,this),this.scene.input.on("pointerdown",e=>{this.doOnblur(e)},this),r.instance.emitter.on("cameraMoved",this.onCameraMoved,this),r.instance.emitter.on("preresize",this.onPreresize,this),lt.instance.emitter.on("languageChanged",this.onLanguageChanged,this),this.on("destroy",this.onDestroy,this)}onDestroy(){lt.instance.emitter.off("languageChanged",this.onLanguageChanged,this)}onPreresize(){}onLanguageChanged(){this.element.placeholder=lt.instance.get(me.NAME_INPUT_PLACEHOLDER)}saveValue(e){this.element.value&&(e?He.instance.finishStep(Z):He.instance.finishStep(ae)),Mt.instance.setPlayerName(e,this.getValue())}createBadWordsList(){this.scene.cache.json.get("badWordsEnglish").forEach(e=>{var t=new RegExp(e.toUpperCase(),"i");t.word=e,this.badWordRegex.push(t)})}onDestroy(){this.element.onblur=null,this.element.onfocus=null,this.element.removeEventListener("keyup",this.onKeyUpFunction),this.element.removeEventListener("keypress",this.updateTextFunction),this.element.removeEventListener("keydown",this.updateTextFunction),this.scene.input.off("pointerdown",this.doOnblur,this)}reset(){return this.element.value="",this}setValue(e){return this.element.value=e||null,this.updateText(),this}setPlaceholder(e){return this.placeHolderText=e,this.inputText.setText(this.placeHolderText),this.element.placeholder=lt.instance.get(e),this.updatePhaserText(),this}setDefaultValue(e){return this.defaultValue=e,this}createInputField(){this.inputField=new Phaser.GameObjects.Image(this.scene,0,-9,"ui","bg-inputfield"),this.inputFieldHighlight=new Phaser.GameObjects.Image(this.scene,0,-9,"ui","bg-inputfield").setScale(1.05,1.2).setTint(E.tutorial_highlight.hex).setAlpha(0,0,1,1).setVisible(!1),this.inputText=new Phaser.GameObjects.Text(this.scene,0,0,this.placeHolderText,pe.inputText).setOrigin(.5,.5),this.inputText.visible=!1,this.add(this.inputFieldHighlight),this.add(this.inputField),this.add(this.inputText),this.createPhaserText()}popTween(e){this.scene.add.tween({targets:this,scale:{from:this.scale,to:0},duration:e,onStart:()=>{this.deactivateElement()},onComplete:()=>{this.activateElement()},ease:Phaser.Math.Easing.Sine.InOut,yoyo:!0})}toggleFieldHighlight(e){this.inputFieldHighlight.setVisible(e),e?this.highlightTween=this.scene.tweens.add({targets:this.inputFieldHighlight,scaleX:{from:1,to:1.05},scaleY:{from:1,to:1.2},alpha:{from:1,to:0,duration:1e3},duration:500,ease:Phaser.Math.Easing.Sine.Out,loop:-1}):this.highlightTween&&this.highlightTween.stop()}createPhaserText(){this.phaserText=new Phaser.GameObjects.Text(this.scene,0,-9,"",pe.inputText).setScale(1/zt.PHASER_TEXT_SCALE).setOrigin(.5,.5).setColor(E.input_field_main_text.hash),this.add(this.phaserText)}onOut(){this.isDown&&(this.scaleX+=.05,this.scaleY+=.05),this.isDown=!1}onUp(){var e;this.isDown&&(this.isDown=!1,this.scaleX+=.05,this.scaleY+=.05,e=He.instance.currentStep,!this.checkBadWords()||e&&e.id===Z||(this.isMain?(this.scene.nameInputScreen.mainEditButton.editCharacter(),He.instance.finishStep(Q),N.instance.updatePlaythrough(Q)):(this.scene.nameInputScreen.secondaryEditButton.editCharacter(),He.instance.finishStep(ne),N.instance.updatePlaythrough(ne))))}onDown(){this.isDown=!0,this.scaleX-=.05,this.scaleY-=.05}setColors(){this.inputField.setScale(1,1),this.inputField.setTint(E.input_field_main.hex)}setTextScale(e,t){var s=r.instance.realDPR;this.setElementSize(this.elementWidth*e/s,this.elementHeight*t/s),this.element.style["font-size"]=zt.FONT_SIZE*t/s+"px",this.phaserText.setFontSize(zt.FONT_SIZE*zt.PHASER_TEXT_SCALE+"px")}setElement(e){return e=document.getElementById(e),this.element=e,this.element.value="",this.onblurFunction=this.onblur.bind(this),this.onfocusFunction=this.onfocus.bind(this),this.updateTextFunction=this.updateText.bind(this),this.onKeyUpFunction=this.onKeyUp.bind(this),this.element.onblur=this.onblurFunction,this.element.onfocus=this.onfocusFunction,this.element.addEventListener("keyup",this.onKeyUpFunction),this.element.addEventListener("keypress",this.updateTextFunction),this.element.addEventListener("keydown",this.updateTextFunction),this}setFirstCharacterActive(){return this.reset().setPlaceholder(me.NAME_INPUT_PLACEHOLDER).setValue(Mt.instance.mainCharacterData.name).setDefaultValue("Person 1"),this}setSecondCharacterActive(){return this.reset().setPlaceholder(me.NAME_INPUT_PLACEHOLDER).setValue(Mt.instance.secondaryCharacterData.name).setDefaultValue("Person 2"),this}onKeyUp(e){"Enter"===e.key?this.doOnblur():(o.instance.playSound("main-audio","type",this.scene),this.updateText())}onfocus(e){e.preventDefault(),e.stopPropagation(),window.scrollTo(0,0),r.instance.setKeyboardVisible(!0),o.instance.playSound("main-audio","namebutton",this.scene),this.blurred=!1,He.instance.currentStep&&He.instance.currentStep.id!==q&&He.instance.skippedTutorial,this.inputText.setText(this.element.value),N.instance.performAction("select_name",{name:this.element.value},!0),x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"button-press:selectName:"+this.elementName),Ut.instance.inputFocus()}onblur(){r.instance.setKeyboardVisible(!1),Ut.instance.inputBlur(),window.scrollTo(0,0),this.blurred=!0,0===this.element.value.length&&this.inputText.setText(this.placeHolderText),this.isValid()&&(He.instance.currentStep&&He.instance.currentStep.id!==q&&!He.instance.skippedTutorial&&Ie.instance.updateNameText(),N.instance.performAction(`enter_name_${this.name}_character`,{name:this.element.value,character:this.name+"_character"},!0),this.isMain?(Mt.instance.emitter.emit("setMainCharacterName",!0),N.instance.uploadNames(this.element.value,"main_character"),N.instance.updatePlaythrough(Z)):(Mt.instance.emitter.emit("setSecondaryCharacterName",!1),N.instance.uploadNames(this.element.value,"secondary_character"),N.instance.updatePlaythrough(ae)))}doOnblur(){this.element.blur(),this.setValue(this.element.value)}updateText(){this.validateText(),this.inputText.setText(this.element.value),this.setMaxWidth(),this.updatePhaserText(),Mt.instance.emitter.emit("updateText")}updatePhaserText(){this.phaserText.text=this.element.value}goToHTMLText(){this.phaserText.text="",this.inputField.disableInteractive(),this.showElement()}validateText(){var e;this.element.value.length>this.maxLetters&&(e=this.element.value.substring(0,this.maxLetters),this.element.value=e),this.element.value=this.element.value.toUpperCase(),this.element.setCustomValidity("")}isValid(){for(let e=0;e<this.checkMethods.length;e++)if(!this.checkMethods[e].call(this))return!1;return!0}checkLength(){return 0!==this.element.value.length||(this.element.setCustomValidity("Fill in a name."),this.element.reportValidity(),!1)}checkBadWords(){var e=this.element.value;for(let s=0;s<this.badWordRegex.length;s++){var t=this.badWordRegex[s];if(t.test(e))return this.element.setCustomValidity(`"${t.word.toUpperCase()}" is not allowed.`),this.element.reportValidity(),!1}return!0}setMaxWidth(){var e=Phaser.Math.Clamp(this.maxWidth/this.inputText.width,0,1);this.inputText.setScale(e,e)}setElementSize(e,t){return this.element.style.width=e+"px",this.element.style.height=t+"px",this}setPhaserTextSize(e,t){return this.phaserText.width=e+"px",this.phaserText.height=t+"px",this}showElement(){return this.scene.tweens.addCounter({from:0,to:1,duration:500,onUpdate(e){e=e.getValue(),this.phaserText.setAlpha(e)},onUpdateScope:this}),this}hideElement(){return this.scene.tweens.addCounter({from:1,to:0,duration:0<arguments.length&&void 0!==arguments[0]?arguments[0]:500,onUpdate(e){e=e.getValue(),this.phaserText.setAlpha(e)},onUpdateScope:this}),this}disableElement(){return this.element.type="hidden",this.phaserText.setVisible(!1),this}enableElement(){return this.element.type="",this.phaserText.setVisible(!0),this}activateElement(){return this.enableElement().showElement(),this}deactivateElement(){return this.hideElement().disableElement(),this}getValue(){return this.element.value||this.defaultValue}static setFontSize(e){try{var t=document.getElementById(e);this.FONT_SIZE=parseInt(window.getComputedStyle(t,null).getPropertyValue("font-size"),10)}catch(e){}}onCameraMoved(e,t,s){s=s/(e*window.devicePixelRatio)*100,"mainCharacterInput"===this.element.id?this.element.style.top=42.4+s+"%":this.element.style.top=66.8+s+"%"}}zt.FONT_SIZE=20,zt.PHASER_TEXT_SCALE=2;class jt extends n{constructor(){super(),this._scene=null,this._metrics={}}initialize(e){this._scene=e}setMetrics(){}getMetrics(e){var t=e.fontSize,s=e.fontFamily;return this._metrics[s]||(this._metrics[s]={}),this._metrics[s][t]||(this._metrics[s][t]=this._createNewMetric(e)),this._metrics[s][t]}setMetricsToStyle(e){e.metrics=this.getMetrics(e)}_createNewMetric(e){var t=(e=new Phaser.GameObjects.Text(this._scene,0,0,"",e)).getTextMetrics();return e.destroy(),t}}t=class extends i.a.Scene{constructor(){super({key:"BootScene"})}preload(){r.instance.init(this),class{static inject(e){var t=new Phaser.GameObjects.Text(e,0,0),s=t.style;Object.getPrototypeOf(s).setFontSize=function(e){return"number"==typeof e&&(e=e.toString()+"px"),this.fontSize!==e&&(this.fontSize=e,this.fontFamily,this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.metrics=jt.instance.getMetrics({fontFamily:this.fontFamily,fontSize:this.fontSize}),this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.update(!this.metrics)),this.parent},Object.getPrototypeOf(s).setFontFamily=function(e){return this.fontFamily!==e&&(this.fontFamily=e,this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.metrics=jt.instance.getMetrics({fontFamily:this.fontFamily,fontSize:this.fontSize}),this.update(!this.metrics)),this.parent},Object.getPrototypeOf(t).setText=function(t){var s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t!==this._i18nKey&&(this._i18nKey=t.toString()||""),this._interpolations=s,t=this._setText(e.i18n.t(this._i18nKey,this._interpolations)||"");return this.style.wordWrapWidth&&this._i18nKey&&(s=Phaser.Math.Clamp(this.style.wordWrapWidth/t.width,0,1),this.setScale(s,s)),t},t.destroy()}}.inject(this),class{static inject(){String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return"[object regexp]"===Object.prototype.toString.call(e).toLowerCase()?this.replace(e,t):this.replace(new RegExp(e,"g"),t)})}}.inject(),O.instance.loadData(),class{static inject(e){Object.getPrototypeOf(e.input.manager).transformTouchPointer=function(e,t,s,i){var a=e.position,n=e.prevPosition;n.x=a.x,n.y=a.y,t=this.scaleManager.transformTouchX(t),s=this.scaleManager.transformTouchY(s),e=e.smoothFactor;i&&0!==e?(a.x=t*e+n.x*(1-e),a.y=s*e+n.y*(1-e)):(a.x=t,a.y=s)}}}.inject(this),class{static inject(e){(e=Object.getPrototypeOf(e.scale)).transformTouchX=function(e){return e*this.displayScale.x},e.transformTouchY=function(e){return e*this.displayScale.y}}}.inject(this),this.load.image("loadingLogo","assets/images/love-tester-icon.png")}async create(){this.initialiseLocalisation(),zt.setFontSize("input"),jt.instance.initialize(this),this.scene.start("SplashScene")}initialiseLocalisation(){this.i18n.initialize({fallbackLng:"en",loadPath:"assets/jsons/languages/{{lng}}.json",debug:!1},()=>{console.log("I18nPlugin initialized!")})}},s(413);class Ht extends class{constructor(e,t,s,i){this.scene=e,this.backgroundColor=t,this.textColor=s,this.percentColor=i,this.init()}init(){var e=r.instance.realDPR,t=22*e,s=window.innerWidth/2*e,i=window.innerHeight/2*e;this.setBackgroundColor(this.backgroundColor),this.createLogo(e,s,i,.7),this.createPercentText(e,s,i,t),this.createNameText(e,s,i,t),this.createEventListeners()}createEventListeners(){this.scene.load.on("progress",this.updatePercentageText,this),this.scene.load.on("complete",()=>{this.scene.load.off("progress",this.updatePercentageText,this)})}createNameText(e,t,s,i){this.nameText=this.scene.make.text({x:t,y:s+80*e,text:"Love Tester",style:{fill:this.textColor}}).setOrigin(.5,.5).setFontSize(i).setFontFamily("Arial").setStroke(this.textColor,.5)}createPercentText(e,t,s){this.loadingText=this.scene.add.text(t,s+110*e,"Loading: 0%",pe.title).setTint(this.textColor).setOrigin(.5,.5)}createLogo(e,t,s,i){i*=e,this.loadingLogo=this.scene.add.image(t,s,"loadingLogo").setScale(i),this.loadingLogo.setVisible(x.instance.hasFeature("logo"))}setDepth(e){this.nameText.setDepth(e),this.loadingLogo.setDepth(e)}updatePercentageText(e){e=i.a.Math.RoundTo(99*e,0),this.loadingText.setText("LOADING",{percentage:e})}setBackgroundColor(e){this.scene.cameras.main.setBackgroundColor(e)}}{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;super(e,E.splash_loading_background.hex,E.splash_loading_text.hash,E.splash_loading_percentage.hash),this.updatePercentageText(t)}}var Yt=class extends i.a.Scene{constructor(){super({key:"SplashScene"})}async init(){this.loadLoadingScreen(),this.emitter=new i.a.Events.EventEmitter}preload(){window.screen&&window.screen.orientation&&window.device&&"iOS"!==window.device.platform&&window.screen.orientation.lock("portrait"),this.sceneToLoad="CharacterCreator",N.instance.trackLoading(),document.addEventListener("deviceready",this.onDeviceReady,this),this.assets=[],this.loadAtlasses(),this.loadImages(),this.loadSpines(),this.loadAudio(),this.loadJSONs()}onDeviceReady(){console.log("firebase complete");try{window.universalLinks.subscribe("openWithLink",this.linkFromLaunch,this)}catch(e){console.error(e)}console.log("universal complete")}get uniqueID(){window.device&&window.device.uuid}linkFromLaunch(e){this.setData(e.url)}isShareLink(e){return e.has("c2hhcmV")}async checkLink(){var e,t;window.device||(e=window.location.search,t=new URLSearchParams(e),this.isShareLink(t)&&(x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"shareLink:opened"),await this.setData(e)))}async setData(e){this.sceneToLoad="ScenarioMachine";const t=new URLSearchParams(e).get("YWxsI");return await new Promise(e=>{A.instance.emitter.once("firebase:loggedIn",()=>{this.processSceneData(t,e)})})}async processSceneData(e,t){let s;await A.instance.fetchLinkData(e).then(e=>{s=e}),Mt.instance.mainCharacterData.options=s.mainCharacterOptions,Mt.instance.secondaryCharacterData.options=s.secondaryCharacterOptions,Mt.instance.mainCharacterData.name=s.mainCharacterName,Mt.instance.secondaryCharacterData.name=s.secondaryCharacterName,this.dataToSend={scenario:s.scenario,danceA:s.danceA,danceB:s.danceB,text:s.text,sharedLink:!0},t()}queueLoadDuration(e){this.assets.push({item:e,duration:N.instance.getDurationSincePrevious(N.instance.preloadStart)})}loadLoadingScreen(){lt.instance.setScene(this).inject(),lt.instance.init(this),this.loadingScreen=new Ht(this),this.load.on("progress",this.sendPreloadProgress,this)}sendPreloadProgress(e){try{window.famobi.setPreloadProgress(100*e)}catch(e){}}loadAtlasses(){this.load.setPath("assets/atlasses/"),this.load.atlas("ui","ui.png","ui.json"),this.load.atlas("defaultCharacters","defaultCharacters.png","defaultCharacters.json")}loadImages(){this.load.setPath("assets/images")}loadSpines(){this.load.setPath("assets/spines/"),this.load.spine("puppet","character_1.json","character_1.atlas",!0)}async loadAudio(){window.device&&"iOS"===window.device.platform?(this.cache.json.add("main-audio",mainAudio),await(new(window.AudioContext||window.webkitAudioContext)).decodeAudioData(toArrayBuffer(mainAudioSrc),e=>{this.cache.audio.add("main-audio",e)},e=>{console.warn("Error with decoding audio data"+e.err)})):(this.load.setPath("assets/sounds/"),this.load.audioSprite("main-audio","main-audio.json",["main-audio.mp3","main-audio.m4a","main-audio.ogg"]))}loadJSONs(){this.load.setPath("assets/jsons/"),this.load.json("badWordsEnglish","bad-words-en.json")}initialiseSentry(){}async create(){var e;await x.instance.init(this),Ut.instance.init(this),this.initialiseSentry(),b.instance.init(),o.instance.init(this),o.instance.addAudioSprite("main-audio"),y.instance.emitter.on("onShow",o.instance.resumeAll,o.instance),y.instance.emitter.on("onHide",o.instance.pauseAll,o.instance),await this.checkLink(),this.queueLoadDuration("start_firebase_await"),A.instance.onFetchedData(),this.queueLoadDuration("finish_firebase_await"),b.instance.trackCustomEvent("game","loaded"),N.instance.setLoadData(this.assets),x.instance.gameReady(),"ScenarioMachine"===this.sceneToLoad&&(e=We[this.dataToSend.scenario]||We[0],await x.instance.levelStart(e.name)),this.scene.start(this.sceneToLoad,this.dataToSend)}validateCategories(){Object.keys(X).forEach(e=>{X[e].customizable&&Object.keys(X[e].subcategories).forEach(t=>{const s=X[e].subcategories[t];s.options.forEach(e=>{const t=e.id;s.options.some(s=>s!==e&&t===s.id)})})})}update(){}},Wt=class extends i.a.Scene{constructor(){super({key:"GameScene"})}init(){}preload(){}create(){const e=this.add.spine(700,950,"puppet");e.setSkinByName("skin");let t=0;this.skinColors=["ffd6bb","ffcfa7","fcb885","e1996b","ca8b65","b37e64","916451","68483d"],e.setAttachment("head","head-sharp"),e.play("run",!0),setInterval(()=>{t++;var s=t%2?"head-round":"head-sharp",i=(s=(e.setAttachment("head",t%2?"head-round":s),e.getAttachmentByName("head",s)),this.skinColors[Math.floor(Math.random()*this.skinColors.length)]);s.color.setFromString(i),(s=e.getAttachmentByName("body","body")).color.setFromString(i),(s=e.getAttachmentByName("r-arm-upper","r-arm-upper")).color.setFromString(i),(s=e.getAttachmentByName("r-arm-lower","r-arm-lower")).color.setFromString(i),(s=e.getAttachmentByName("r-arm-hand","r-arm-hand")).color.setFromString(i),(s=e.getAttachmentByName("r-hand-back","r-hand-back")).color.setFromString(i),(s=e.getAttachmentByName("l-hand-back","l-hand-back")).color.setFromString(i),(s=e.getAttachmentByName("r-arm-hand-fist","r-arm-hand-fist")).color.setFromString(i),(s=e.getAttachmentByName("l-arm-hand-fist","l-arm-hand-fist")).color.setFromString(i),e.getAttachmentByName("l-arm-upper","l-arm-upper").color.setFromString(i),e.getAttachmentByName("l-arm-lower","l-arm-lower").color.setFromString(i),e.getAttachmentByName("l-arm-hand","l-arm-hand").color.setFromString(i),e.getAttachmentByName("r-leg-upper","r-leg-upper").color.setFromString(i),e.getAttachmentByName("r-leg-lower","r-leg-lower").color.setFromString(i),e.getAttachmentByName("r-leg-foot","r-leg-foot").color.setFromString(i),e.getAttachmentByName("l-leg-upper","l-leg-upper").color.setFromString(i),e.getAttachmentByName("l-leg-lower","l-leg-lower").color.setFromString(i),e.getAttachmentByName("l-leg-foot","l-leg-foot").color.setFromString(i),e.getAttachmentByName("eyes-basic-lid","eyes-basic-lid").color.setFromString(i),e.getAttachmentByName("nose-round","nose-round").color.setFromString(i)},200)}};class Kt extends at{constructor(e){super(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1),this.name="wk",this.createDefault()}createDefault(){for(let e=0;e<this.defaultAmount;e++)this.push(new st(this.scene,"puppet",!0));super.createDefault()}}class Xt extends n{constructor(){super(),this.getOriginalValues()}getOriginalValues(){this.mainSceneOpened=O.instance.getData("mainSceneOpened"),this.spinningWheelOpened=O.instance.getData("spinningWheelOpened"),this.scenarioOpened=O.instance.getData("scenarioOpened")}progessMainSceneOpened(){this.mainSceneOpened++,x.instance.sendGAEvent(x.GA_EVENTS.PROGRESSION,"Start","playthrough_"+this.mainSceneOpened,"mainScene")}progessMainSceneClosed(){x.instance.sendGAEvent(x.GA_EVENTS.PROGRESSION,"Complete","playthrough_"+this.mainSceneOpened,"mainScene"),this.save()}progessSpinningWheelOpened(){this.spinningWheelOpened++,x.instance.sendGAEvent(x.GA_EVENTS.PROGRESSION,"Start","playthrough_"+this.spinningWheelOpened,"spinningWheel")}progessSpinningWheelClosed(){x.instance.sendGAEvent(x.GA_EVENTS.PROGRESSION,"Complete","playthrough_"+this.spinningWheelOpened,"spinningWheel"),this.save()}progessScenarioOpened(e){this.scenarioOpened++,x.instance.sendGAEvent(x.GA_EVENTS.PROGRESSION,"Start","playthrough_"+this.scenarioOpened,"scenario",e)}progessScenarioClosed(e,t){x.instance.sendGAEvent(x.GA_EVENTS.PROGRESSION,"Complete","playthrough_"+this.scenarioOpened,"scenario",e,t),this.save()}save(){O.instance.setData({mainSceneOpened:this.mainSceneOpened,spinningWheelOpened:this.spinningWheelOpened,scenarioOpened:this.scenarioOpened})}}class Jt extends Phaser.Scene{constructor(){super("CharacterCreator"),this.logVersion(),this.setEvents()}logVersion(){console.log("Lovetester - ",x.instance.getVersionOrigin())}init(){this.characterPool=new Kt(this,8),this.initialiseSingletons(),Xt.instance.progessMainSceneOpened(),A.instance.logScreenView("characterCreator","scene"),this.createEventListeners(),this.trackOrigin(),this.cameraFadeOut(1e3),this.languages=["tr","nl","de","en","es","pt","ru"],this.lanID=0,lt.instance.setScene(this)}pause(){o.instance.pauseSound("main-audio","menumusic"),this.scene.pause()}resume(){o.instance.resumeSound("main-audio","menumusic"),this.scene.resume()}cameraFadeOut(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:E.overlay_black.hex;this.cameras.main.setBackgroundColor(t),this.cameras.main.fadeOut(e)}cameraFadeIn(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:E.overlay_black.hex;this.cameras.main.setBackgroundColor(t),this.cameras.main.fadeIn(e)}fadeOut(e){this.scenarioId=e,this.cameraFadeOut(500),o.instance.fadeOut("main-audio","menumusic",450),this.cameras.main.once("camerafadeoutcomplete",this.goToNextScene,this)}goToNextScene(){N.instance.performAction("start_game"),o.instance.stopAll(),this.shutdown(),Xt.instance.progessMainSceneClosed(),this.scene.start("ScenarioMachine",{acceptedTOS:this.data.acceptedTOS,mainCharacter:Mt.instance.mainCharacterData,secondaryCharacter:Mt.instance.secondaryCharacterData,timeScale:this.timescale,scenario:this.scenarioId})}shutdown(){y.instance.emitter.off("onShow",this.resume,this),y.instance.emitter.off("onHide",this.pause,this),r.instance.emitter.off("resize",this.onResize,this),document.removeEventListener("pause",()=>{this.pause()},!1),document.removeEventListener("resume",()=>{this.resume()},!1),document.removeEventListener("resign",()=>{this.pause()},!1),document.removeEventListener("active",()=>{this.resume()},!1),document.removeEventListener("backbutton",this.goBackButton,!1)}setEvents(){A.instance.emitter.on("firebaseCompleted",()=>{O.instance.updateVersion(),N.instance.logSession(),N.instance.loadAction(),N.instance.uploadQueuedData()}),N.instance.trackGame(),N.instance.createNewPlaythrough()}onPostLoadFinished(){this.playMainMusic()}initialiseSingletons(){r.instance.init(this),Vt.instance.init(this),He.instance.init(this),Ie.instance.init(this),o.instance.init(this),Ye.instance.init(this),Mt.instance.init(this,!0),Ut.instance.setScene(this)}createEventListeners(){y.instance.emitter.on("onShow",this.resume,this),y.instance.emitter.on("onHide",this.pause,this),r.instance.emitter.on("resize",this.onResize,this)}create(){r.instance.fireResizeEvent(),He.instance.checkTutorialNeeded(this),Vt.instance.openScreen(Ne),this.cameraFadeIn(this.fadeTime),this.playMainMusic()}playMainMusic(){o.instance.playSound("main-audio","menumusic",this,{loop:!0})}update(){Vt.instance.screens.nameInputScreen&&Vt.instance.screens.nameInputScreen.moveTiledBackground()}onResize(){}createSplashLoadScreen(){Mt.instance.resetBooleans(),this.customisationDuration={start:window.performance.now(),end:0},this.currentDanceIndex=-1,this.timeTillFade=0,this.fadeTime=500,this.loadingScreen=new Ht(this,1)}goBackButton(){}trackOrigin(){this.trackedOrigin||(y.instance.tt?(b.instance.trackCustomEvent("game_origin","tiktok"),A.instance.logCustomEvent("origin_platform",{value:"TikTok"})):window.device?(b.instance.trackCustomEvent("game_origin",window.device.platform),A.instance.logCustomEvent("origin_platform",{value:window.device.platform})):(b.instance.trackCustomEvent("game_origin","website"),A.instance.logCustomEvent("origin_platform",{value:"website"}))),this.trackedOrigin=!0}}Jt.FORM_HEIGHT_MULTIPLIER=.515,Jt.CHARACTER_SCALE=.34,Jt.CHARACTER_HEIGHT_MULTIPLIER=.44,Jt.CHARACTER_X_OFFSET=1e3;var qt=s(187);s(209),qt={type:i.a.WEBGL,parent:"content",width:1280,height:720,localStorageName:"love-tester",resolution:window.devicePixelRatio||1,scale:{mode:i.a.Scale.ScaleModes.NONE,autoCenter:i.a.Scale.CENTER_HORIZONTALLY},render:{antialias:!0,multiTexture:!0,antialiasGL:!1,roundPixels:!0,mipmapFilter:"LINEAR"},fps:{smoothStep:!1},dom:{createContainer:!0},plugins:{scene:[{key:"SpinePlugin",plugin:window.SpinePlugin,mapping:"spine"},{key:"i18nPlugin",plugin:qt.I18nPlugin,mapping:"i18n"}]}};s(134);class Zt extends be{constructor(e){super(e,0,0),this.setVisible(!1),this.createButton(),this.setCallback(this.goHome,this),this.scene.emitter.on("remove-scenario-interaction",this.removeInteractive,this)}createHighlight(){this.highlight=new Phaser.GameObjects.Graphics(this.scene),this.highlight.fillStyle(E.tutorial_highlight.hex,1),this.highlight.fillRoundedRect(-this.background.displayWidth/2*.8,-this.background.displayHeight/2*.8,.8*this.background.displayWidth,.8*this.background.displayHeight,20),this.highlight.setVisible(!1),this.add(this.highlight)}createButton(){this.background=new Phaser.GameObjects.Image(this.scene,0,0,"ui","button-home").setOrigin(.5,.5),this.createHighlight(),this.button=this.background,this.assignClickEvents(this.button),this.icon=new Phaser.GameObjects.Image(this.scene,-70,-5,"ui","icon-home-mobile").setOrigin(.5,.5),this.buttonText=new Phaser.GameObjects.Text(this.scene,10,-5,me.NEWMATCH_BUTTON,pe.button).setOrigin(.5,.5),this.add([this.background,this.icon,this.buttonText])}toggleHighlight(e){this.highlight.setVisible(e),e?this.highlightTween=this.scene.tweens.add({targets:this.highlight,scaleX:{from:1,to:1.6},scaleY:{from:1,to:1.6},alpha:{from:1,to:0,duration:1e3},duration:500,ease:Phaser.Math.Easing.Sine.Out,loop:-1}):this.highlightTween&&this.highlightTween.stop()}show(){this.setVisible(!0),this.savedScale=this.scale,this.setScale(0,0),this.scene.tweens.add({targets:this,duration:500,scale:{from:0,to:this.savedScale},ease:Phaser.Math.Easing.Back.Out,onComplete:()=>{He.instance.setHandVisible(!0)}})}goHome(){N.instance.performAction("back_to_home"),He.instance.finishStep(ue),N.instance.updatePlaythrough(ue),x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"button-press:backToHome"),this.scene.fadeOut(this.onEndScenario,this),this.scene.emitter.emit("remove-scenario-interaction")}onEndScenario(){this.scene.goToCharacterCreator()}onResize(e,t,s,i){this.setScale(t.y).setPosition(e.width/2,i)}destroy(){this.scene.emitter.off("remove-scenario-interaction",this.removeInteractive,this)}}class Qt extends be{constructor(e){super(e,0,0),this.buttonWidth=44,this.buttonHeight=36,this.setVisible(!1),this.createButton(),this.setCallback(this.replay,this),this.scene.emitter.on("remove-scenario-interaction",this.removeInteractive,this)}createButton(){this.background=new Phaser.GameObjects.Image(this.scene,0,0,"ui","button-replay").setOrigin(.5,.5),this.button=this.background,this.assignClickEvents(this.button),this.icon=new Phaser.GameObjects.Image(this.scene,-0,-5,"ui","icon-restart-mobile").setOrigin(.5,.5).setTint(E.button_rewatch.hex),this.add([this.background,this.icon])}show(){this.setVisible(!0),this.savedScale=this.scale,this.setScale(0,0),this.scene.tweens.add({targets:this,duration:500,scale:{from:0,to:this.savedScale},ease:Phaser.Math.Easing.Back.Out})}replay(){N.instance.performAction("replay"),this.scene.fadeOut(this.onReplayScenario,this),this.scene.emitter.emit("remove-scenario-interaction"),x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"button-press:replayScenario")}async onReplayScenario(){o.instance.stopAll(),await x.instance.levelRestart(this.scene.scenarioData.name),this.scene.restart()}onResize(e,t,s,i){e=e.width/2-140*t.y,this.setScale(t.y).setPosition(e,i)}destroy(){this.scene.emitter.off("remove-scenario-interaction",this.removeInteractive,this)}}class $t extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,0,0),this.scenarioContainer=s,this.loveValue=t,this.tempValue=50,this.isCountingUp=!0,this.createText(t),this.setVisible(!0),this.setEvents(),this.shadowOffset=16}createText(e){this.startFontSize=30,this.loveTestResultText=new Phaser.GameObjects.Text(this.scene,0,0,e+"%",pe.result).setOrigin(.5,.5).setFontSize(this.startFontSize).setStroke(E.heart_outline_positive.hash,4).setVisible(!1),this.loveTestResultTextShadow=new Phaser.GameObjects.Text(this.scene,0,this.shadowOffset,e+"%",pe.result).setOrigin(.5,.5).setFontSize(this.startFontSize).setTint(E.heart_outline_positive.hex).setVisible(!1),this.add([this.loveTestResultTextShadow,this.loveTestResultText])}setEvents(){this.on("destroy",this.onDestroy,this),r.instance.emitter.on("resize",this.onResize,this)}onDestroy(){r.instance.emitter.off("resize",this.onResize,this)}onResize(e,t){this.resizeText(e,t)}resizeText(e,t){e=e.width/e.height,e=Phaser.Math.Clamp(e/us.SCENARIO_RATIO,0,1)/r.instance.dpr,this.loveTestResultText.setScale(1/(.8*e*t.y)),this.loveTestResultTextShadow.setScale(1/(.8*e*t.y))}startCalculationAnimation(){this.getRandomCalculationAnimation(),this.loveTestResultText.setVisible(!0),this.loveTestResultTextShadow.setVisible(!0),this.isFolowingBone=!0}finishCalculation(){var e=this.getFontSizeScaledByBone();const t=3*e;this.scene.tweens.addCounter({from:e,to:t,duration:1500,onUpdate:e=>{this.loveTestResultText.setFontSize(e.getValue()),this.loveTestResultTextShadow.setFontSize(e.getValue())},onComplete:()=>{this.completeCalculation(t)},ease:Phaser.Math.Easing.Sine.In})}completeCalculation(e){o.instance.playSound("general-audio","stun-1",this.scene);var t=["dance-1","dance-2","dance-3"];this.isFolowingBone=!1,t=t[Phaser.Math.Between(0,t.length-1)];o.instance.playSound("general-audio",t,this.scene),this.scene.tweens.addCounter({from:e,to:Phaser.Math.Clamp(40,0,180),duration:200,onUpdate:e=>{e=this.lerp(this.getFontSizeScaledByBone(),e.getValue(),e.totalProgress),this.loveTestResultText.setFontSize(e),this.loveTestResultTextShadow.setFontSize(e)},onComplete:()=>{this.isCalculating=!1,this.isFolowingBone=!0,this.scene.cameras.main.shake(400,.01),this.loveTestResultText.setText(this.loveValue+"%"),this.loveTestResultTextShadow.setText(this.loveValue+"%"),window.setTimeout(()=>{this.hasCompleted=!0},1500)},ease:Phaser.Math.Easing.Sine.Out})}getRandomCalculationAnimation(){var e=100*Math.random();50<=this.loveValue||50<=e?this.animateCalculation(0,this.loveValue,5800):(this.loveValue<15&&this.animateCalculation(0,6*this.loveValue,4640,Phaser.Math.Easing.Linear,580,()=>{this.animateCalculation(6*this.loveValue,this.loveValue,580)}),this.loveValue<30&&this.animateCalculation(0,3*this.loveValue,4640,Phaser.Math.Easing.Linear,580,()=>{this.animateCalculation(3*this.loveValue,this.loveValue,580)}),this.loveValue<50&&this.animateCalculation(0,2*this.loveValue,4640,Phaser.Math.Easing.Linear,580,()=>{this.animateCalculation(2*this.loveValue,this.loveValue,580)}))}animateCalculation(e,t,s){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:Phaser.Math.Easing.Sine.Out;let a=e<30&&t<40?1:0;this.scene.tweens.addCounter({from:e,to:t,duration:s,onUpdate(e){var t=10**a;e=Math.floor(e.getValue()*t)/t;this.loveTestResultText.setText(e.toFixed(a)+"%"),this.loveTestResultTextShadow.setText(e.toFixed(a)+"%"),x.instance.liveScore(e)},completeDelay:4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,onComplete:5<arguments.length&&void 0!==arguments[5]?arguments[5]:()=>{},ease:i,onUpdateScope:this})}moveTextWithBone(){var e=r.instance.height,t=this.scene.scenarioContainer.scale;e=(e/2-this.pivotBone.worldY)/t;this.loveTestResultText.y=Math.floor(e)}scaleTextWithBone(){var e=this.getFontSizeScaledByBone(),t=this.getStrokeSizeScaledByBone();this.loveTestResultText.setScale(e),this.loveTestResultTextShadow.setScale(e),this.loveTestResultText.setFontSize(100),this.loveTestResultTextShadow.setFontSize(100),this.loveTestResultText.setStroke(E.heart_outline_positive.hash,t),this.hasCompleted&&this.loveValue<=50&&(this.loveTestResultText.setStroke(E.heart_outline_negative.hash,t),this.loveTestResultTextShadow.setTint(E.heart_outline_negative.hex))}getFontSizeScaledByBone(){var e=this.pivotBone.scaleX*(this.startFontSize/100);return Phaser.Math.Clamp(e,0,1.5)}getStrokeSizeScaledByBone(){return 100/this.startFontSize*4}lerp(e,t,s){return(1-s)*e+s*t}updateText(){this.isCountingUp?this.tempValue++:this.tempValue--,99<=this.tempValue&&(this.tempValue=99,this.isCountingUp=!1),this.tempValue<=10&&(this.tempValue=10,this.isCountingUp=!0),this.loveTestResultText.setText(this.tempValue+"%"),this.loveTestResultTextShadow.setText(this.tempValue+"%")}get pivotBone(){return this._pivotBone||(this._pivotBone=this.scene.scenarioContainer.meter.findBone("pivot")),this._pivotBone}update(){this.isCalculating&&this.updateText(),this.isFolowingBone&&(this.moveTextWithBone(),this.scaleTextWithBone()),this.loveTestResultTextShadow.y=this.loveTestResultText.y+this.shadowOffset*this.getFontSizeScaledByBone()}}$t.MAX_WIDTH=290,$t.COMPRESSED_WIDTH=280;class es extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s),this.scene=e,this.mainCharacterNameContainer=this.createCharacterLabel(0,0,Mt.instance.mainCharacterData.name||"PERSON 1",!0),this.add(this.mainCharacterNameContainer),this.secondaryCharacterNameContainer=this.createCharacterLabel(0,0,Mt.instance.secondaryCharacterData.name||"PERSON 2",!1),this.add(this.secondaryCharacterNameContainer)}createCharacterLabel(e,t,s,i){t=new Phaser.GameObjects.Container(this.scene,e,t);var a=new Phaser.GameObjects.Image(this.scene,0,0,"ui","result-name-background").setAlpha(1,1,.9,.9).setScale(2.2).setTint(E.input_field_main.hex);a.defaultX=e,e=new Phaser.GameObjects.Text(this.scene,0,-5,s,pe.nameLabel).setAlign("center").setOrigin(.5,.5).setFontSize(36).setColor(E.input_field_main_text.hash);return this.setMaxWidthText(e),t.background=a,t.text=e,t.add(a),t.add(e),t.setScale(.5,.5),t}setMaxWidthText(e){var t;e.displayWidth>$t.MAX_WIDTH&&(t=$t.MAX_WIDTH/e.displayWidth,e.setScale(t))}update(){this.scene.endAnimation&&this.scene.endAnimation.isComplete()||(this.scene.hasEnded?(this.updateMainCharacterText(!0),this.updateSecondaryCharacterText(!0)):(this.updateMainCharacterText(!1),this.updateSecondaryCharacterText(!1)))}updateMainCharacterText(e){var{width:t,height:s}=r.instance,i=this.scene.scenarioContainer.scale;let a;var n=(s/2-this.scene.scenarioContainer.mainCharacter.nameBone.worldY)/i;e?(Phaser.Math.Clamp(t/s/us.SCENARIO_RATIO,0,1),a=(this.scene.scenarioContainer.mainCharacter.nameBone.worldX-t/2)/i,this.mainCharacterNameContainer.background.setX(50),this.mainCharacterNameContainer.setPosition(a,30+n)):(a=(this.scene.scenarioContainer.mainCharacter.nameBone.worldX-t/2)/i,this.mainCharacterNameContainer.setPosition(a,n))}updateSecondaryCharacterText(e){var{width:t,height:s}=r.instance,i=this.scene.scenarioContainer.scale,a=(s/2-this.scene.scenarioContainer.secondaryCharacter.nameBone.worldY)/i;let n;e?(Phaser.Math.Clamp(t/s/us.SCENARIO_RATIO,0,1),n=(this.scene.scenarioContainer.secondaryCharacter.nameBone.worldX-t/2)/i,this.secondaryCharacterNameContainer.background.setX(-50),this.secondaryCharacterNameContainer.setPosition(n,30+a)):(n=(this.scene.scenarioContainer.secondaryCharacter.nameBone.worldX-t/2)/i,this.secondaryCharacterNameContainer.setPosition(n,a))}}class ts extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s),this.init(),this.create()}init(){this.spineObjects=[],this.backgrounds=[],this.outcome=this.getOutcome()}create(){this.createMask(),this.setMask(this.maskShape.createGeometryMask()),this.createSpineObjects(),this.createMeter(),this.createNameFollower(),this.createLoveTestResult()}createMask(){this.maskShape=this.scene.make.graphics().fillStyle(16777215,1).fillRect(-us.SCENARIO_SIZE.width/2,-us.SCENARIO_SIZE.height/2,us.SCENARIO_SIZE.width,us.SCENARIO_SIZE.height)}createNameFollower(){this.nameFollower=new es(this.scene,0,0),this.add(this.nameFollower)}createLoveTestResult(){this.loveTestResult=new $t(this.scene,this.scene.loveValue,this),this.add(this.loveTestResult)}setSpineLayer(e,t){t=t.data.name[t.data.name.length-1],this.moveTo(e,t),this.sortNameFollower()}createMeter(){const e=this.scene.add.spine(0,0,"meter");e.key="meter";var t=e.getSkinList();e.setSkinByName(t[t.length-1]),e.addAnimation(0,this.scene.scenarioData.meter.beginAnim),e.on("event",(t,s)=>{tt.instance.setAtlasKey("general-audio"),this.onSpineEvent(e,s)},this),this.meter=e,this.add(this.meter),this.spineObjects.push(this.meter)}createNPC(e){const t=this.scene.add.spine(0,0,e.key);t.key=e.key,e=t.getSkinList(),t.setSkinByName(e[e.length-1]),t.on("event",(e,s)=>{this.onSpineEvent(t,s)},this),this.add(t),this.spineObjects.push(t)}createBackground(e){const t=this.scene.add.spine(0,0,e.key);t.key=e.key,e=t.getSkinList(),t.setSkinByName(e[e.length-1]),t.on("event",(e,s)=>{tt.instance.setAtlasKey(this.scene.key+"-audio"),this.onSpineEvent(t,s)},this),this.backgrounds.push(t),this.add(t),this.spineObjects.push(t)}createMainCharacter(e){this.mainCharacter=new st(this.scene,e.key),this.mainCharacter.dance=this.scene.mainCharacterDance,Mt.setCharacterOptions(this.mainCharacter,Mt.instance.mainCharacterData.options),e=this.mainCharacter.getCharacter(),this.spineObjects.push(e),this.add(this.mainCharacter.character)}createSecondaryCharacter(e){this.secondaryCharacter=new st(this.scene,e.key),this.secondaryCharacter.dance=this.scene.secondaryCharacterDance,Mt.setCharacterOptions(this.secondaryCharacter,Mt.instance.secondaryCharacterData.options),e=this.secondaryCharacter.getCharacter(),this.spineObjects.push(e),this.add(this.secondaryCharacter.character)}updateUI(){this.loveTestResult.update(),this.nameFollower.update()}onSpineEvent(e,t){var s=t.data.name;switch(!0){case s.includes("sfx"):tt.instance.playEvent(t),"sfx:heart-bar-whoosh"===s&&this.loveTestResult.startCalculationAnimation(),"sfx:powerup-riser"===s&&(this.loveTestResult.finishCalculation(),this.scenarioDone=!0,this.sortNameFollower());break;case s.includes("SetLayer"):this.setSpineLayer(e,t)}}createSpineObjects(){this.scene.scenarioData.spineObjects.forEach(this.createSpineObject,this),[this.secondaryCharacter,this.mainCharacter].forEach(e=>{this.scene.add.existing(e)})}setTimeScale(e){this.spineObjects.forEach(t=>{t.state.timeScale=e})}createSpineObject(e){switch(e.type){case"mainCharacter":this.createMainCharacter(e);break;case"secondaryCharacter":this.createSecondaryCharacter(e);break;case"npc":this.createNPC(e);break;case"background":this.createBackground(e)}}setLayering(e){e&&(this.list.sort((t,s)=>e.indexOf(t.key)-e.indexOf(s.key)),this.sortNameFollower())}sortNameFollower(){this.scenarioDone?(this.bringToTop(this.nameFollower),this.bringToTop(this.meter),this.bringToTop(this.loveTestResult)):(this.bringToTop(this.meter),this.bringToTop(this.loveTestResult),this.bringToTop(this.nameFollower))}setEnding(e,t){let s;return s=t===this.mainCharacter?"character_1/"+e:"character_2/"+e,e=t.character.setAnimation(0,s,!1).animation.duration,t.playEndingAnimation(s,e)}applyAnimations(e){let t=null;return this.spineObjects.forEach(s=>{var i=s.key;switch(!0){case i.includes("background"):s.play(""+e,!1);break;case i.includes("dog_1"):this.setDogEnding("dog_1",s,e);break;case i.includes("dog_2"):this.setDogEnding("dog_2",s,e);break;case i.includes("main_character"):e.includes("begin")&&(t=s.setAnimation(0,"character_1/"+e,!1)),e.includes("end")&&(t=this.setEnding(e,this.mainCharacter));break;case i.includes("secondary_character"):e.includes("begin")&&s.setAnimation(0,"character_2/"+e,!1),e.includes("end")&&this.setEnding(e,this.secondaryCharacter);break;case i.includes("foreground"):e.includes("begin")?t=s.setAnimation(0,""+e,!1):e.includes("end")&&(s.setAnimation(0,""+e,!1),s.addAnimation(0,e+"_loop",!0));break;default:console.warn("no case for animation name",e,"on",i)}}),t}setDogEnding(e,t,s){var i;s.includes("begin")&&t.play(e+"/"+s,!1),s.includes("end_1")&&(t.setAnimation(0,i=e+"/"+s,!1),t.addAnimation(0,i+"_loop",!0)),s.includes("end_4")&&(t.setAnimation(0,i=e+"/"+s,!1),t.addAnimation(0,i+"_loop",!0))}getOutcome(){let e=null;var t=Phaser.Math.Clamp(this.scene.loveValue,0,100);for(let i=0;i<this.scene.scenarioData.outcomes.length;i++){var s=this.scene.scenarioData.outcomes[i];if(t>=s.min&&t<=s.max){e=s,this.outcomeIndex=i+1;break}}return e}showResult(){this.scene.resultShown=!0;var e=this.applyAnimations(this.outcome.key);return this.meter.addAnimation(1,"meter_end_"+this.outcomeIndex,!1),this.meter.addAnimation(1,`meter_end_${this.outcomeIndex}_loop`,!0),this.setMeterScale(.4),this.setLayering(this.outcome.order),this.scene.time.addEvent({delay:500,callback:()=>{this.loveTestResult.setVisible(!0)}}),this.scene.finishScenario(),e}onResize(e,t,s){var i=this.scene.scenarioData.scale;this.setPosition(t.width/2+s.x*e.y,t.height/2+s.y*e.y).setScale(e.y),this.setMeterScale(.4),this.resizeMaskShape(e,t),this.resizeSpines(i)}resizeMaskShape(e,t){this.maskShape.setScale(e.y),this.maskShape.setPosition(t.width/2,t.height/2)}resizeSpines(e){this.spineObjects.forEach(t=>{t.setScale(e)})}setMeterScale(e){this.meter.setScale(e)}}class ss extends Phaser.GameObjects.Graphics{constructor(e,t){super(e),this.minAlpha=0,this.maxAlpha=.3,this.yOffset=0,this.thickness=16,this.shadow=0,this.createBorders(t)}createBorders(e){this.fillGradientStyle(this.shadow,this.shadow,this.shadow,this.shadow,this.minAlpha,this.maxAlpha,this.minAlpha,this.maxAlpha),this.fillRect(-(e.width/2+this.thickness),-e.height/2,this.thickness,e.height),this.fillGradientStyle(this.shadow,this.shadow,this.shadow,this.shadow,this.maxAlpha,this.minAlpha,this.maxAlpha,this.minAlpha),this.fillRect(e.width/2,-e.height/2,this.thickness,e.height),this.fillGradientStyle(this.shadow,this.shadow,this.shadow,this.shadow,this.minAlpha,this.minAlpha,this.maxAlpha,this.maxAlpha),this.fillRect(-e.width/2,-e.height/2-this.thickness,e.width,this.thickness),this.fillGradientStyle(this.shadow,this.shadow,this.shadow,this.shadow,this.maxAlpha,this.maxAlpha,this.minAlpha,this.minAlpha),this.fillRect(-e.width/2,e.height/2,e.width,this.thickness)}onResize(e,t){this.setScale(e.y).setPosition(t.width/2,t.height/2)}}class is extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s),this.createInterface(),this.setVisible(!1)}createInterface(){this.width=160,this.height=60,this.background=new Phaser.GameObjects.Graphics(this.scene),this.background.fillStyle(E.overlay_black.hex,.8),this.background.fillRoundedRect(.5*-this.width,.5*-this.height,this.width,this.height,{tl:12,tr:0,bl:12,br:12}),this.text=new Phaser.GameObjects.Text(this.scene,0,0,"Click here to record !\nPress replay and \n share your video",{fontFamily:"arial"}).setAlign("center").setOrigin(.5,.5).setFontSize(this.width/12).setColor(E.white.hash),this.add([this.background,this.text])}showOnTikTok(){this.scene.isTT?this.setVisible(!0):this.setVisible(!1)}show(){this.showOnTikTok(),this.originalScale=this.scale,this.setScale(0,0),this.scene.tweens.add({targets:this,duration:500,delay:1e3,scaleX:{from:0,to:this.originalScale},scaleY:{from:0,to:this.originalScale},ease:Phaser.Math.Easing.Back.Out})}onResize(e,t,s,i){this.setScale(e.y).setPosition(t,s+1.25*i+2*this.height)}}const as=[{name:"dances/+charleton",result:"positive"},{name:"dances/+floss",result:"positive"},{name:"dances/+hype",result:"positive"},{name:"dances/+orange_justice",result:"positive"},{name:"dances/+myworld",result:"mediocre"},{name:"dances/+jabba_switchway",result:"mediocre"},{name:"dances/+vibe",result:"mediocre"},{name:"dances/-dualipa1",result:"negative"},{name:"dances/-dualipa2",result:"negative"},{name:"dances/-sadstep",result:"negative"},{name:"dances/+rollie",result:"positive"},{name:"dances/+rockstar",result:"positive"},{name:"dances/+gangnamstyle",result:"positive"},{name:"dances/+seetinh",result:"positive"},{name:"dances/+griddy",result:"positive"},{name:"dances/+omg",result:"positive"}],ns=as.filter(e=>"positive"===e.result),os=as.filter(e=>"mediocre"===e.result),rs=as.filter(e=>"negative"===e.result);class hs{static saveMatch(e,t,s,i,a){e={mainCharacter:e,secondCharacter:t,mainCharacterDance:s,secondCharacterDance:i,scenarioNumber:a,currentTime:window.Date.now()},3<=(t=O.instance.getData("matchHistory")).length?"number"==typeof(s=hs.getOldestSave(t))&&t.splice(s,1,e):t.push(e),O.instance.setData({matchHistory:D.matchHistory})}static getOldestSave(e){let t=0;for(let s=1;s<e.length;s++)e[s].currentTime<e[t].currentTime&&(t=s);return t}static getRandomScenario(e){if(e){const t=Number.parseInt(e,10);if(Number.isInteger(t)&&(e=We.find(e=>e.id===t)))return e}return We[Math.floor(Math.random()*We.length)]}}s(101);class cs extends be{constructor(e,t,s){super(e,t,s),this.active=x.instance.hasFeature("share"),this.createLink(),this.createButton(),this.createPopUp(),this.setCallback(this.share,this),this.setVisible(!1),this.createShareBubble()}createButton(){this.createImage("ui","button-share",!0),this.createImage("ui","icon-share",!1,1,0,-8)}createLink(){this.link=this.generateLink(),this.linkContainer=new Phaser.GameObjects.Container(this.scene,0,-5),this.add(this.linkContainer),this.linkBackground=new Phaser.GameObjects.Graphics(this.scene,0,0),this.linkBackground.fillStyle(E.white.hex),this.linkBackground.fillRoundedRect(-290,-12,290,25,12),this.linkText=new Phaser.GameObjects.Text(this.scene,-159.5,0,this.link.slice(0,30),pe.sharelink).setOrigin(.5,.5),this.linkContainer.add([this.linkBackground,this.linkText]),this.linkContainer.setVisible(!1)}createShareBubble(){this.bubbleContainer=new Phaser.GameObjects.Container(this.scene,-20,-66),this.bubble=new Phaser.GameObjects.Image(this.scene,0,0,"ui","ui-share-text-bubble"),this.bubbleText=new Phaser.GameObjects.Text(this.scene,0,-6,me.SHARE_BUTTON_DIALOG,pe.share_bubble).setOrigin(.5,.5),this.bubbleContainer.add([this.bubble,this.bubbleText]),this.add(this.bubbleContainer),this.bubbleContainer.setVisible(!1),this.scene.tweens.add({targets:this.bubbleContainer,y:"-=10",yoyo:!0,repeat:-1,ease:Phaser.Math.Easing.Linear})}createPopUp(){this.popUpY=-50,this.popUpList=new Phaser.GameObjects.Container(this.scene,0,this.popUpY),this.add(this.popUpList),this.popUpBackground=new Phaser.GameObjects.Image(this.scene,0,0,"ui","tooltip-balloon").setOrigin(.5,1),this.popUpText=new Phaser.GameObjects.Text(this.scene,0,-52,me.SHARE_BUTTON_DIALOG,pe.button_small).setTint(E.button_pink_default.hex).setOrigin(.5,.5).setWordWrapWidth(this.popUpBackground.displayWidth),this.popUpList.add([this.popUpBackground,this.popUpText])}generateLink(){var e=this.getBaseURL()+"?c2hhcmV=&YWxsI=";return this.linkId=A.instance.getLinkUuid(),e+this.linkId}getBaseURL(){var e=window.location.href;return!e.includes("lovetester")&&e.includes("builds.wanted5games")?"https://builds.wanted5games.com/famobi/love-tester/staging/index.html":"https://lovetester.com/"}sentDataToFirestore(){var e={};let t,s;for(let e=0;e<as.length;e++){var i=as[e].name;i===this.scene.mainCharacterDance&&(t=e),i===this.scene.mainCharacterDance&&(s=e)}e.danceA=t,e.danceB=s,e.text=this.scene.textKey,e.scenario=this.scene.scenarioData.id,e.nameA=Mt.instance.mainCharacterData.name,e.nameB=Mt.instance.secondaryCharacterData.name,e.optionsA=Mt.instance.mainCharacterData.options,e.optionsB=Mt.instance.secondaryCharacterData.options,console.log("saving link data:",e),A.instance.setLinkData(this.linkId,e)}share(){var e;this.bubbleContainer.setVisible(!1),this.dataSent||(this.sentDataToFirestore(),this.dataSent=!0),x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"shareLink:shared"),!navigator&&navigator.share||(e={title:"Test your love!",text:" ",url:this.link},console.log(e),window.navigator.share(e).then(e=>{e&&(0<e.length?console.warn("Shared successfully with activity"):console.warn("Share was aborted"))}).catch(e=>{console.error("Share failed:",e)}))}getOptionString(e){var t=Object.keys(e);let s="";return t.forEach(t=>{s=(s=s+e[t].id+"~")+this.rgbToHex(e[t].color.r,e[t].color.g,e[t].color.b)+":"}),s}rgbToHex(e,t,s){return""+this.componentToHex(e)+this.componentToHex(t)+this.componentToHex(s)}componentToHex(e){return 1===(e=e.toString(16)).length?"0"+e:e}show(){this.active&&(this.setVisible(!0),x.instance.hasFeature("downloadApp")||this.bubbleContainer.setVisible(!0),this.savedScale=this.scale,this.popUpScale=this.popUpList.scale,this.popUpList.setScale(0,0),this.setScale(0,0),this.scene.tweens.add({targets:this,duration:500,scale:{from:0,to:this.savedScale},ease:Phaser.Math.Easing.Back.Out,onComplete:this.showLink,onCompleteScope:this}))}showPopUp(){x.instance.hasFeature("downloadApp")||this.scene.tweens.add({targets:this.popUpList,duration:200,delay:1e3,scale:{from:0,to:this.popUpScale},ease:Phaser.Math.Easing.Quadratic.Out,onComplete:this.floatPopUp,onCompleteScope:this})}floatPopUp(){this.scene.tweens.addCounter({from:0,to:2*Math.PI,duration:2e3,delay:2e3,onUpdate:e=>{e=e.getValue(),this.popUpList.setPosition(0,this.popUpY-5*Math.cos(e-.5*Math.PI))},repeat:-1})}onResize(e,t,s,i){this.setScale(t.y).setPosition(e.width/2+140*t.y,i)}}const ls={LN_01:{key:"DIALOG_FUNNY_LN_01",range:1,scenario:"ln"},LN_02:{key:"DIALOG_FUNNY_LN_02",range:2,scenario:"ln"},LN_03:{key:"DIALOG_FUNNY_LN_03",range:2,scenario:"ln"},LN_04:{key:"DIALOG_FUNNY_LN_04",range:3,scenario:"ln"},LN_05:{key:"DIALOG_FUNNY_LN_05",range:4,scenario:"ln"},LN_06:{key:"DIALOG_FUNNY_LN_06",range:4,scenario:"ln"},LN_07:{key:"DIALOG_FUNNY_LN_07",range:5,scenario:"ln"},LN_08:{key:"DIALOG_FUNNY_LN_08",range:5,scenario:"ln"},BB_01:{key:"DIALOG_FUNNY_BB_01",range:1,scenario:"bb"},BB_02:{key:"DIALOG_FUNNY_BB_02",range:2,scenario:"bb"},BB_03:{key:"DIALOG_FUNNY_BB_03",range:3,scenario:"bb"},BB_04:{key:"DIALOG_FUNNY_BB_04",range:4,scenario:"bb"},BB_05:{key:"DIALOG_FUNNY_BB_05",range:4,scenario:"bb"},BB_06:{key:"DIALOG_FUNNY_BB_06",range:5,scenario:"bb"},DG_01:{key:"DIALOG_FUNNY_DG_01",range:1,scenario:"dg"},DG_02:{key:"DIALOG_FUNNY_DG_02",range:1,scenario:"dg"},DG_03:{key:"DIALOG_FUNNY_DG_03",range:2,scenario:"dg"},DG_04:{key:"DIALOG_FUNNY_DG_04",range:3,scenario:"dg"},DG_05:{key:"DIALOG_FUNNY_DG_05",range:4,scenario:"dg"},DG_06:{key:"DIALOG_FUNNY_DG_06",range:5,scenario:"dg"},MC_01:{key:"DIALOG_FUNNY_MC_01",range:1,scenario:"mc"},MC_02:{key:"DIALOG_FUNNY_MC_02",range:1,scenario:"mc"},MC_03:{key:"DIALOG_FUNNY_MC_03",range:2,scenario:"mc"},MC_04:{key:"DIALOG_FUNNY_MC_04",range:3,scenario:"mc"},MC_05:{key:"DIALOG_FUNNY_MC_05",range:3,scenario:"mc"},MC_06:{key:"DIALOG_FUNNY_MC_06",range:4,scenario:"mc"},MC_07:{key:"DIALOG_FUNNY_MC_07",range:5,scenario:"mc"},DO6_01:{key:"DIALOG_FUNNY_DO6_01",range:1,scenario:"d06"},DO6_02:{key:"DIALOG_FUNNY_DO6_02",range:2,scenario:"d06"},DO6_03:{key:"DIALOG_FUNNY_DO6_03",range:3,scenario:"d06"},DO6_04:{key:"DIALOG_FUNNY_DO6_04",range:4,scenario:"d06"},DO6_05:{key:"DIALOG_FUNNY_DO6_05",range:5,scenario:"d06"},GLOBAL_01:{key:"DIALOG_FUNNY_01",range:1,scenario:"global"},GLOBAL_02:{key:"DIALOG_FUNNY_02",range:1,scenario:"global"},GLOBAL_03:{key:"DIALOG_FUNNY_03",range:1,scenario:"global"},GLOBAL_04:{key:"DIALOG_FUNNY_04",range:1,scenario:"global"},GLOBAL_05:{key:"DIALOG_FUNNY_05",range:1,scenario:"global"},GLOBAL_06:{key:"DIALOG_FUNNY_06",range:1,scenario:"global"},GLOBAL_07:{key:"DIALOG_FUNNY_07",range:1,scenario:"global"},GLOBAL_08:{key:"DIALOG_FUNNY_08",range:2,scenario:"global"},GLOBAL_09:{key:"DIALOG_FUNNY_09",range:2,scenario:"global"},GLOBAL_10:{key:"DIALOG_FUNNY_10",range:2,scenario:"global"},GLOBAL_11:{key:"DIALOG_FUNNY_11",range:2,scenario:"global"},GLOBAL_12:{key:"DIALOG_FUNNY_12",range:2,scenario:"global"},GLOBAL_13:{key:"DIALOG_FUNNY_13",range:2,scenario:"global"},GLOBAL_14:{key:"DIALOG_FUNNY_14",range:2,scenario:"global"},GLOBAL_15:{key:"DIALOG_FUNNY_15",range:3,scenario:"global"},GLOBAL_16:{key:"DIALOG_FUNNY_16",range:3,scenario:"global"},GLOBAL_17:{key:"DIALOG_FUNNY_17",range:3,scenario:"global"},GLOBAL_18:{key:"DIALOG_FUNNY_18",range:3,scenario:"global"},GLOBAL_19:{key:"DIALOG_FUNNY_19",range:3,scenario:"global"},GLOBAL_20:{key:"DIALOG_FUNNY_20",range:3,scenario:"global"},GLOBAL_21:{key:"DIALOG_FUNNY_21",range:3,scenario:"global"},GLOBAL_22:{key:"DIALOG_FUNNY_22",range:4,scenario:"global"},GLOBAL_23:{key:"DIALOG_FUNNY_23",range:4,scenario:"global"},GLOBAL_24:{key:"DIALOG_FUNNY_24",range:4,scenario:"global"},GLOBAL_25:{key:"DIALOG_FUNNY_25",range:4,scenario:"global"},GLOBAL_26:{key:"DIALOG_FUNNY_26",range:4,scenario:"global"},GLOBAL_27:{key:"DIALOG_FUNNY_27",range:4,scenario:"global"},GLOBAL_28:{key:"DIALOG_FUNNY_28",range:4,scenario:"global"},GLOBAL_29:{key:"DIALOG_FUNNY_29",range:4,scenario:"global"},GLOBAL_30:{key:"DIALOG_FUNNY_30",range:4,scenario:"global"},GLOBAL_31:{key:"DIALOG_FUNNY_31",range:4,scenario:"global"},GLOBAL_32:{key:"DIALOG_FUNNY_32",range:4,scenario:"global"},GLOBAL_33:{key:"DIALOG_FUNNY_33",range:5,scenario:"global"},GLOBAL_34:{key:"DIALOG_FUNNY_34",range:5,scenario:"global"},GLOBAL_35:{key:"DIALOG_FUNNY_35",range:5,scenario:"global"},GLOBAL_36:{key:"DIALOG_FUNNY_36",range:5,scenario:"global"},GLOBAL_37:{key:"DIALOG_FUNNY_37",range:5,scenario:"global"},GLOBAL_38:{key:"DIALOG_FUNNY_38",range:5,scenario:"global"},GLOBAL_39:{key:"DIALOG_FUNNY_39",range:5,scenario:"global"},GLOBAL_40:{key:"DIALOG_FUNNY_40",range:5,scenario:"global"},GLOBAL_41:{key:"DIALOG_FUNNY_41",range:5,scenario:"global"},GLOBAL_42:{key:"DIALOG_FUNNY_42",range:5,scenario:"global"},GLOBAL_43:{key:"DIALOG_FUNNY_43",range:5,scenario:"global"},GLOBAL_44:{key:"DIALOG_FUNNY_44",range:5,scenario:"global"}};class ds extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s),this.width=343,this.height=64,this.padding=20,this.margin=20,this.create()}create(){this.createBackground(),this.resizeBackground(),this.createText()}createBackground(){this.background=new Phaser.GameObjects.Graphics(this.scene),this.add(this.background)}resizeBackground(){this.background.clear().fillStyle(E.white.hex,.6).fillRoundedRect(-this.width/2,0,this.width,this.height,9)}show(){this.setVisible(!0),this.savedScale=this.scale,this.setScale(0,0),this.scene.tweens.add({targets:this,duration:500,scale:{from:0,to:this.savedScale},ease:Phaser.Math.Easing.Back.Out,onComplete:()=>{}})}createText(){this.text=new Phaser.GameObjects.Text(this.scene,0,12,"",pe.funnyTextDialog).setOrigin(.5,0),this.add(this.text)}getRange(e){return 81<=e?5:61<=e?4:41<=e?3:21<=e?2:1}setRandomDialog(e,t,s){let i=s;if(!s){const a=this.getRange(e);i=(s=Object.values(ls).filter(e=>e.range===a&&(e.scenario===t||"global"===e.scenario)))[Math.floor(Math.random()*s.length)].key}this.scene.textKey=i,this.setText(i),this.updateWidth(),this.updateHeight(),this.resizeBackground()}updateWidth(){var e=r.instance.gameSize.width,t=r.instance.gameScale;e=Phaser.Math.Clamp(e/t.y,0,us.SCENARIO_SIZE.min_width)-this.margin;this.text.setWordWrapWidth(e-this.padding),this.width=e}updateHeight(){this.height=this.text.displayHeight+this.padding}setText(e,t){this.text.setText(e,t)}onResize(e,t,s){this.setScale(t.y),this.updatePosition(s),this.updateWidth(),this.updateHeight(),this.resizeBackground()}updatePosition(e){this.setPosition(r.instance.gameSize.width/2,150*r.instance.gameScale.y)}}class us extends Phaser.Scene{constructor(){super("Scenario"),this.emitter=new Phaser.Events.EventEmitter}get isShareRefferal(){return this.data.sharedLink}init(e){(He.instance.scene=this).cameras.main.fadeOut(0),this.isTT=!!y.instance.tt,this.resultShown=!1,this.hasEnded=!1,this.buttonsShown=!1,this.introAnimation=null,this.data=e,this.scenarioData=this.data.scenarioData,this.loveValue=this.data.loveValue,this.key=this.scenarioData.folder,Xt.instance.progessScenarioOpened(this.scenarioData.id),this.initializeSingletons(),this.createEventListeners(),this.createCharacterDances(),this.saveMatch(),this.sendScenarioStartedEvents()}fadeIn(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:600,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:E.overlay_black;this.cameras.main.fadeIn(e,t)}initializeSingletons(){r.instance.init(this),Ut.instance.setScene(this)}sendScenarioStartedEvents(){A.instance.logCustomEvent("love_percentage",{percentage:this.loveValue}),A.instance.logScreenView("scenario_"+this.scenarioData.id,"scene"),He.instance.finishStep(le)}createCharacterDances(){var e=window.location.search,t=(e=new URLSearchParams(e)).get("danceA");e=e.get("danceB");this.danceList=this.setDanceList(),this.mainCharacterDance=this.getDance(this.data.danceA||t),this.secondaryCharacterDance=this.getDance(this.data.danceB||e)}getDance(e){var t=as[e];return(e&&t?t:this.danceList[Phaser.Math.Between(0,this.danceList.length-1)]).name}setDanceList(){return this.loveValue<50?rs:this.loveValue<75?os:ns}saveMatch(){hs.saveMatch(Mt.instance.mainCharacterData,Mt.instance.secondaryCharacterData,this.mainCharacterDance,this.secondaryCharacterDance,this.scenarioData.id)}createEventListeners(){y.instance.emitter.on("onShow",this.resume,this),y.instance.emitter.on("onHide",this.pause,this),this.load.on("complete",()=>{this.cameras.main.fadeOut(0)})}create(){this.createGame()}createGame(){setTimeout(()=>{this.fadeIn(),this.createdGame=!0},10),this.createBackground(),this.createScenarioContainer(),this.createButtons(),this.createLogo(),this.createFunnyText(),this.createRecordTutorial(),this.createScreenBorders(),this.createEvents(),this.createTutorial(),this.postInitialize(),this.setTimeScale()}setTimeScale(){0<arguments.length&&void 0!==arguments[0]||this.data.timeScale}createEvents(){r.instance.emitter.on("resize",this.onResize,this),r.instance.fireResizeEvent()}createTutorial(){this.isShareRefferal||He.instance.checkTutorialNeeded(this)}postInitialize(){setTimeout(()=>{this.fadeIn(500),N.instance.performAction("scenario_start",this.scenarioData.id),this.introAnimation=this.scenarioContainer.applyAnimations(this.scenarioData.beginAnimationName)})}createBackground(){var e=this.scenarioData.background,{width:t,height:s}=r.instance.gameSize;this.background=new ht(this,{x:t/2,y:s/2},e),this.shadowBorders=new ss(this,us.SCENARIO_SIZE),this.add.existing(this.background),this.add.existing(this.shadowBorders)}createScreenBorders(){this.screenBorder=this.add.image(r.instance.width/2,r.instance.height/2,"ui","item-background"),this.screenBorder.setDisplaySize(390,2).setDepth(999999999999).setVisible(!1),this.add.existing(this.screenBorder)}createScenarioContainer(){this.scenarioContainer=new ts(this,40,0),this.add.existing(this.scenarioContainer)}get meterCenter(){var e=this.scenarioContainer.loveTestResult.loveTestResultText.getWorldTransformMatrix();return{x:e.tx,y:e.ty}}createButtons(){this.replayButton=new Qt(this),this.homeButton=new Zt(this),this.add.existing(this.homeButton),this.add.existing(this.replayButton),this.isTT||(this.shareButton=new cs(this,0,0),this.add.existing(this.shareButton))}createFunnyText(){var e=window.location.search;e=new URLSearchParams(e).get("text");this.funnyTextDialog=new ds(this,0,0).setVisible(!1),this.add.existing(this.funnyTextDialog),this.funnyTextDialog.setRandomDialog(this.loveValue,this.scenarioData.folder,this.data.text||e)}createLogo(){this.logo=new Je(this,1),this.logo.setVisible(!1),this.add.existing(this.logo)}createRecordTutorial(){this.recordTutorial=new is(this,0,0),this.add.existing(this.recordTutorial),this.recordTutorial.setDepth(99999999999)}showFunnyText(){this.funnyTextDialog.updatePosition(this.meterCenter,this.meterCenter),this.funnyTextDialog.show()}update(){this.createdGame&&(this.scenarioContainer.updateUI(),!this.buttonsShown&&this.endAnimation&&this.endAnimation.isComplete()&&this.onEndAnimationLoopStart(),this.hasEnded||!this.resultShown&&this.introAnimation&&this.introAnimation.isComplete()&&(this.endAnimation=this.scenarioContainer.showResult(),x.instance.liveScore(this.loveValue)))}finishScenario(){this.isShareRefferal?x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"shareLink:watchedScenario"):x.instance.sendGAEvent(x.GA_EVENTS.DESIGN,"progression:scenario:finished"),N.instance.performAction("scenario_end",{danceA:this.mainCharacterDance,danceB:this.secondaryCharacterDance,percentage:this.loveValue}),this.hasEnded=!0}onEndAnimationLoopStart(){delete this.endAnimation,this.showFunnyText(),this.time.addEvent({delay:1500,callback:this.showButtons,callbackScope:this})}async showButtons(){"bad"===this.scenarioContainer.outcome.type?(await x.instance.levelEnd("fail",this.loveValue),await x.instance.levelFailed(this.scenarioData.name,this.loveValue)):(await x.instance.levelEnd("success",this.loveValue),await x.instance.levelSuccess(this.scenarioData.name,this.loveValue)),He.instance.finishStep(de),this.buttonsShown=!0,this.replayButton.show(),this.homeButton.show(),this.logo.show(),this.shareButton.show(),us.SHOWNTUTORIAL||(this.recordTutorial.show(),us.SHOWNTUTORIAL=!0)}getScreenWidth(){var e,{width:t,dpr:e}=r.instance;return(e=1.2*pt.MAXIMUM_WIDTH*e)<t?e:t}onResize(e,t){var s=e.height-42*t.y,i=90*t.y;this.screenBorder.x=r.instance.width/2,this.screenBorder.y=r.instance.height/2,this.screenBorder.setDisplaySize(this.getScreenWidth(),2),this.funnyTextDialog.onResize(e,t,this.meterCenter),this.resizeButtons(e,t,i,s),this.scenarioContainer.onResize(t,e,this.scenarioData.offset),this.shadowBorders.onResize(t,e),this.recordTutorial.onResize(t,i,s,this.homeButton.height),this.logo.onResize(e,t.y),this.background.setPosition(e.width/2,e.height/2)}resizeButtons(e,t,s,i){this.homeButton.onResize(e,t,s,i),this.replayButton.onResize(e,t,s,i),this.shareButton.onResize(e,t,s,i)}shutdown(){this.createdGame=!1,r.instance.emitter.off("resize",this.onResize,this),y.instance.emitter.off("onShow",this.resume,this),y.instance.emitter.off("onHide",this.pause,this),document.removeEventListener("pause",()=>{this.pause()},!1),document.removeEventListener("resume",()=>{this.resume()},!1),document.removeEventListener("resign",()=>{this.pause()},!1),document.removeEventListener("active",()=>{this.resume()},!1),document.removeEventListener("backbutton",()=>{this.backButton()},!1)}backButton(){}pause(){o.instance.pauseAll(),this.scene.pause()}resume(){o.instance.resumeAll(),this.scene.resume()}restart(){this.createdGame=!1,this.scene.restart()}fadeOut(e,t){this.cameras.main.fadeOut(500),o.instance.fadeOutAllSoundsForSpecificScenario(this.scenarioData,250),this.cameras.main.once("camerafadeoutcomplete",e,t)}goToCharacterCreator(){this.shutdown(),Xt.instance.progessScenarioClosed(this.scenarioData.folder,this.loveValue),this.scene.start("CharacterCreator")}getXPos(e,t){var s=us.SCENARIO_SIZE.width,i=t.width>s*e.y,a=!!y.instance.tt;return i&&a?t.width/2+s/4*e.y:i&&!a?t.width/2+s/5*2*e.y:!i&&a?t.width/4*3:.9*t.width}}us.SHOWNTUTORIAL=!1,us.OFFSET={x:10,y:0},us.SPINE_SCALE=.5,us.SCENARIO_SIZE={width:609,height:812,min_width:375},us.SCENARIO_RATIO=us.SCENARIO_SIZE.width/us.SCENARIO_SIZE.height;class gs extends Phaser.GameObjects.Container{constructor(e,t,s,i){super(e,t,s),this.scene=e,this.imageKey=i,this.darkness=60,this.init()}init(){this.scenarioImage=new Phaser.GameObjects.Image(this.scene,0,0,"scenario-wheel",this.imageKey),this.createFrame(),this.createBars(),this.createHighlight(),this.setVisibleHighlight(!1),this.add([this.scenarioImage,this.scenarioFrameLeft,this.scenarioFrameRight,this.topBar,this.bottomBar,this.highlight])}createHighlight(){this.highlight=new Phaser.GameObjects.Image(this.scene,0,0,"scenario-wheel","glow")}setVisibleHighlight(e){this.highlight.setVisible(e)}createBars(){this.topBar=new Phaser.GameObjects.Image(this.scene,0,0,"scenario-wheel","film_bar"),this.topBar.setPosition(0,this.scenarioImage.displayHeight/2-this.topBar.displayHeight/2).setOrigin(.5,.5).setScale(1.1,1.1),this.bottomBar=new Phaser.GameObjects.Image(this.scene,0,0,"scenario-wheel","film_bar"),this.bottomBar.setPosition(0,-this.scenarioImage.displayHeight/2+this.topBar.displayHeight/2).setOrigin(.5,.5).setScale(1.1,1.1)}createFrame(){this.scenarioFrameLeft=new Phaser.GameObjects.Image(this.scene,-this.scenarioImage.displayWidth/2,0,"scenario-wheel","film_slide").setOrigin(0,.5),this.scenarioFrameRight=new Phaser.GameObjects.Image(this.scene,this.scenarioImage.displayWidth/2,0,"scenario-wheel","film_slide").setOrigin(0,.5).setScale(-1,1)}darkenImage(){this.scene.tweens.addCounter({from:255,to:this.darkness,duration:400,onUpdate:e=>{e=e.getValue(),this.scenarioImage.setTint(Phaser.Display.Color.GetColor(e,e,e))}})}highlightImage(){this.setVisibleHighlight(!0),this.highlight.setAlpha(0),this.scene.tweens.addCounter({from:0,to:1,duration:600,onUpdate:e=>{e=e.getValue(),this.highlight.setAlpha(e)},onComplete:this.scene.showSelectedScenario,onCompleteScope:this.scene,ease:Phaser.Math.Easing.Back.InOut})}}class ms extends Phaser.GameObjects.Container{constructor(e){super(e),this.scene=e,this.loadedFrameLists=4,this.frames=["scenario-0","scenario-1","scenario-2","scenario-3","scenario-4"],this.init()}init(){this.loadImages()}loadImages(){for(let t=0;t<this.frames.length*this.loadedFrameLists;t++){var e=new gs(this.scene,0,0,this.frames[t%this.frames.length]);this.add(e)}}highlightScenario(e){this.list[e].highlightImage();for(let t=0;t<this.list.length;t++)t!==e&&this.list[t].darkenImage()}onResize(e){this.resizeImages(e)}get totalImagesShown(){return 4}resizeImages(e){for(let i=0;i<this.list.length;i++){var t=this.list[i],s=t.scenarioImage.displayHeight;s=(this.imageDisplayHeight=e.height/this.totalImagesShown,this.imageDisplayHeight/s);this.imageDisplayWidth=t.scenarioImage.displayWidth*s,t.setScale(s).setPosition(0,e.height-this.imageDisplayHeight*i)}}}class ps extends Phaser.GameObjects.Container{constructor(e,t){super(e,0,0),this.scene=e,this.result=t,this.scenarios=We,this.tweenSpeed=150,this.finalTweenDistance=1.5,this.init()}init(){this.loadScreen(),this.createEventListeners()}createEventListeners(){this.scene.load.on("complete",this.endTween,this)}loadScreen(){this.loadScenarioImages(),this.loadGradient(),this.loadArrows(E.scenario_wheel_arrow.hex)}loadScenarioImages(){this.slots=new ms(this.scene),this.add(this.slots)}loadGradient(){this.topGradient=new Phaser.GameObjects.Graphics(this.scene),this.topGradient.fillGradientStyle(E.overlay_black.hex,E.overlay_black.hex,E.overlay_black.hex,E.overlay_black.hex,1,1,0,0),this.add(this.topGradient),this.bottomGradient=new Phaser.GameObjects.Graphics(this.scene),this.bottomGradient.fillGradientStyle(E.overlay_black.hex,E.overlay_black.hex,E.overlay_black.hex,E.overlay_black.hex,0,0,1,1),this.add(this.bottomGradient)}loadArrows(e){this.arrowLeft=new Phaser.GameObjects.Image(this.scene,0,0,"scenario-wheel","arrow"),this.arrowLeft.setOrigin(0,.5).setTint(e),this.add(this.arrowLeft),this.arrowRight=new Phaser.GameObjects.Image(this.scene,0,0,"scenario-wheel","arrow"),this.arrowRight.setOrigin(0,.5).setScale(-1,1).setTint(e),this.add(this.arrowRight)}get scenarioLoop(){return this.slots.imageDisplayHeight*this.slots.frames.length}loopTweenStart(){this.loopingTween=this.scene.tweens.add({targets:this.slots,y:{from:0,to:this.scenarioLoop},duration:this.tweenSpeed*this.slots.frames.length,repeat:3,loop:-1,onComplete:this.startFinalFrameTween,onCompleteScope:this}),this.spinningSound=o.instance.playSound("main-audio","wheel-spinning",this.scene,{loop:!0}),this.spinningSound.setRate(.1),this.fadeSpinningSound(.1,2,1e3),this.arrowLeftTween=this.scene.tweens.add({targets:[this.arrowLeft],angle:{from:0,to:20},duration:100,repeat:3,loop:-1}),this.arrowRightTween=this.scene.tweens.add({targets:[this.arrowRight],angle:{from:0,to:-20},duration:100,repeat:3,loop:-1})}fadeSpinningSound(e,t,s){this.scene.tweens.addCounter({from:e,to:t,duration:s,onUpdate:e=>{this.spinningSound.setRate(e.getValue())}})}endTween(){this.loopingTween.on("loop",()=>{this.loopingTween.complete()})}startFinalFrameTween(){var e=-this.slots.totalImagesShown+this.slots.frames.length+this.slots.frames.length+(this.result.id-this.finalTweenDistance);this.finalFrameTweenEnd=this.slots.imageDisplayHeight*e,this.finalFrameTween=this.scene.tweens.add({targets:this.slots,y:{from:0,to:this.finalFrameTweenEnd},duration:e*this.tweenSpeed,onComplete:this.startFinalImageTween,onCompleteScope:this})}startFinalImageTween(){var e=this.finalFrameTweenEnd+this.slots.imageDisplayHeight*this.finalTweenDistance;this.fadeSpinningSound(2,1,6*this.tweenSpeed),this.finalTween=this.scene.tweens.add({targets:this.slots,y:{from:this.finalFrameTweenEnd,to:e},duration:6*this.tweenSpeed,ease:Phaser.Math.Easing.Back.Out,onComplete:()=>{this.spinningSound.stop(),o.instance.playSound("main-audio","stun-1",this.scene,{}),this.slots.highlightScenario(this.result.id+2*this.slots.frames.length)},onCompleteScope:this}),this.arrowLeftTween.stop(),this.arrowRightTween.stop(),this.arrowLeftTween=this.scene.tweens.add({targets:[this.arrowLeft],angle:{from:20,to:0},duration:4*this.tweenSpeed,ease:Phaser.Math.Easing.Back.Out}),this.arrowRightTween=this.scene.tweens.add({targets:[this.arrowRight],angle:{from:-20,to:0},duration:4*this.tweenSpeed,ease:Phaser.Math.Easing.Back.Out})}onResize(e,t){this.slots.onResize(e),this.setPosition(e.width/2,e.height/2),this.resizeArrows(e,t),this.resizeGradient(e)}resizeArrows(e,t){this.arrowLeft.setScale(.5*t.y).setPosition(-this.getScreenSize(e.width)/2,0),this.arrowRight.setScale(.5*-t.y,.5*t.y).setPosition(this.getScreenSize(e.width)/2,0)}resizeGradient(e){this.middleGradient||this.instantiateGradient(),this.middleGradient.clear(),this.gradientWidth=this.slots.imageDisplayWidth/2,this.gradientHeight=this.slots.imageDisplayHeight,this.createGradient({topLeft:0,topRight:0,bottomLeft:.6,bottomRight:0},{x:-this.gradientWidth,y:-this.gradientHeight}),this.createGradient({topLeft:0,topRight:0,bottomLeft:0,bottomRight:.6},{x:0,y:-this.gradientHeight}),this.createGradient({topLeft:.6,topRight:0,bottomLeft:0,bottomRight:0},{x:-this.gradientWidth,y:0}),this.createGradient({topLeft:0,topRight:.6,bottomLeft:0,bottomRight:0},{x:0,y:0}),this.middleGradient.setPosition(0,-350),this.topGradient.fillRect(-this.slots.imageDisplayWidth/2,-e.height/2,this.slots.imageDisplayWidth,this.slots.imageDisplayHeight);var t=this.slots.imageDisplayHeight;this.bottomGradient.fillRect(-this.slots.imageDisplayWidth/2,e.height/2-t,this.slots.imageDisplayWidth,t)}instantiateGradient(){this.middleGradient=new Phaser.GameObjects.Graphics(this.scene),this.add(this.middleGradient)}createGradient(e,t){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:E.white.hex;this.middleGradient.fillGradientStyle(s,s,s,s,e.topLeft,e.topRight,e.bottomLeft,e.bottomRight),this.middleGradient.fillRect(t.x,t.y,this.gradientWidth,this.gradientHeight)}getScreenSize(e){return e<this.slots.imageDisplayWidth?e:this.slots.imageDisplayWidth}}class bs extends Phaser.Scene{constructor(){super("ScenarioMachine"),o.instance.init(this)}init(){Ut.instance.setScene(this)}preload(){this.load.setPath("assets/atlasses"),this.load.atlas("scenario-wheel","scenario-wheel.png","scenario-wheel.json")}create(e){Xt.instance.progessSpinningWheelOpened(),Mt.instance.init(this),this.data=e,this.time.timeScale=this.data.timeScale||1,this.tweens.timeScale=this.data.timeScale||1,e=window.location.search,e=new URLSearchParams(e);let t=this.data.scenario;null==t&&(t=e.get("scenario")),this.scenarioData=this.getRandomScenario(t),this.previousScenarioID=this.scenarioData.id;var s=e.get("percentage");e.get("textKey"),this.loveValue=class{static getLoveValue(e,t,s){if(s&&(s=Number.parseInt(s,10),Number.isInteger(s)))return Phaser.Math.Clamp(Math.floor(s),0,100);if("KEVIN"==e&&"HEDA"==t)return 101;if("ROBBIN"==e&&"LIEKE"==t)return 199;if("LIEKE"==e&&"ROBBIN"==t)return 9001;var i=[];let a=e+t;for(;0<a.length;){var n=a[0],o=a.length;a=a.replaceAll(n,""),i.push(o-a.length)}for(;i.length<2;)i.push(0);for(;2<i.length;){var r=Number.parseInt(i.length/2,10)-1;for(let e=0;e<=r;e++)i[e]=i[i.length-1]+i[e],i.pop()}let h=(10*i[0]+i[1])%1e3;for(;100<h;)h=10*(Number.parseInt(h/100,10)+h%10)+(h-(100*Number.parseInt(h/100,10)+h%10))/10;return Phaser.Math.Clamp(Math.floor(h),0,100)}}.getLoveValue(Mt.instance.mainCharacterData.name,Mt.instance.secondaryCharacterData.name,s),this.slotMachine=new ps(this,this.scenarioData),this.add.existing(this.slotMachine),r.instance.init(this),this.createEventListeners(),this.fadeIn(500)}getRandomScenario(e){if(null!=e){const t=Number.parseInt(e,10);if(Number.isInteger(t)){const e=We.find(e=>e.id===t);if(e)return e}}let t;try{for(;(t=We[Math.floor(Math.random()*We.length)]).id===this.previousScenarioID;);}catch(e){t=We[0]}return t}createEventListeners(){r.instance.emitter.on("resize",this.onResize,this),r.instance.fireResizeEvent(),y.instance.emitter.on("onShow",this.resume,this),y.instance.emitter.on("onHide",this.pause,this)}loadAssets(){this.loadSpines(),this.loadSounds(),this.load.start()}loadSpines(){this.load.setPath("assets/spines/"+this.scenarioData.folder),this.scenarioData.spineObjects.forEach(e=>{this.load.spine(e.key,e.json,[e.atlas],!0)}),this.load.setPath("assets/spines"),this.load.spine("meter","meter.json",["meter.atlas"],!0)}async loadSounds(){var e=this.scenarioData.sounds;window.device&&"iOS"===window.device.platform?this.loadIOSAudio(e):(this.load.setPath("assets/sounds"),this.key=this.scenarioData.folder,e.forEach(e=>{this.load.audioSprite(e+"-audio",e+"-audio.json",[e+"-audio.mp3",e+"-audio.m4a",e+"-audio.ogg"])}))}loadIOSAudio(e){e.forEach(e=>{let t,s;switch(e){case"general":t=generalAudio,s=generalAudioSrc;break;case"bb":t=bbAudio,s=bbAudioSrc;break;case"ln":t=lnAudio,s=lnAudioSrc;break;case"dg":t=dgAudio,s=dgAudioSrc;break;case"d06":t=d06Audio,s=d06AudioSrc;break;case"mc":t=mcAudio,s=mcAudioSrc;break;default:console.warn("audio not found with key",e)}this.cache.json.add(e+"-audio",t),(new(window.AudioContext||window.webkitAudioContext)).decodeAudioData(toArrayBuffer(s),t=>{this.cache.audio.add(e+"-audio",t)},e=>{console.warn("Error with decoding audio data"+e.err)})})}onResize(e,t){this.slotMachine.onResize(e,t)}fadeIn(e){this.cameras.main.fadeIn(e),this.cameras.main.once("camerafadeincomplete",()=>{this.loadAssets(),this.slotMachine.loopTweenStart()},this)}showSelectedScenario(){this.cameras.main.fadeOut(500,E.overlay_black.hex),this.cameras.main.zoomTo(2,500),this.cameras.main.once("camerafadeoutcomplete",this.goToNextScene,this)}shutdown(){y.instance.emitter.off("onShow",this.resume,this),y.instance.emitter.off("onHide",this.pause,this),r.instance.emitter.off("resize",this.onResize,this)}backButton(){}pause(){this.scene.pause()}resume(){this.scene.resume()}async goToNextScene(){await x.instance.showInterstitialAd(),Xt.instance.progessSpinningWheelClosed(),N.instance.performAction("start_game"),this.shutdown(),this.scene.start("Scenario",{acceptedTOS:this.data.acceptedTOS,scenarioData:this.scenarioData,loveValue:this.loveValue,danceA:this.data.danceA,danceB:this.data.danceB,text:this.data.text,sharedLink:this.data.sharedLink,timeScale:this.data.timeScale})}}const ys=Object.assign(qt,{scene:[t,Yt,Wt,Jt,us,bs]});class Ss extends i.a.Game{constructor(){super(ys)}}(class{static inject(){var e=Object.getPrototypeOf(new Phaser.Input.Pointer);e.touchstart=function(e,t){e.pointerId&&(this.pointerId=e.pointerId),this.identifier=e.identifier,this.target=e.target,this.active=!0,this.buttons=1,this.event=t,this.downElement=e.target,this.manager.transformTouchPointer(this,e.clientX,e.clientY,!1),this.primaryDown=!0,this.downX=this.x,this.downY=this.y,this.downTime=t.timeStamp,this.isDown=!0,this.wasTouch=!0,this.wasCanceled=!1,this.updateMotion()},e.touchmove=function(e,t){this.event=t,this.manager.transformTouchPointer(this,e.clientX,e.clientY,!0),this.moveTime=t.timeStamp,this.wasTouch=!0,this.updateMotion()},e.touchend=function(e,t){this.buttons=0,this.event=t,this.upElement=e.target,this.manager.transformTouchPointer(this,e.clientX,e.clientY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=t.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!1,this.active=!1,this.updateMotion()},e.touchcancel=function(e,t){this.buttons=0,this.event=t,this.upElement=e.target,this.manager.transformTouchPointer(this,e.clientX,e.clientY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=t.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!0,this.active=!1}}}).inject(),window.startGame=()=>{A.instance.initialize(),window.game=new Ss},window.startGame()}});